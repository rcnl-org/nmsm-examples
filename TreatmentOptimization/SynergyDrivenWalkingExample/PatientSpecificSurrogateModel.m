function [matrix] = PatientSpecificSurrogateModel(jointAngles, jointVelocities, numMuscles)
onesCol = ones(size(jointAngles, 1), 1);
zeroCol = zeros(size(jointAngles, 1), 1);
switch numMuscles
    case 1
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 2
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 3
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 4
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 5
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 6
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 7
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 8
        theta1 = jointAngles(:, 1);
        thetaDot1 = jointVelocities(:, 1);
        muscleTendonLengths = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 4.*theta1.^3.*thetaDot1, 5.*theta1.^4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; ];
    case 9
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 10
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 11
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 12
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 13
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        theta5 = jointAngles(:, 5);
        theta6 = jointAngles(:, 6);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        thetaDot5 = jointVelocities(:, 5);
        thetaDot6 = jointVelocities(:, 6);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta5, theta6, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^2.*theta5.^2, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta1.^2.*theta5.^3, theta1.^2.*theta6.^2, theta1.^3.*theta5.^2, theta2.^2.*theta4.^3, theta2.^2.*theta5.^2, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta1.^2.*theta6.^3, theta1.^3.*theta6.^2, theta2.^2.*theta5.^3, theta2.^2.*theta6.^2, theta2.^3.*theta5.^2, theta3.^2.*theta4.^3, theta3.^2.*theta5.^2, theta3.^3.*theta4.^2, theta2.^2.*theta6.^3, theta2.^3.*theta6.^2, theta3.^2.*theta5.^3, theta3.^2.*theta6.^2, theta3.^3.*theta5.^2, theta4.^2.*theta5.^2, theta3.^2.*theta6.^3, theta3.^3.*theta6.^2, theta4.^2.*theta5.^3, theta4.^2.*theta6.^2, theta4.^3.*theta5.^2, theta4.^2.*theta6.^3, theta4.^3.*theta6.^2, theta5.^2.*theta6.^2, theta5.^2.*theta6.^3, theta5.^3.*theta6.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta1.*theta5, theta2.*theta4, theta1.*theta6, theta2.*theta5, theta3.*theta4, theta2.*theta6, theta3.*theta5, theta3.*theta6, theta4.*theta5, theta4.*theta6, theta5.*theta6, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta1.*theta5.^2, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^2.*theta5, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta1.*theta5.^3, theta1.*theta6.^2, theta2.*theta3.^4, theta2.*theta4.^3, theta2.*theta5.^2, theta3.*theta4.^2, theta1.^2.*theta6, theta1.^3.*theta5, theta2.^2.*theta5, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta1.*theta5.^4, theta1.*theta6.^3, theta2.*theta4.^4, theta2.*theta5.^3, theta2.*theta6.^2, theta3.*theta4.^3, theta3.*theta5.^2, theta1.^3.*theta6, theta2.^2.*theta6, theta1.^4.*theta5, theta2.^3.*theta5, theta3.^2.*theta5, theta2.^4.*theta4, theta3.^3.*theta4, theta1.*theta6.^4, theta2.*theta5.^4, theta2.*theta6.^3, theta3.*theta4.^4, theta3.*theta5.^3, theta3.*theta6.^2, theta4.*theta5.^2, theta1.^4.*theta6, theta2.^3.*theta6, theta3.^2.*theta6, theta2.^4.*theta5, theta3.^3.*theta5, theta4.^2.*theta5, theta3.^4.*theta4, theta2.*theta6.^4, theta3.*theta5.^4, theta3.*theta6.^3, theta4.*theta5.^3, theta4.*theta6.^2, theta2.^4.*theta6, theta3.^3.*theta6, theta4.^2.*theta6, theta3.^4.*theta5, theta4.^3.*theta5, theta3.*theta6.^4, theta4.*theta5.^4, theta4.*theta6.^3, theta5.*theta6.^2, theta3.^4.*theta6, theta4.^3.*theta6, theta5.^2.*theta6, theta4.^4.*theta5, theta4.*theta6.^4, theta5.*theta6.^3, theta4.^4.*theta6, theta5.^3.*theta6, theta5.*theta6.^4, theta5.^4.*theta6, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta5.^2, theta3.^5, theta4.^4, theta5.^3, theta6.^2, theta4.^5, theta5.^4, theta6.^3, theta5.^5, theta6.^4, theta6.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta2.*theta5.^2, theta1.*theta3.*theta4.^2, theta1.*theta2.^2.*theta5, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta2.*theta5, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta2.*theta5.^3, theta1.*theta2.*theta6.^2, theta1.*theta3.*theta4.^3, theta1.*theta3.*theta5.^2, theta1.*theta2.^2.*theta6, theta1.*theta2.^3.*theta5, theta1.*theta3.^2.*theta5, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^2.*theta2.*theta6, theta1.^2.*theta3.*theta5, theta1.^3.*theta2.*theta5, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta1.*theta2.*theta6.^3, theta1.*theta3.*theta5.^3, theta1.*theta3.*theta6.^2, theta1.*theta4.*theta5.^2, theta1.*theta2.^3.*theta6, theta1.*theta3.^2.*theta6, theta1.*theta3.^3.*theta5, theta1.*theta4.^2.*theta5, theta2.*theta3.*theta4.^3, theta2.*theta3.*theta5.^2, theta2.*theta3.^2.*theta5, theta2.*theta3.^3.*theta4, theta1.^2.*theta3.*theta6, theta1.^2.*theta4.*theta5, theta1.^3.*theta2.*theta6, theta1.^3.*theta3.*theta5, theta2.^2.*theta3.*theta5, theta2.^3.*theta3.*theta4, theta1.*theta3.*theta6.^3, theta1.*theta4.*theta5.^3, theta1.*theta4.*theta6.^2, theta1.*theta3.^3.*theta6, theta1.*theta4.^2.*theta6, theta1.*theta4.^3.*theta5, theta2.*theta3.*theta5.^3, theta2.*theta3.*theta6.^2, theta2.*theta4.*theta5.^2, theta2.*theta3.^2.*theta6, theta2.*theta3.^3.*theta5, theta2.*theta4.^2.*theta5, theta1.^2.*theta4.*theta6, theta1.^3.*theta3.*theta6, theta1.^3.*theta4.*theta5, theta2.^2.*theta3.*theta6, theta2.^2.*theta4.*theta5, theta2.^3.*theta3.*theta5, theta1.*theta4.*theta6.^3, theta1.*theta5.*theta6.^2, theta1.*theta4.^3.*theta6, theta1.*theta5.^2.*theta6, theta2.*theta3.*theta6.^3, theta2.*theta4.*theta5.^3, theta2.*theta4.*theta6.^2, theta2.*theta3.^3.*theta6, theta2.*theta4.^2.*theta6, theta2.*theta4.^3.*theta5, theta3.*theta4.*theta5.^2, theta3.*theta4.^2.*theta5, theta1.^2.*theta5.*theta6, theta1.^3.*theta4.*theta6, theta2.^2.*theta4.*theta6, theta2.^3.*theta3.*theta6, theta2.^3.*theta4.*theta5, theta3.^2.*theta4.*theta5, theta1.*theta5.*theta6.^3, theta1.*theta5.^3.*theta6, theta2.*theta4.*theta6.^3, theta2.*theta5.*theta6.^2, theta2.*theta4.^3.*theta6, theta2.*theta5.^2.*theta6, theta3.*theta4.*theta5.^3, theta3.*theta4.*theta6.^2, theta3.*theta4.^2.*theta6, theta3.*theta4.^3.*theta5, theta1.^3.*theta5.*theta6, theta2.^2.*theta5.*theta6, theta2.^3.*theta4.*theta6, theta3.^2.*theta4.*theta6, theta3.^3.*theta4.*theta5, theta2.*theta5.*theta6.^3, theta2.*theta5.^3.*theta6, theta3.*theta4.*theta6.^3, theta3.*theta5.*theta6.^2, theta3.*theta4.^3.*theta6, theta3.*theta5.^2.*theta6, theta2.^3.*theta5.*theta6, theta3.^2.*theta5.*theta6, theta3.^3.*theta4.*theta6, theta3.*theta5.*theta6.^3, theta3.*theta5.^3.*theta6, theta4.*theta5.*theta6.^2, theta4.*theta5.^2.*theta6, theta3.^3.*theta5.*theta6, theta4.^2.*theta5.*theta6, theta4.*theta5.*theta6.^3, theta4.*theta5.^3.*theta6, theta4.^3.*theta5.*theta6, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta2.^2.*theta5.^2, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta5.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta2.^2.*theta5, theta1.^2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta6.^2, theta1.*theta3.^2.*theta5.^2, theta2.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta6.^2, theta1.^2.*theta3.*theta5.^2, theta1.^2.*theta2.^2.*theta6, theta1.^2.*theta3.^2.*theta5, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta3.^2.*theta6.^2, theta1.*theta4.^2.*theta5.^2, theta2.*theta3.^2.*theta5.^2, theta1.^2.*theta3.*theta6.^2, theta1.^2.*theta4.*theta5.^2, theta1.^2.*theta3.^2.*theta6, theta1.^2.*theta4.^2.*theta5, theta2.^2.*theta3.*theta5.^2, theta2.^2.*theta3.^2.*theta5, theta1.*theta4.^2.*theta6.^2, theta2.*theta3.^2.*theta6.^2, theta2.*theta4.^2.*theta5.^2, theta1.^2.*theta4.*theta6.^2, theta1.^2.*theta4.^2.*theta6, theta2.^2.*theta3.*theta6.^2, theta2.^2.*theta4.*theta5.^2, theta2.^2.*theta3.^2.*theta6, theta2.^2.*theta4.^2.*theta5, theta1.*theta5.^2.*theta6.^2, theta2.*theta4.^2.*theta6.^2, theta3.*theta4.^2.*theta5.^2, theta1.^2.*theta5.*theta6.^2, theta1.^2.*theta5.^2.*theta6, theta2.^2.*theta4.*theta6.^2, theta2.^2.*theta4.^2.*theta6, theta3.^2.*theta4.*theta5.^2, theta3.^2.*theta4.^2.*theta5, theta2.*theta5.^2.*theta6.^2, theta3.*theta4.^2.*theta6.^2, theta2.^2.*theta5.*theta6.^2, theta2.^2.*theta5.^2.*theta6, theta3.^2.*theta4.*theta6.^2, theta3.^2.*theta4.^2.*theta6, theta3.*theta5.^2.*theta6.^2, theta3.^2.*theta5.*theta6.^2, theta3.^2.*theta5.^2.*theta6, theta4.*theta5.^2.*theta6.^2, theta4.^2.*theta5.*theta6.^2, theta4.^2.*theta5.^2.*theta6, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta2.*theta5, theta1.*theta3.*theta4, theta1.*theta2.*theta6, theta1.*theta3.*theta5, theta2.*theta3.*theta4, theta1.*theta3.*theta6, theta1.*theta4.*theta5, theta2.*theta3.*theta5, theta1.*theta4.*theta6, theta2.*theta3.*theta6, theta2.*theta4.*theta5, theta1.*theta5.*theta6, theta2.*theta4.*theta6, theta3.*theta4.*theta5, theta2.*theta5.*theta6, theta3.*theta4.*theta6, theta3.*theta5.*theta6, theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6, theta1.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6, theta1.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6, theta1.*theta3.*theta4.*theta6, theta2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6, theta2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6, theta2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5.^2, theta1.*theta2.*theta3.^2.*theta5, theta1.*theta2.^2.*theta3.*theta5, theta1.^2.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6.^2, theta1.*theta2.*theta4.*theta5.^2, theta1.*theta2.*theta3.^2.*theta6, theta1.*theta2.*theta4.^2.*theta5, theta1.*theta2.^2.*theta3.*theta6, theta1.*theta2.^2.*theta4.*theta5, theta1.^2.*theta2.*theta3.*theta6, theta1.^2.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6.^2, theta1.*theta2.*theta4.^2.*theta6, theta1.*theta3.*theta4.*theta5.^2, theta1.*theta3.*theta4.^2.*theta5, theta1.*theta2.^2.*theta4.*theta6, theta1.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta4.*theta6, theta1.^2.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6.^2, theta1.*theta2.*theta5.^2.*theta6, theta1.*theta3.*theta4.*theta6.^2, theta1.*theta3.*theta4.^2.*theta6, theta1.*theta2.^2.*theta5.*theta6, theta1.*theta3.^2.*theta4.*theta6, theta2.*theta3.*theta4.*theta5.^2, theta2.*theta3.*theta4.^2.*theta5, theta2.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta5.*theta6, theta1.^2.*theta3.*theta4.*theta6, theta2.^2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6.^2, theta1.*theta3.*theta5.^2.*theta6, theta1.*theta3.^2.*theta5.*theta6, theta2.*theta3.*theta4.*theta6.^2, theta2.*theta3.*theta4.^2.*theta6, theta2.*theta3.^2.*theta4.*theta6, theta1.^2.*theta3.*theta5.*theta6, theta2.^2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6.^2, theta1.*theta4.*theta5.^2.*theta6, theta1.*theta4.^2.*theta5.*theta6, theta2.*theta3.*theta5.*theta6.^2, theta2.*theta3.*theta5.^2.*theta6, theta2.*theta3.^2.*theta5.*theta6, theta1.^2.*theta4.*theta5.*theta6, theta2.^2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6.^2, theta2.*theta4.*theta5.^2.*theta6, theta2.*theta4.^2.*theta5.*theta6, theta2.^2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6.^2, theta3.*theta4.*theta5.^2.*theta6, theta3.*theta4.^2.*theta5.*theta6, theta3.^2.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.*theta5, theta1.*theta2.*theta3.*theta4.*theta6, theta1.*theta2.*theta3.*theta5.*theta6, theta1.*theta2.*theta4.*theta5.*theta6, theta1.*theta3.*theta4.*theta5.*theta6, theta2.*theta3.*theta4.*theta5.*theta6, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, thetaDot5, thetaDot6, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta5.*thetaDot5, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta1.*theta5.^3.*thetaDot1 + 3.*theta1.^2.*theta5.^2.*thetaDot5, 2.*theta1.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta6.*thetaDot6, 2.*theta1.^3.*theta5.*thetaDot5 + 3.*theta1.^2.*theta5.^2.*thetaDot1, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.*theta5.^2.*thetaDot2 + 2.*theta2.^2.*theta5.*thetaDot5, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta1.*theta6.^3.*thetaDot1 + 3.*theta1.^2.*theta6.^2.*thetaDot6, 2.*theta1.^3.*theta6.*thetaDot6 + 3.*theta1.^2.*theta6.^2.*thetaDot1, 2.*theta2.*theta5.^3.*thetaDot2 + 3.*theta2.^2.*theta5.^2.*thetaDot5, 2.*theta2.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta6.*thetaDot6, 2.*theta2.^3.*theta5.*thetaDot5 + 3.*theta2.^2.*theta5.^2.*thetaDot2, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.*theta5.^2.*thetaDot3 + 2.*theta3.^2.*theta5.*thetaDot5, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, 2.*theta2.*theta6.^3.*thetaDot2 + 3.*theta2.^2.*theta6.^2.*thetaDot6, 2.*theta2.^3.*theta6.*thetaDot6 + 3.*theta2.^2.*theta6.^2.*thetaDot2, 2.*theta3.*theta5.^3.*thetaDot3 + 3.*theta3.^2.*theta5.^2.*thetaDot5, 2.*theta3.*theta6.^2.*thetaDot3 + 2.*theta3.^2.*theta6.*thetaDot6, 2.*theta3.^3.*theta5.*thetaDot5 + 3.*theta3.^2.*theta5.^2.*thetaDot3, 2.*theta4.*theta5.^2.*thetaDot4 + 2.*theta4.^2.*theta5.*thetaDot5, 2.*theta3.*theta6.^3.*thetaDot3 + 3.*theta3.^2.*theta6.^2.*thetaDot6, 2.*theta3.^3.*theta6.*thetaDot6 + 3.*theta3.^2.*theta6.^2.*thetaDot3, 2.*theta4.*theta5.^3.*thetaDot4 + 3.*theta4.^2.*theta5.^2.*thetaDot5, 2.*theta4.*theta6.^2.*thetaDot4 + 2.*theta4.^2.*theta6.*thetaDot6, 2.*theta4.^3.*theta5.*thetaDot5 + 3.*theta4.^2.*theta5.^2.*thetaDot4, 2.*theta4.*theta6.^3.*thetaDot4 + 3.*theta4.^2.*theta6.^2.*thetaDot6, 2.*theta4.^3.*theta6.*thetaDot6 + 3.*theta4.^2.*theta6.^2.*thetaDot4, 2.*theta5.*theta6.^2.*thetaDot5 + 2.*theta5.^2.*theta6.*thetaDot6, 2.*theta5.*theta6.^3.*thetaDot5 + 3.*theta5.^2.*theta6.^2.*thetaDot6, 2.*theta5.^3.*theta6.*thetaDot6 + 3.*theta5.^2.*theta6.^2.*thetaDot5, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta1.*thetaDot5 + theta5.*thetaDot1, theta2.*thetaDot4 + theta4.*thetaDot2, theta1.*thetaDot6 + theta6.*thetaDot1, theta2.*thetaDot5 + theta5.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.*thetaDot6 + theta6.*thetaDot2, theta3.*thetaDot5 + theta5.*thetaDot3, theta3.*thetaDot6 + theta6.*thetaDot3, theta4.*thetaDot5 + theta5.*thetaDot4, theta4.*thetaDot6 + theta6.*thetaDot4, theta5.*thetaDot6 + theta6.*thetaDot5, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta5.^2.*thetaDot1 + 2.*theta1.*theta5.*thetaDot5, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^2.*thetaDot5 + 2.*theta1.*theta5.*thetaDot1, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta5.^3.*thetaDot1 + 3.*theta1.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot1 + 2.*theta1.*theta6.*thetaDot6, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta5.^2.*thetaDot2 + 2.*theta2.*theta5.*thetaDot5, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^2.*thetaDot6 + 2.*theta1.*theta6.*thetaDot1, theta1.^3.*thetaDot5 + 3.*theta1.^2.*theta5.*thetaDot1, theta2.^2.*thetaDot5 + 2.*theta2.*theta5.*thetaDot2, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta5.^4.*thetaDot1 + 4.*theta1.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot1 + 3.*theta1.*theta6.^2.*thetaDot6, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta5.^3.*thetaDot2 + 3.*theta2.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot2 + 2.*theta2.*theta6.*thetaDot6, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta5.^2.*thetaDot3 + 2.*theta3.*theta5.*thetaDot5, theta1.^3.*thetaDot6 + 3.*theta1.^2.*theta6.*thetaDot1, theta2.^2.*thetaDot6 + 2.*theta2.*theta6.*thetaDot2, theta1.^4.*thetaDot5 + 4.*theta1.^3.*theta5.*thetaDot1, theta2.^3.*thetaDot5 + 3.*theta2.^2.*theta5.*thetaDot2, theta3.^2.*thetaDot5 + 2.*theta3.*theta5.*thetaDot3, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta6.^4.*thetaDot1 + 4.*theta1.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot2 + 4.*theta2.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot2 + 3.*theta2.*theta6.^2.*thetaDot6, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta5.^3.*thetaDot3 + 3.*theta3.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot3 + 2.*theta3.*theta6.*thetaDot6, theta5.^2.*thetaDot4 + 2.*theta4.*theta5.*thetaDot5, theta1.^4.*thetaDot6 + 4.*theta1.^3.*theta6.*thetaDot1, theta2.^3.*thetaDot6 + 3.*theta2.^2.*theta6.*thetaDot2, theta3.^2.*thetaDot6 + 2.*theta3.*theta6.*thetaDot3, theta2.^4.*thetaDot5 + 4.*theta2.^3.*theta5.*thetaDot2, theta3.^3.*thetaDot5 + 3.*theta3.^2.*theta5.*thetaDot3, theta4.^2.*thetaDot5 + 2.*theta4.*theta5.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, theta6.^4.*thetaDot2 + 4.*theta2.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot3 + 4.*theta3.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot3 + 3.*theta3.*theta6.^2.*thetaDot6, theta5.^3.*thetaDot4 + 3.*theta4.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot4 + 2.*theta4.*theta6.*thetaDot6, theta2.^4.*thetaDot6 + 4.*theta2.^3.*theta6.*thetaDot2, theta3.^3.*thetaDot6 + 3.*theta3.^2.*theta6.*thetaDot3, theta4.^2.*thetaDot6 + 2.*theta4.*theta6.*thetaDot4, theta3.^4.*thetaDot5 + 4.*theta3.^3.*theta5.*thetaDot3, theta4.^3.*thetaDot5 + 3.*theta4.^2.*theta5.*thetaDot4, theta6.^4.*thetaDot3 + 4.*theta3.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot4 + 4.*theta4.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot4 + 3.*theta4.*theta6.^2.*thetaDot6, theta6.^2.*thetaDot5 + 2.*theta5.*theta6.*thetaDot6, theta3.^4.*thetaDot6 + 4.*theta3.^3.*theta6.*thetaDot3, theta4.^3.*thetaDot6 + 3.*theta4.^2.*theta6.*thetaDot4, theta5.^2.*thetaDot6 + 2.*theta5.*theta6.*thetaDot5, theta4.^4.*thetaDot5 + 4.*theta4.^3.*theta5.*thetaDot4, theta6.^4.*thetaDot4 + 4.*theta4.*theta6.^3.*thetaDot6, theta6.^3.*thetaDot5 + 3.*theta5.*theta6.^2.*thetaDot6, theta4.^4.*thetaDot6 + 4.*theta4.^3.*theta6.*thetaDot4, theta5.^3.*thetaDot6 + 3.*theta5.^2.*theta6.*thetaDot5, theta6.^4.*thetaDot5 + 4.*theta5.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot6 + 4.*theta5.^3.*theta6.*thetaDot5, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 2.*theta5.*thetaDot5, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 3.*theta5.^2.*thetaDot5, 2.*theta6.*thetaDot6, 5.*theta4.^4.*thetaDot4, 4.*theta5.^3.*thetaDot5, 3.*theta6.^2.*thetaDot6, 5.*theta5.^4.*thetaDot5, 4.*theta6.^3.*thetaDot6, 5.*theta6.^4.*thetaDot6, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta5.^2.*thetaDot2 + theta2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta5.*thetaDot5, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot5 + theta2.^2.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta5.*thetaDot2, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta2.*thetaDot5 + theta1.^2.*theta5.*thetaDot2 + 2.*theta1.*theta2.*theta5.*thetaDot1, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta5.^3.*thetaDot2 + theta2.*theta5.^3.*thetaDot1 + 3.*theta1.*theta2.*theta5.^2.*thetaDot5, theta1.*theta6.^2.*thetaDot2 + theta2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta6.*thetaDot6, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta5.^2.*thetaDot3 + theta3.*theta5.^2.*thetaDot1 + 2.*theta1.*theta3.*theta5.*thetaDot5, theta1.*theta2.^2.*thetaDot6 + theta2.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta6.*thetaDot2, theta1.*theta2.^3.*thetaDot5 + theta2.^3.*theta5.*thetaDot1 + 3.*theta1.*theta2.^2.*theta5.*thetaDot2, theta1.*theta3.^2.*thetaDot5 + theta3.^2.*theta5.*thetaDot1 + 2.*theta1.*theta3.*theta5.*thetaDot3, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^2.*theta2.*thetaDot6 + theta1.^2.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta6.*thetaDot1, theta1.^2.*theta3.*thetaDot5 + theta1.^2.*theta5.*thetaDot3 + 2.*theta1.*theta3.*theta5.*thetaDot1, theta1.^3.*theta2.*thetaDot5 + theta1.^3.*theta5.*thetaDot2 + 3.*theta1.^2.*theta2.*theta5.*thetaDot1, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta1.*theta6.^3.*thetaDot2 + theta2.*theta6.^3.*thetaDot1 + 3.*theta1.*theta2.*theta6.^2.*thetaDot6, theta1.*theta5.^3.*thetaDot3 + theta3.*theta5.^3.*thetaDot1 + 3.*theta1.*theta3.*theta5.^2.*thetaDot5, theta1.*theta6.^2.*thetaDot3 + theta3.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta6.*thetaDot6, theta1.*theta5.^2.*thetaDot4 + theta4.*theta5.^2.*thetaDot1 + 2.*theta1.*theta4.*theta5.*thetaDot5, theta1.*theta2.^3.*thetaDot6 + theta2.^3.*theta6.*thetaDot1 + 3.*theta1.*theta2.^2.*theta6.*thetaDot2, theta1.*theta3.^2.*thetaDot6 + theta3.^2.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta6.*thetaDot3, theta1.*theta3.^3.*thetaDot5 + theta3.^3.*theta5.*thetaDot1 + 3.*theta1.*theta3.^2.*theta5.*thetaDot3, theta1.*theta4.^2.*thetaDot5 + theta4.^2.*theta5.*thetaDot1 + 2.*theta1.*theta4.*theta5.*thetaDot4, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta5.^2.*thetaDot3 + theta3.*theta5.^2.*thetaDot2 + 2.*theta2.*theta3.*theta5.*thetaDot5, theta2.*theta3.^2.*thetaDot5 + theta3.^2.*theta5.*thetaDot2 + 2.*theta2.*theta3.*theta5.*thetaDot3, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot6 + theta1.^2.*theta6.*thetaDot3 + 2.*theta1.*theta3.*theta6.*thetaDot1, theta1.^2.*theta4.*thetaDot5 + theta1.^2.*theta5.*thetaDot4 + 2.*theta1.*theta4.*theta5.*thetaDot1, theta1.^3.*theta2.*thetaDot6 + theta1.^3.*theta6.*thetaDot2 + 3.*theta1.^2.*theta2.*theta6.*thetaDot1, theta1.^3.*theta3.*thetaDot5 + theta1.^3.*theta5.*thetaDot3 + 3.*theta1.^2.*theta3.*theta5.*thetaDot1, theta2.^2.*theta3.*thetaDot5 + theta2.^2.*theta5.*thetaDot3 + 2.*theta2.*theta3.*theta5.*thetaDot2, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta1.*theta6.^3.*thetaDot3 + theta3.*theta6.^3.*thetaDot1 + 3.*theta1.*theta3.*theta6.^2.*thetaDot6, theta1.*theta5.^3.*thetaDot4 + theta4.*theta5.^3.*thetaDot1 + 3.*theta1.*theta4.*theta5.^2.*thetaDot5, theta1.*theta6.^2.*thetaDot4 + theta4.*theta6.^2.*thetaDot1 + 2.*theta1.*theta4.*theta6.*thetaDot6, theta1.*theta3.^3.*thetaDot6 + theta3.^3.*theta6.*thetaDot1 + 3.*theta1.*theta3.^2.*theta6.*thetaDot3, theta1.*theta4.^2.*thetaDot6 + theta4.^2.*theta6.*thetaDot1 + 2.*theta1.*theta4.*theta6.*thetaDot4, theta1.*theta4.^3.*thetaDot5 + theta4.^3.*theta5.*thetaDot1 + 3.*theta1.*theta4.^2.*theta5.*thetaDot4, theta2.*theta5.^3.*thetaDot3 + theta3.*theta5.^3.*thetaDot2 + 3.*theta2.*theta3.*theta5.^2.*thetaDot5, theta2.*theta6.^2.*thetaDot3 + theta3.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta6.*thetaDot6, theta2.*theta5.^2.*thetaDot4 + theta4.*theta5.^2.*thetaDot2 + 2.*theta2.*theta4.*theta5.*thetaDot5, theta2.*theta3.^2.*thetaDot6 + theta3.^2.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta6.*thetaDot3, theta2.*theta3.^3.*thetaDot5 + theta3.^3.*theta5.*thetaDot2 + 3.*theta2.*theta3.^2.*theta5.*thetaDot3, theta2.*theta4.^2.*thetaDot5 + theta4.^2.*theta5.*thetaDot2 + 2.*theta2.*theta4.*theta5.*thetaDot4, theta1.^2.*theta4.*thetaDot6 + theta1.^2.*theta6.*thetaDot4 + 2.*theta1.*theta4.*theta6.*thetaDot1, theta1.^3.*theta3.*thetaDot6 + theta1.^3.*theta6.*thetaDot3 + 3.*theta1.^2.*theta3.*theta6.*thetaDot1, theta1.^3.*theta4.*thetaDot5 + theta1.^3.*theta5.*thetaDot4 + 3.*theta1.^2.*theta4.*theta5.*thetaDot1, theta2.^2.*theta3.*thetaDot6 + theta2.^2.*theta6.*thetaDot3 + 2.*theta2.*theta3.*theta6.*thetaDot2, theta2.^2.*theta4.*thetaDot5 + theta2.^2.*theta5.*thetaDot4 + 2.*theta2.*theta4.*theta5.*thetaDot2, theta2.^3.*theta3.*thetaDot5 + theta2.^3.*theta5.*thetaDot3 + 3.*theta2.^2.*theta3.*theta5.*thetaDot2, theta1.*theta6.^3.*thetaDot4 + theta4.*theta6.^3.*thetaDot1 + 3.*theta1.*theta4.*theta6.^2.*thetaDot6, theta1.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta5.*theta6.*thetaDot6, theta1.*theta4.^3.*thetaDot6 + theta4.^3.*theta6.*thetaDot1 + 3.*theta1.*theta4.^2.*theta6.*thetaDot4, theta1.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta5.*theta6.*thetaDot5, theta2.*theta6.^3.*thetaDot3 + theta3.*theta6.^3.*thetaDot2 + 3.*theta2.*theta3.*theta6.^2.*thetaDot6, theta2.*theta5.^3.*thetaDot4 + theta4.*theta5.^3.*thetaDot2 + 3.*theta2.*theta4.*theta5.^2.*thetaDot5, theta2.*theta6.^2.*thetaDot4 + theta4.*theta6.^2.*thetaDot2 + 2.*theta2.*theta4.*theta6.*thetaDot6, theta2.*theta3.^3.*thetaDot6 + theta3.^3.*theta6.*thetaDot2 + 3.*theta2.*theta3.^2.*theta6.*thetaDot3, theta2.*theta4.^2.*thetaDot6 + theta4.^2.*theta6.*thetaDot2 + 2.*theta2.*theta4.*theta6.*thetaDot4, theta2.*theta4.^3.*thetaDot5 + theta4.^3.*theta5.*thetaDot2 + 3.*theta2.*theta4.^2.*theta5.*thetaDot4, theta3.*theta5.^2.*thetaDot4 + theta4.*theta5.^2.*thetaDot3 + 2.*theta3.*theta4.*theta5.*thetaDot5, theta3.*theta4.^2.*thetaDot5 + theta4.^2.*theta5.*thetaDot3 + 2.*theta3.*theta4.*theta5.*thetaDot4, theta1.^2.*theta5.*thetaDot6 + theta1.^2.*theta6.*thetaDot5 + 2.*theta1.*theta5.*theta6.*thetaDot1, theta1.^3.*theta4.*thetaDot6 + theta1.^3.*theta6.*thetaDot4 + 3.*theta1.^2.*theta4.*theta6.*thetaDot1, theta2.^2.*theta4.*thetaDot6 + theta2.^2.*theta6.*thetaDot4 + 2.*theta2.*theta4.*theta6.*thetaDot2, theta2.^3.*theta3.*thetaDot6 + theta2.^3.*theta6.*thetaDot3 + 3.*theta2.^2.*theta3.*theta6.*thetaDot2, theta2.^3.*theta4.*thetaDot5 + theta2.^3.*theta5.*thetaDot4 + 3.*theta2.^2.*theta4.*theta5.*thetaDot2, theta3.^2.*theta4.*thetaDot5 + theta3.^2.*theta5.*thetaDot4 + 2.*theta3.*theta4.*theta5.*thetaDot3, theta1.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot1 + 3.*theta1.*theta5.*theta6.^2.*thetaDot6, theta1.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot1 + 3.*theta1.*theta5.^2.*theta6.*thetaDot5, theta2.*theta6.^3.*thetaDot4 + theta4.*theta6.^3.*thetaDot2 + 3.*theta2.*theta4.*theta6.^2.*thetaDot6, theta2.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot2 + 2.*theta2.*theta5.*theta6.*thetaDot6, theta2.*theta4.^3.*thetaDot6 + theta4.^3.*theta6.*thetaDot2 + 3.*theta2.*theta4.^2.*theta6.*thetaDot4, theta2.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot2 + 2.*theta2.*theta5.*theta6.*thetaDot5, theta3.*theta5.^3.*thetaDot4 + theta4.*theta5.^3.*thetaDot3 + 3.*theta3.*theta4.*theta5.^2.*thetaDot5, theta3.*theta6.^2.*thetaDot4 + theta4.*theta6.^2.*thetaDot3 + 2.*theta3.*theta4.*theta6.*thetaDot6, theta3.*theta4.^2.*thetaDot6 + theta4.^2.*theta6.*thetaDot3 + 2.*theta3.*theta4.*theta6.*thetaDot4, theta3.*theta4.^3.*thetaDot5 + theta4.^3.*theta5.*thetaDot3 + 3.*theta3.*theta4.^2.*theta5.*thetaDot4, theta1.^3.*theta5.*thetaDot6 + theta1.^3.*theta6.*thetaDot5 + 3.*theta1.^2.*theta5.*theta6.*thetaDot1, theta2.^2.*theta5.*thetaDot6 + theta2.^2.*theta6.*thetaDot5 + 2.*theta2.*theta5.*theta6.*thetaDot2, theta2.^3.*theta4.*thetaDot6 + theta2.^3.*theta6.*thetaDot4 + 3.*theta2.^2.*theta4.*theta6.*thetaDot2, theta3.^2.*theta4.*thetaDot6 + theta3.^2.*theta6.*thetaDot4 + 2.*theta3.*theta4.*theta6.*thetaDot3, theta3.^3.*theta4.*thetaDot5 + theta3.^3.*theta5.*thetaDot4 + 3.*theta3.^2.*theta4.*theta5.*thetaDot3, theta2.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot2 + 3.*theta2.*theta5.*theta6.^2.*thetaDot6, theta2.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot2 + 3.*theta2.*theta5.^2.*theta6.*thetaDot5, theta3.*theta6.^3.*thetaDot4 + theta4.*theta6.^3.*thetaDot3 + 3.*theta3.*theta4.*theta6.^2.*thetaDot6, theta3.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot3 + 2.*theta3.*theta5.*theta6.*thetaDot6, theta3.*theta4.^3.*thetaDot6 + theta4.^3.*theta6.*thetaDot3 + 3.*theta3.*theta4.^2.*theta6.*thetaDot4, theta3.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot3 + 2.*theta3.*theta5.*theta6.*thetaDot5, theta2.^3.*theta5.*thetaDot6 + theta2.^3.*theta6.*thetaDot5 + 3.*theta2.^2.*theta5.*theta6.*thetaDot2, theta3.^2.*theta5.*thetaDot6 + theta3.^2.*theta6.*thetaDot5 + 2.*theta3.*theta5.*theta6.*thetaDot3, theta3.^3.*theta4.*thetaDot6 + theta3.^3.*theta6.*thetaDot4 + 3.*theta3.^2.*theta4.*theta6.*thetaDot3, theta3.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot3 + 3.*theta3.*theta5.*theta6.^2.*thetaDot6, theta3.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot3 + 3.*theta3.*theta5.^2.*theta6.*thetaDot5, theta4.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot4 + 2.*theta4.*theta5.*theta6.*thetaDot6, theta4.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot4 + 2.*theta4.*theta5.*theta6.*thetaDot5, theta3.^3.*theta5.*thetaDot6 + theta3.^3.*theta6.*thetaDot5 + 3.*theta3.^2.*theta5.*theta6.*thetaDot3, theta4.^2.*theta5.*thetaDot6 + theta4.^2.*theta6.*thetaDot5 + 2.*theta4.*theta5.*theta6.*thetaDot4, theta4.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot4 + 3.*theta4.*theta5.*theta6.^2.*thetaDot6, theta4.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot4 + 3.*theta4.*theta5.^2.*theta6.*thetaDot5, theta4.^3.*theta5.*thetaDot6 + theta4.^3.*theta6.*thetaDot5 + 3.*theta4.^2.*theta5.*theta6.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta2.^2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta5.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta5.*thetaDot5, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta5.^2.*thetaDot2 + 2.*theta1.*theta2.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta5.*thetaDot5, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot5 + 2.*theta1.*theta2.^2.*theta5.*thetaDot1 + 2.*theta1.^2.*theta2.*theta5.*thetaDot2, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta2.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta6.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta6.*thetaDot6, theta3.^2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta3.*theta5.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta5.*thetaDot5, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta6.^2.*thetaDot2 + 2.*theta1.*theta2.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta6.*thetaDot6, theta1.^2.*theta5.^2.*thetaDot3 + 2.*theta1.*theta3.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta5.*thetaDot5, theta1.^2.*theta2.^2.*thetaDot6 + 2.*theta1.*theta2.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta2.*theta6.*thetaDot2, theta1.^2.*theta3.^2.*thetaDot5 + 2.*theta1.*theta3.^2.*theta5.*thetaDot1 + 2.*theta1.^2.*theta3.*theta5.*thetaDot3, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta6.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta4.*theta5.^2.*thetaDot4 + 2.*theta1.*theta4.^2.*theta5.*thetaDot5, theta3.^2.*theta5.^2.*thetaDot2 + 2.*theta2.*theta3.*theta5.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta5.*thetaDot5, theta1.^2.*theta6.^2.*thetaDot3 + 2.*theta1.*theta3.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta6.*thetaDot6, theta1.^2.*theta5.^2.*thetaDot4 + 2.*theta1.*theta4.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*theta5.*thetaDot5, theta1.^2.*theta3.^2.*thetaDot6 + 2.*theta1.*theta3.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta3.*theta6.*thetaDot3, theta1.^2.*theta4.^2.*thetaDot5 + 2.*theta1.*theta4.^2.*theta5.*thetaDot1 + 2.*theta1.^2.*theta4.*theta5.*thetaDot4, theta2.^2.*theta5.^2.*thetaDot3 + 2.*theta2.*theta3.*theta5.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta5.*thetaDot5, theta2.^2.*theta3.^2.*thetaDot5 + 2.*theta2.*theta3.^2.*theta5.*thetaDot2 + 2.*theta2.^2.*theta3.*theta5.*thetaDot3, theta4.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta4.*theta6.^2.*thetaDot4 + 2.*theta1.*theta4.^2.*theta6.*thetaDot6, theta3.^2.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta6.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot2 + 2.*theta2.*theta4.*theta5.^2.*thetaDot4 + 2.*theta2.*theta4.^2.*theta5.*thetaDot5, theta1.^2.*theta6.^2.*thetaDot4 + 2.*theta1.*theta4.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*theta6.*thetaDot6, theta1.^2.*theta4.^2.*thetaDot6 + 2.*theta1.*theta4.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta4.*theta6.*thetaDot4, theta2.^2.*theta6.^2.*thetaDot3 + 2.*theta2.*theta3.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta6.*thetaDot6, theta2.^2.*theta5.^2.*thetaDot4 + 2.*theta2.*theta4.*theta5.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*theta5.*thetaDot5, theta2.^2.*theta3.^2.*thetaDot6 + 2.*theta2.*theta3.^2.*theta6.*thetaDot2 + 2.*theta2.^2.*theta3.*theta6.*thetaDot3, theta2.^2.*theta4.^2.*thetaDot5 + 2.*theta2.*theta4.^2.*theta5.*thetaDot2 + 2.*theta2.^2.*theta4.*theta5.*thetaDot4, theta5.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta5.*theta6.^2.*thetaDot5 + 2.*theta1.*theta5.^2.*theta6.*thetaDot6, theta4.^2.*theta6.^2.*thetaDot2 + 2.*theta2.*theta4.*theta6.^2.*thetaDot4 + 2.*theta2.*theta4.^2.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot3 + 2.*theta3.*theta4.*theta5.^2.*thetaDot4 + 2.*theta3.*theta4.^2.*theta5.*thetaDot5, theta1.^2.*theta6.^2.*thetaDot5 + 2.*theta1.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta5.*theta6.*thetaDot6, theta1.^2.*theta5.^2.*thetaDot6 + 2.*theta1.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta5.*theta6.*thetaDot5, theta2.^2.*theta6.^2.*thetaDot4 + 2.*theta2.*theta4.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*theta6.*thetaDot6, theta2.^2.*theta4.^2.*thetaDot6 + 2.*theta2.*theta4.^2.*theta6.*thetaDot2 + 2.*theta2.^2.*theta4.*theta6.*thetaDot4, theta3.^2.*theta5.^2.*thetaDot4 + 2.*theta3.*theta4.*theta5.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*theta5.*thetaDot5, theta3.^2.*theta4.^2.*thetaDot5 + 2.*theta3.*theta4.^2.*theta5.*thetaDot3 + 2.*theta3.^2.*theta4.*theta5.*thetaDot4, theta5.^2.*theta6.^2.*thetaDot2 + 2.*theta2.*theta5.*theta6.^2.*thetaDot5 + 2.*theta2.*theta5.^2.*theta6.*thetaDot6, theta4.^2.*theta6.^2.*thetaDot3 + 2.*theta3.*theta4.*theta6.^2.*thetaDot4 + 2.*theta3.*theta4.^2.*theta6.*thetaDot6, theta2.^2.*theta6.^2.*thetaDot5 + 2.*theta2.*theta5.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta5.*theta6.*thetaDot6, theta2.^2.*theta5.^2.*thetaDot6 + 2.*theta2.*theta5.^2.*theta6.*thetaDot2 + 2.*theta2.^2.*theta5.*theta6.*thetaDot5, theta3.^2.*theta6.^2.*thetaDot4 + 2.*theta3.*theta4.*theta6.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*theta6.*thetaDot6, theta3.^2.*theta4.^2.*thetaDot6 + 2.*theta3.*theta4.^2.*theta6.*thetaDot3 + 2.*theta3.^2.*theta4.*theta6.*thetaDot4, theta5.^2.*theta6.^2.*thetaDot3 + 2.*theta3.*theta5.*theta6.^2.*thetaDot5 + 2.*theta3.*theta5.^2.*theta6.*thetaDot6, theta3.^2.*theta6.^2.*thetaDot5 + 2.*theta3.*theta5.*theta6.^2.*thetaDot3 + 2.*theta3.^2.*theta5.*theta6.*thetaDot6, theta3.^2.*theta5.^2.*thetaDot6 + 2.*theta3.*theta5.^2.*theta6.*thetaDot3 + 2.*theta3.^2.*theta5.*theta6.*thetaDot5, theta5.^2.*theta6.^2.*thetaDot4 + 2.*theta4.*theta5.*theta6.^2.*thetaDot5 + 2.*theta4.*theta5.^2.*theta6.*thetaDot6, theta4.^2.*theta6.^2.*thetaDot5 + 2.*theta4.*theta5.*theta6.^2.*thetaDot4 + 2.*theta4.^2.*theta5.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot6 + 2.*theta4.*theta5.^2.*theta6.*thetaDot4 + 2.*theta4.^2.*theta5.*theta6.*thetaDot5, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta2.*thetaDot5 + theta1.*theta5.*thetaDot2 + theta2.*theta5.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta1.*theta2.*thetaDot6 + theta1.*theta6.*thetaDot2 + theta2.*theta6.*thetaDot1, theta1.*theta3.*thetaDot5 + theta1.*theta5.*thetaDot3 + theta3.*theta5.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta3.*thetaDot6 + theta1.*theta6.*thetaDot3 + theta3.*theta6.*thetaDot1, theta1.*theta4.*thetaDot5 + theta1.*theta5.*thetaDot4 + theta4.*theta5.*thetaDot1, theta2.*theta3.*thetaDot5 + theta2.*theta5.*thetaDot3 + theta3.*theta5.*thetaDot2, theta1.*theta4.*thetaDot6 + theta1.*theta6.*thetaDot4 + theta4.*theta6.*thetaDot1, theta2.*theta3.*thetaDot6 + theta2.*theta6.*thetaDot3 + theta3.*theta6.*thetaDot2, theta2.*theta4.*thetaDot5 + theta2.*theta5.*thetaDot4 + theta4.*theta5.*thetaDot2, theta1.*theta5.*thetaDot6 + theta1.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot1, theta2.*theta4.*thetaDot6 + theta2.*theta6.*thetaDot4 + theta4.*theta6.*thetaDot2, theta3.*theta4.*thetaDot5 + theta3.*theta5.*thetaDot4 + theta4.*theta5.*thetaDot3, theta2.*theta5.*thetaDot6 + theta2.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot2, theta3.*theta4.*thetaDot6 + theta3.*theta6.*thetaDot4 + theta4.*theta6.*thetaDot3, theta3.*theta5.*thetaDot6 + theta3.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot3, theta4.*theta5.*thetaDot6 + theta4.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot4, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta3.*thetaDot5 + theta1.*theta2.*theta5.*thetaDot3 + theta1.*theta3.*theta5.*thetaDot2 + theta2.*theta3.*theta5.*thetaDot1, theta1.*theta2.*theta3.*thetaDot6 + theta1.*theta2.*theta6.*thetaDot3 + theta1.*theta3.*theta6.*thetaDot2 + theta2.*theta3.*theta6.*thetaDot1, theta1.*theta2.*theta4.*thetaDot5 + theta1.*theta2.*theta5.*thetaDot4 + theta1.*theta4.*theta5.*thetaDot2 + theta2.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta4.*thetaDot6 + theta1.*theta2.*theta6.*thetaDot4 + theta1.*theta4.*theta6.*thetaDot2 + theta2.*theta4.*theta6.*thetaDot1, theta1.*theta3.*theta4.*thetaDot5 + theta1.*theta3.*theta5.*thetaDot4 + theta1.*theta4.*theta5.*thetaDot3 + theta3.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta5.*thetaDot6 + theta1.*theta2.*theta6.*thetaDot5 + theta1.*theta5.*theta6.*thetaDot2 + theta2.*theta5.*theta6.*thetaDot1, theta1.*theta3.*theta4.*thetaDot6 + theta1.*theta3.*theta6.*thetaDot4 + theta1.*theta4.*theta6.*thetaDot3 + theta3.*theta4.*theta6.*thetaDot1, theta2.*theta3.*theta4.*thetaDot5 + theta2.*theta3.*theta5.*thetaDot4 + theta2.*theta4.*theta5.*thetaDot3 + theta3.*theta4.*theta5.*thetaDot2, theta1.*theta3.*theta5.*thetaDot6 + theta1.*theta3.*theta6.*thetaDot5 + theta1.*theta5.*theta6.*thetaDot3 + theta3.*theta5.*theta6.*thetaDot1, theta2.*theta3.*theta4.*thetaDot6 + theta2.*theta3.*theta6.*thetaDot4 + theta2.*theta4.*theta6.*thetaDot3 + theta3.*theta4.*theta6.*thetaDot2, theta1.*theta4.*theta5.*thetaDot6 + theta1.*theta4.*theta6.*thetaDot5 + theta1.*theta5.*theta6.*thetaDot4 + theta4.*theta5.*theta6.*thetaDot1, theta2.*theta3.*theta5.*thetaDot6 + theta2.*theta3.*theta6.*thetaDot5 + theta2.*theta5.*theta6.*thetaDot3 + theta3.*theta5.*theta6.*thetaDot2, theta2.*theta4.*theta5.*thetaDot6 + theta2.*theta4.*theta6.*thetaDot5 + theta2.*theta5.*theta6.*thetaDot4 + theta4.*theta5.*theta6.*thetaDot2, theta3.*theta4.*theta5.*thetaDot6 + theta3.*theta4.*theta6.*thetaDot5 + theta3.*theta5.*theta6.*thetaDot4 + theta4.*theta5.*theta6.*thetaDot3, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta5.^2.*thetaDot3 + theta1.*theta3.*theta5.^2.*thetaDot2 + theta2.*theta3.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot5, theta1.*theta2.*theta3.^2.*thetaDot5 + theta1.*theta3.^2.*theta5.*thetaDot2 + theta2.*theta3.^2.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot5 + theta1.*theta2.^2.*theta5.*thetaDot3 + theta2.^2.*theta3.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot5 + theta1.^2.*theta2.*theta5.*thetaDot3 + theta1.^2.*theta3.*theta5.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot1, theta1.*theta2.*theta6.^2.*thetaDot3 + theta1.*theta3.*theta6.^2.*thetaDot2 + theta2.*theta3.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot6, theta1.*theta2.*theta5.^2.*thetaDot4 + theta1.*theta4.*theta5.^2.*thetaDot2 + theta2.*theta4.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot5, theta1.*theta2.*theta3.^2.*thetaDot6 + theta1.*theta3.^2.*theta6.*thetaDot2 + theta2.*theta3.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot3, theta1.*theta2.*theta4.^2.*thetaDot5 + theta1.*theta4.^2.*theta5.*thetaDot2 + theta2.*theta4.^2.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot4, theta1.*theta2.^2.*theta3.*thetaDot6 + theta1.*theta2.^2.*theta6.*thetaDot3 + theta2.^2.*theta3.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot2, theta1.*theta2.^2.*theta4.*thetaDot5 + theta1.*theta2.^2.*theta5.*thetaDot4 + theta2.^2.*theta4.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot6 + theta1.^2.*theta2.*theta6.*thetaDot3 + theta1.^2.*theta3.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot1, theta1.^2.*theta2.*theta4.*thetaDot5 + theta1.^2.*theta2.*theta5.*thetaDot4 + theta1.^2.*theta4.*theta5.*thetaDot2 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta6.^2.*thetaDot4 + theta1.*theta4.*theta6.^2.*thetaDot2 + theta2.*theta4.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot6, theta1.*theta2.*theta4.^2.*thetaDot6 + theta1.*theta4.^2.*theta6.*thetaDot2 + theta2.*theta4.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot4, theta1.*theta3.*theta5.^2.*thetaDot4 + theta1.*theta4.*theta5.^2.*thetaDot3 + theta3.*theta4.*theta5.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot5, theta1.*theta3.*theta4.^2.*thetaDot5 + theta1.*theta4.^2.*theta5.*thetaDot3 + theta3.*theta4.^2.*theta5.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot4, theta1.*theta2.^2.*theta4.*thetaDot6 + theta1.*theta2.^2.*theta6.*thetaDot4 + theta2.^2.*theta4.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot2, theta1.*theta3.^2.*theta4.*thetaDot5 + theta1.*theta3.^2.*theta5.*thetaDot4 + theta3.^2.*theta4.*theta5.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot3, theta1.^2.*theta2.*theta4.*thetaDot6 + theta1.^2.*theta2.*theta6.*thetaDot4 + theta1.^2.*theta4.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot1, theta1.^2.*theta3.*theta4.*thetaDot5 + theta1.^2.*theta3.*theta5.*thetaDot4 + theta1.^2.*theta4.*theta5.*thetaDot3 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta6.^2.*thetaDot5 + theta1.*theta5.*theta6.^2.*thetaDot2 + theta2.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot6, theta1.*theta2.*theta5.^2.*thetaDot6 + theta1.*theta5.^2.*theta6.*thetaDot2 + theta2.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot5, theta1.*theta3.*theta6.^2.*thetaDot4 + theta1.*theta4.*theta6.^2.*thetaDot3 + theta3.*theta4.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot6, theta1.*theta3.*theta4.^2.*thetaDot6 + theta1.*theta4.^2.*theta6.*thetaDot3 + theta3.*theta4.^2.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot4, theta1.*theta2.^2.*theta5.*thetaDot6 + theta1.*theta2.^2.*theta6.*thetaDot5 + theta2.^2.*theta5.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot2, theta1.*theta3.^2.*theta4.*thetaDot6 + theta1.*theta3.^2.*theta6.*thetaDot4 + theta3.^2.*theta4.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot3, theta2.*theta3.*theta5.^2.*thetaDot4 + theta2.*theta4.*theta5.^2.*thetaDot3 + theta3.*theta4.*theta5.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot5, theta2.*theta3.*theta4.^2.*thetaDot5 + theta2.*theta4.^2.*theta5.*thetaDot3 + theta3.*theta4.^2.*theta5.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot4, theta2.*theta3.^2.*theta4.*thetaDot5 + theta2.*theta3.^2.*theta5.*thetaDot4 + theta3.^2.*theta4.*theta5.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot3, theta1.^2.*theta2.*theta5.*thetaDot6 + theta1.^2.*theta2.*theta6.*thetaDot5 + theta1.^2.*theta5.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot1, theta1.^2.*theta3.*theta4.*thetaDot6 + theta1.^2.*theta3.*theta6.*thetaDot4 + theta1.^2.*theta4.*theta6.*thetaDot3 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot1, theta2.^2.*theta3.*theta4.*thetaDot5 + theta2.^2.*theta3.*theta5.*thetaDot4 + theta2.^2.*theta4.*theta5.*thetaDot3 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot2, theta1.*theta3.*theta6.^2.*thetaDot5 + theta1.*theta5.*theta6.^2.*thetaDot3 + theta3.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot6, theta1.*theta3.*theta5.^2.*thetaDot6 + theta1.*theta5.^2.*theta6.*thetaDot3 + theta3.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot5, theta1.*theta3.^2.*theta5.*thetaDot6 + theta1.*theta3.^2.*theta6.*thetaDot5 + theta3.^2.*theta5.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot3, theta2.*theta3.*theta6.^2.*thetaDot4 + theta2.*theta4.*theta6.^2.*thetaDot3 + theta3.*theta4.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot6, theta2.*theta3.*theta4.^2.*thetaDot6 + theta2.*theta4.^2.*theta6.*thetaDot3 + theta3.*theta4.^2.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot4, theta2.*theta3.^2.*theta4.*thetaDot6 + theta2.*theta3.^2.*theta6.*thetaDot4 + theta3.^2.*theta4.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot3, theta1.^2.*theta3.*theta5.*thetaDot6 + theta1.^2.*theta3.*theta6.*thetaDot5 + theta1.^2.*theta5.*theta6.*thetaDot3 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot1, theta2.^2.*theta3.*theta4.*thetaDot6 + theta2.^2.*theta3.*theta6.*thetaDot4 + theta2.^2.*theta4.*theta6.*thetaDot3 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot2, theta1.*theta4.*theta6.^2.*thetaDot5 + theta1.*theta5.*theta6.^2.*thetaDot4 + theta4.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot6, theta1.*theta4.*theta5.^2.*thetaDot6 + theta1.*theta5.^2.*theta6.*thetaDot4 + theta4.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot5, theta1.*theta4.^2.*theta5.*thetaDot6 + theta1.*theta4.^2.*theta6.*thetaDot5 + theta4.^2.*theta5.*theta6.*thetaDot1 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot4, theta2.*theta3.*theta6.^2.*thetaDot5 + theta2.*theta5.*theta6.^2.*thetaDot3 + theta3.*theta5.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot6, theta2.*theta3.*theta5.^2.*thetaDot6 + theta2.*theta5.^2.*theta6.*thetaDot3 + theta3.*theta5.^2.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot5, theta2.*theta3.^2.*theta5.*thetaDot6 + theta2.*theta3.^2.*theta6.*thetaDot5 + theta3.^2.*theta5.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot3, theta1.^2.*theta4.*theta5.*thetaDot6 + theta1.^2.*theta4.*theta6.*thetaDot5 + theta1.^2.*theta5.*theta6.*thetaDot4 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot1, theta2.^2.*theta3.*theta5.*thetaDot6 + theta2.^2.*theta3.*theta6.*thetaDot5 + theta2.^2.*theta5.*theta6.*thetaDot3 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot2, theta2.*theta4.*theta6.^2.*thetaDot5 + theta2.*theta5.*theta6.^2.*thetaDot4 + theta4.*theta5.*theta6.^2.*thetaDot2 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot6, theta2.*theta4.*theta5.^2.*thetaDot6 + theta2.*theta5.^2.*theta6.*thetaDot4 + theta4.*theta5.^2.*theta6.*thetaDot2 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot5, theta2.*theta4.^2.*theta5.*thetaDot6 + theta2.*theta4.^2.*theta6.*thetaDot5 + theta4.^2.*theta5.*theta6.*thetaDot2 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot4, theta2.^2.*theta4.*theta5.*thetaDot6 + theta2.^2.*theta4.*theta6.*thetaDot5 + theta2.^2.*theta5.*theta6.*thetaDot4 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot2, theta3.*theta4.*theta6.^2.*thetaDot5 + theta3.*theta5.*theta6.^2.*thetaDot4 + theta4.*theta5.*theta6.^2.*thetaDot3 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot6, theta3.*theta4.*theta5.^2.*thetaDot6 + theta3.*theta5.^2.*theta6.*thetaDot4 + theta4.*theta5.^2.*theta6.*thetaDot3 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot5, theta3.*theta4.^2.*theta5.*thetaDot6 + theta3.*theta4.^2.*theta6.*thetaDot5 + theta4.^2.*theta5.*theta6.*thetaDot3 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot4, theta3.^2.*theta4.*theta5.*thetaDot6 + theta3.^2.*theta4.*theta6.*thetaDot5 + theta3.^2.*theta5.*theta6.*thetaDot4 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot3, theta1.*theta2.*theta3.*theta4.*thetaDot5 + theta1.*theta2.*theta3.*theta5.*thetaDot4 + theta1.*theta2.*theta4.*theta5.*thetaDot3 + theta1.*theta3.*theta4.*theta5.*thetaDot2 + theta2.*theta3.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta3.*theta4.*thetaDot6 + theta1.*theta2.*theta3.*theta6.*thetaDot4 + theta1.*theta2.*theta4.*theta6.*thetaDot3 + theta1.*theta3.*theta4.*theta6.*thetaDot2 + theta2.*theta3.*theta4.*theta6.*thetaDot1, theta1.*theta2.*theta3.*theta5.*thetaDot6 + theta1.*theta2.*theta3.*theta6.*thetaDot5 + theta1.*theta2.*theta5.*theta6.*thetaDot3 + theta1.*theta3.*theta5.*theta6.*thetaDot2 + theta2.*theta3.*theta5.*theta6.*thetaDot1, theta1.*theta2.*theta4.*theta5.*thetaDot6 + theta1.*theta2.*theta4.*theta6.*thetaDot5 + theta1.*theta2.*theta5.*theta6.*thetaDot4 + theta1.*theta4.*theta5.*theta6.*thetaDot2 + theta2.*theta4.*theta5.*theta6.*thetaDot1, theta1.*theta3.*theta4.*theta5.*thetaDot6 + theta1.*theta3.*theta4.*theta6.*thetaDot5 + theta1.*theta3.*theta5.*theta6.*thetaDot4 + theta1.*theta4.*theta5.*theta6.*thetaDot3 + theta3.*theta4.*theta5.*theta6.*thetaDot1, theta2.*theta3.*theta4.*theta5.*thetaDot6 + theta2.*theta3.*theta4.*theta6.*thetaDot5 + theta2.*theta3.*theta5.*theta6.*thetaDot4 + theta2.*theta4.*theta5.*theta6.*thetaDot3 + theta3.*theta4.*theta5.*theta6.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -2.*theta1.*theta5.^2, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.^3, -2.*theta1.*theta6.^2, -3.*theta1.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6.^3, -3.*theta1.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta5, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, -3.*theta1.^2.*theta5, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6, zeroCol, -4.*theta1.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta2.*theta5.^2, -theta3.*theta4.^2, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta2.*theta5, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta2.*theta5.^3, -theta2.*theta6.^2, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^2.*theta6, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -2.*theta1.*theta3.*theta5, -3.*theta1.^2.*theta2.*theta5, -3.*theta1.^2.*theta3.*theta4, zeroCol, -theta2.*theta6.^3, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -2.*theta1.*theta4.*theta5, -3.*theta1.^2.*theta2.*theta6, -3.*theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.^2.*theta3.*theta6, -3.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6, -3.*theta1.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta2.^2.*theta5.^2, -theta3.^2.*theta4.^2, -2.*theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta2.^2.*theta5, -2.*theta1.*theta3.^2.*theta4, -theta2.^2.*theta6.^2, -theta3.^2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta6.^2, -2.*theta1.*theta3.*theta5.^2, -2.*theta1.*theta2.^2.*theta6, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, -2.*theta1.*theta3.*theta6.^2, -2.*theta1.*theta4.*theta5.^2, -2.*theta1.*theta3.^2.*theta6, -2.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6.^2, -2.*theta1.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta2.*theta5, -theta3.*theta4, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta5, -theta2.*theta3.*theta6, -theta2.*theta4.*theta5, -theta2.*theta4.*theta6, -theta3.*theta4.*theta5, -theta2.*theta5.*theta6, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta2.*theta3.*theta6.^2, -theta2.*theta4.*theta5.^2, -theta2.*theta3.^2.*theta6, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta3.*theta6, -theta2.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta6, -theta3.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta4.*theta6, -2.*theta1.*theta3.*theta4.*theta5, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta2.^2.*theta5.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.*theta6, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.^3, -2.*theta2.*theta5.^2, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.^3, -2.*theta2.*theta6.^2, -3.*theta2.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6.^3, -3.*theta2.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, -3.*theta2.^2.*theta5, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6, zeroCol, -4.*theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta5, -3.*theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -3.*theta1.*theta2.^2.*theta5, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -2.*theta2.*theta3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -2.*theta2.*theta3.*theta5, -3.*theta2.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, -2.*theta2.*theta4.*theta5, -3.*theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.^2.*theta3.*theta6, -3.*theta2.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta2.^2.*theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, -2.*theta1.*theta2.*theta5.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -2.*theta1.*theta2.*theta6.^2, zeroCol, -theta3.^2.*theta4.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, -theta3.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.^2.*theta5, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6.^2, -2.*theta2.*theta4.*theta5.^2, -2.*theta2.*theta3.^2.*theta6, -2.*theta2.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.^2.*theta6, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6.^2, -2.*theta2.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3, -theta1.*theta4, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta3.*theta4, zeroCol, zeroCol, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta3.*theta5, -theta1.*theta3.*theta6, -theta1.*theta4.*theta5, -theta1.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5, zeroCol, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, -theta4.*theta5.*theta6, zeroCol, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta1.^2.*theta3.*theta5, -theta1.*theta3.*theta6.^2, -theta1.*theta4.*theta5.^2, -theta1.*theta3.^2.*theta6, -theta1.*theta4.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta1.^2.*theta3.*theta6, -theta1.^2.*theta4.*theta5, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, zeroCol, -theta1.^2.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, -theta1.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta5.*theta6, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta2.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta5.*theta6, -theta1.*theta4.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.*theta6, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^3, -2.*theta3.*theta5.^2, -3.*theta3.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta5.^3, -2.*theta3.*theta6.^2, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.*theta6.^3, -3.*theta3.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, -theta2, zeroCol, zeroCol, zeroCol, zeroCol, -theta4, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta3.^3, zeroCol, zeroCol, -theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, -3.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -3.*theta3.^2.*theta5, zeroCol, -4.*theta3.^3.*theta4, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta6, zeroCol, -4.*theta3.^3.*theta5, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, -4.*theta3.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta2.^2.*theta4, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -3.*theta1.*theta3.^2.*theta5, zeroCol, -theta2.*theta4.^3, -theta2.*theta5.^2, -2.*theta2.*theta3.*theta5, -3.*theta2.*theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, -3.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta6, -3.*theta2.*theta3.^2.*theta5, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2.*theta6, zeroCol, zeroCol, -theta4.*theta5.^2, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta6, zeroCol, -2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6, -3.*theta3.^2.*theta4.*theta5, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, -2.*theta3.*theta5.*theta6, -3.*theta3.^2.*theta4.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta3.*theta5, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta5.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta5.^2, -2.*theta2.^2.*theta3.*theta5, zeroCol, -2.*theta2.*theta3.*theta6.^2, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta6.^2, zeroCol, -2.*theta2.^2.*theta3.*theta6, zeroCol, zeroCol, zeroCol, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta5.^2, -2.*theta3.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.^2.*theta6, -theta5.^2.*theta6.^2, -2.*theta3.*theta5.*theta6.^2, -2.*theta3.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta4, zeroCol, -theta1.*theta5, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta4.*theta5, zeroCol, -theta4.*theta6, -theta5.*theta6, zeroCol, -theta1.*theta2.*theta4, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta4.*theta5, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta4.*theta5, -theta1.*theta5.*theta6, -theta2.*theta4.*theta6, zeroCol, -theta2.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.^2.*theta5, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -theta1.^2.*theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, -2.*theta1.*theta3.*theta4.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta4.*theta5, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta3.*theta5.*theta6, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -2.*theta2.*theta3.*theta4.*theta6, -theta1.^2.*theta5.*theta6, -theta2.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta3.*theta5.*theta6, zeroCol, -theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta1.*theta2.*theta4.*theta5, -theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta5.*theta6, zeroCol, -theta1.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta4.^2, zeroCol, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta4.^2, zeroCol, -2.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5.^2, zeroCol, zeroCol, -2.*theta4.*theta5.^3, -2.*theta4.*theta6.^2, -3.*theta4.^2.*theta5.^2, -2.*theta4.*theta6.^3, -3.*theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, zeroCol, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, zeroCol, zeroCol, -3.*theta2.*theta4.^2, zeroCol, -2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta4.^3, zeroCol, zeroCol, -3.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, zeroCol, zeroCol, zeroCol, -4.*theta3.*theta4.^3, zeroCol, zeroCol, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5, -theta3.^4, zeroCol, zeroCol, zeroCol, -theta5.^3, -theta6.^2, zeroCol, zeroCol, -2.*theta4.*theta6, zeroCol, -3.*theta4.^2.*theta5, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, -3.*theta4.^2.*theta6, zeroCol, -4.*theta4.^3.*theta5, -theta6.^4, zeroCol, -4.*theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, zeroCol, -4.*theta4.^3, zeroCol, zeroCol, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, -3.*theta1.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5, -3.*theta2.*theta3.*theta4.^2, zeroCol, zeroCol, -theta2.*theta3.^3, zeroCol, -theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta3, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta4.*theta5, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -theta2.^2.*theta5, zeroCol, -theta1.*theta6.^3, zeroCol, -3.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.*theta4.^2.*theta5, -theta3.*theta5.^2, -2.*theta3.*theta4.*theta5, zeroCol, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, -theta3.^2.*theta5, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, -3.*theta2.*theta4.^2.*theta6, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -2.*theta3.*theta4.*theta6, -3.*theta3.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, zeroCol, -3.*theta3.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.^3.*theta6, zeroCol, zeroCol, -theta5.*theta6.^2, -theta5.^2.*theta6, zeroCol, -2.*theta4.*theta5.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, -3.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, zeroCol, -2.*theta1.*theta3.^2.*theta4, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta5.^2, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta4.*theta6, zeroCol, -theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta4.*theta6, -theta3.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta5, zeroCol, -2.*theta3.*theta4.*theta6.^2, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, -2.*theta4.*theta5.*theta6.^2, -2.*theta4.*theta5.^2.*theta6, zeroCol, -theta1.*theta2, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta2.*theta3, zeroCol, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, zeroCol, -theta5.*theta6, -theta1.*theta2.*theta3, zeroCol, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, -theta1.*theta3.*theta5, zeroCol, -theta1.*theta3.*theta6, -theta2.*theta3.*theta5, zeroCol, -theta2.*theta3.*theta6, -theta1.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6, -theta3.*theta5.*theta6, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.^2.*theta5, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta2.^2.*theta6, -theta1.*theta3.^2.*theta5, -theta1.^2.*theta2.*theta6, -theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta1.*theta3.^2.*theta6, -theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.^2.*theta5, zeroCol, -theta1.^2.*theta3.*theta6, -theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.^2.*theta6, zeroCol, -theta2.^2.*theta3.*theta6, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta4.*theta5.*theta6, -theta2.^2.*theta5.*theta6, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta3.^2.*theta5.*theta6, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta5.*theta6, -theta1.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.*theta6, zeroCol,];
        momentArms5 = [ zeroCol, zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^3.*theta5, zeroCol, -2.*theta2.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^3.*theta5, zeroCol, -2.*theta3.^2.*theta5, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.^3.*theta5, -2.*theta4.^2.*theta5, zeroCol, zeroCol, -3.*theta4.^2.*theta5.^2, zeroCol, -2.*theta4.^3.*theta5, zeroCol, zeroCol, -2.*theta5.*theta6.^2, -2.*theta5.*theta6.^3, -3.*theta5.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta5.^3, zeroCol, zeroCol, -3.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta5.^3, zeroCol, zeroCol, -3.*theta3.*theta5.^2, zeroCol, -2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta5.^3, zeroCol, -3.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, zeroCol, -4.*theta4.*theta5.^3, zeroCol, -theta6.^2, zeroCol, zeroCol, -2.*theta5.*theta6, -theta4.^4, zeroCol, -theta6.^3, zeroCol, -3.*theta5.^2.*theta6, -theta6.^4, -4.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta5, zeroCol, zeroCol, -3.*theta5.^2, zeroCol, zeroCol, -4.*theta5.^3, zeroCol, -5.*theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, -3.*theta1.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta5.^2, zeroCol, -2.*theta1.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, -2.*theta2.*theta3.*theta5, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -3.*theta2.*theta3.*theta5.^2, zeroCol, -2.*theta2.*theta4.*theta5, zeroCol, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta5.*theta6, zeroCol, -3.*theta2.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta2.*theta4.^3, -2.*theta3.*theta4.*theta5, -theta3.*theta4.^2, -theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta4, -theta3.^2.*theta4, -theta1.*theta6.^3, -3.*theta1.*theta5.^2.*theta6, zeroCol, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta3.*theta4.^3, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, zeroCol, -theta3.^3.*theta4, -theta2.*theta6.^3, -3.*theta2.*theta5.^2.*theta6, zeroCol, -theta3.*theta6.^2, zeroCol, -2.*theta3.*theta5.*theta6, -theta2.^3.*theta6, -theta3.^2.*theta6, zeroCol, -theta3.*theta6.^3, -3.*theta3.*theta5.^2.*theta6, -theta4.*theta6.^2, -2.*theta4.*theta5.*theta6, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.*theta6.^3, -3.*theta4.*theta5.^2.*theta6, -theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta5, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta5, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.^2.*theta5, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta5, -theta2.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -theta2.^2.*theta4.^2, -2.*theta1.*theta5.*theta6.^2, zeroCol, -2.*theta3.*theta4.^2.*theta5, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.^2.*theta4.*theta5, -theta3.^2.*theta4.^2, -2.*theta2.*theta5.*theta6.^2, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.*theta5.*theta6.^2, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta5.*theta6, -2.*theta4.*theta5.*theta6.^2, -theta4.^2.*theta6.^2, -2.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, zeroCol, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta3.*theta4, -theta2.*theta6, zeroCol, -theta3.*theta6, -theta4.*theta6, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta2.*theta6, zeroCol, -theta2.*theta3.*theta4, -theta1.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta3.*theta6, -theta2.*theta4.*theta6, -theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta4.^2, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.^2, zeroCol, -theta1.*theta3.^2.*theta4, zeroCol, -theta1.^2.*theta3.*theta4, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta2.*theta6, zeroCol, -theta2.^2.*theta3.*theta4, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.^2.*theta6, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.^2.*theta6, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta3.*theta6, -theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.^2.*theta6, -theta2.^2.*theta4.*theta6, -theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, -theta1.*theta2.*theta3.*theta4, zeroCol, -theta1.*theta2.*theta3.*theta6, -theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.*theta6, zeroCol,];
        momentArms6 = [ zeroCol, zeroCol, zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6.^2, -2.*theta1.^3.*theta6, zeroCol, -2.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6.^2, -2.*theta2.^3.*theta6, zeroCol, -2.*theta3.^2.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta6.^2, -2.*theta3.^3.*theta6, zeroCol, -2.*theta4.^2.*theta6, zeroCol, -3.*theta4.^2.*theta6.^2, -2.*theta4.^3.*theta6, -2.*theta5.^2.*theta6, -3.*theta5.^2.*theta6.^2, -2.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, -theta3, zeroCol, -theta4, -theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta6.^3, zeroCol, -3.*theta2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta6.^3, zeroCol, -3.*theta3.*theta6.^2, zeroCol, -2.*theta4.*theta6, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta6.^3, zeroCol, -3.*theta4.*theta6.^2, -2.*theta5.*theta6, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, -4.*theta4.*theta6.^3, -3.*theta5.*theta6.^2, -theta4.^4, -theta5.^3, -4.*theta5.*theta6.^3, -theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta6, zeroCol, zeroCol, -3.*theta6.^2, zeroCol, -4.*theta6.^3, -5.*theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta3.*theta6, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, zeroCol, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, -theta1.^3.*theta3, zeroCol, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta5.*theta6, -theta1.*theta4.^3, -theta1.*theta5.^2, -3.*theta2.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, zeroCol, -3.*theta1.*theta5.*theta6.^2, -theta1.*theta5.^3, -3.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta5.*theta6, -theta2.*theta4.^3, -theta2.*theta5.^2, zeroCol, -2.*theta3.*theta4.*theta6, -theta3.*theta4.^2, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, zeroCol, -3.*theta2.*theta5.*theta6.^2, -theta2.*theta5.^3, -3.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta5.*theta6, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, -3.*theta3.*theta5.*theta6.^2, -theta3.*theta5.^3, -2.*theta4.*theta5.*theta6, -theta4.*theta5.^2, -theta3.^3.*theta5, -theta4.^2.*theta5, -3.*theta4.*theta5.*theta6.^2, -theta4.*theta5.^3, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta6, -2.*theta2.*theta3.^2.*theta6, zeroCol, -2.*theta1.^2.*theta4.*theta6, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta5.^2.*theta6, -2.*theta2.*theta4.^2.*theta6, zeroCol, -2.*theta1.^2.*theta5.*theta6, -theta1.^2.*theta5.^2, -2.*theta2.^2.*theta4.*theta6, -theta2.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta5.^2.*theta6, -2.*theta3.*theta4.^2.*theta6, -2.*theta2.^2.*theta5.*theta6, -theta2.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta6, -theta3.^2.*theta4.^2, -2.*theta3.*theta5.^2.*theta6, -2.*theta3.^2.*theta5.*theta6, -theta3.^2.*theta5.^2, -2.*theta4.*theta5.^2.*theta6, -2.*theta4.^2.*theta5.*theta6, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, -theta1.*theta5, -theta2.*theta4, zeroCol, -theta2.*theta5, -theta3.*theta4, -theta3.*theta5, -theta4.*theta5, zeroCol, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta3.*theta4, zeroCol, -theta1.*theta3.*theta5, -theta2.*theta3.*theta4, -theta1.*theta4.*theta5, -theta2.*theta3.*theta5, -theta2.*theta4.*theta5, -theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta3.^2, zeroCol, -theta1.*theta2.^2.*theta3, zeroCol, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta4.^2, zeroCol, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta4.^2, -theta1.*theta2.^2.*theta5, -theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta3.*theta5, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta1.^2.*theta4.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta5, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta4.*theta5, -theta1.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta5, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; momentArms5; momentArms6; ];
    case 14
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        theta5 = jointAngles(:, 5);
        theta6 = jointAngles(:, 6);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        thetaDot5 = jointVelocities(:, 5);
        thetaDot6 = jointVelocities(:, 6);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta5, theta6, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^2.*theta5.^2, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta1.^2.*theta5.^3, theta1.^2.*theta6.^2, theta1.^3.*theta5.^2, theta2.^2.*theta4.^3, theta2.^2.*theta5.^2, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta1.^2.*theta6.^3, theta1.^3.*theta6.^2, theta2.^2.*theta5.^3, theta2.^2.*theta6.^2, theta2.^3.*theta5.^2, theta3.^2.*theta4.^3, theta3.^2.*theta5.^2, theta3.^3.*theta4.^2, theta2.^2.*theta6.^3, theta2.^3.*theta6.^2, theta3.^2.*theta5.^3, theta3.^2.*theta6.^2, theta3.^3.*theta5.^2, theta4.^2.*theta5.^2, theta3.^2.*theta6.^3, theta3.^3.*theta6.^2, theta4.^2.*theta5.^3, theta4.^2.*theta6.^2, theta4.^3.*theta5.^2, theta4.^2.*theta6.^3, theta4.^3.*theta6.^2, theta5.^2.*theta6.^2, theta5.^2.*theta6.^3, theta5.^3.*theta6.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta1.*theta5, theta2.*theta4, theta1.*theta6, theta2.*theta5, theta3.*theta4, theta2.*theta6, theta3.*theta5, theta3.*theta6, theta4.*theta5, theta4.*theta6, theta5.*theta6, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta1.*theta5.^2, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^2.*theta5, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta1.*theta5.^3, theta1.*theta6.^2, theta2.*theta3.^4, theta2.*theta4.^3, theta2.*theta5.^2, theta3.*theta4.^2, theta1.^2.*theta6, theta1.^3.*theta5, theta2.^2.*theta5, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta1.*theta5.^4, theta1.*theta6.^3, theta2.*theta4.^4, theta2.*theta5.^3, theta2.*theta6.^2, theta3.*theta4.^3, theta3.*theta5.^2, theta1.^3.*theta6, theta2.^2.*theta6, theta1.^4.*theta5, theta2.^3.*theta5, theta3.^2.*theta5, theta2.^4.*theta4, theta3.^3.*theta4, theta1.*theta6.^4, theta2.*theta5.^4, theta2.*theta6.^3, theta3.*theta4.^4, theta3.*theta5.^3, theta3.*theta6.^2, theta4.*theta5.^2, theta1.^4.*theta6, theta2.^3.*theta6, theta3.^2.*theta6, theta2.^4.*theta5, theta3.^3.*theta5, theta4.^2.*theta5, theta3.^4.*theta4, theta2.*theta6.^4, theta3.*theta5.^4, theta3.*theta6.^3, theta4.*theta5.^3, theta4.*theta6.^2, theta2.^4.*theta6, theta3.^3.*theta6, theta4.^2.*theta6, theta3.^4.*theta5, theta4.^3.*theta5, theta3.*theta6.^4, theta4.*theta5.^4, theta4.*theta6.^3, theta5.*theta6.^2, theta3.^4.*theta6, theta4.^3.*theta6, theta5.^2.*theta6, theta4.^4.*theta5, theta4.*theta6.^4, theta5.*theta6.^3, theta4.^4.*theta6, theta5.^3.*theta6, theta5.*theta6.^4, theta5.^4.*theta6, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta5.^2, theta3.^5, theta4.^4, theta5.^3, theta6.^2, theta4.^5, theta5.^4, theta6.^3, theta5.^5, theta6.^4, theta6.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta2.*theta5.^2, theta1.*theta3.*theta4.^2, theta1.*theta2.^2.*theta5, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta2.*theta5, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta2.*theta5.^3, theta1.*theta2.*theta6.^2, theta1.*theta3.*theta4.^3, theta1.*theta3.*theta5.^2, theta1.*theta2.^2.*theta6, theta1.*theta2.^3.*theta5, theta1.*theta3.^2.*theta5, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^2.*theta2.*theta6, theta1.^2.*theta3.*theta5, theta1.^3.*theta2.*theta5, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta1.*theta2.*theta6.^3, theta1.*theta3.*theta5.^3, theta1.*theta3.*theta6.^2, theta1.*theta4.*theta5.^2, theta1.*theta2.^3.*theta6, theta1.*theta3.^2.*theta6, theta1.*theta3.^3.*theta5, theta1.*theta4.^2.*theta5, theta2.*theta3.*theta4.^3, theta2.*theta3.*theta5.^2, theta2.*theta3.^2.*theta5, theta2.*theta3.^3.*theta4, theta1.^2.*theta3.*theta6, theta1.^2.*theta4.*theta5, theta1.^3.*theta2.*theta6, theta1.^3.*theta3.*theta5, theta2.^2.*theta3.*theta5, theta2.^3.*theta3.*theta4, theta1.*theta3.*theta6.^3, theta1.*theta4.*theta5.^3, theta1.*theta4.*theta6.^2, theta1.*theta3.^3.*theta6, theta1.*theta4.^2.*theta6, theta1.*theta4.^3.*theta5, theta2.*theta3.*theta5.^3, theta2.*theta3.*theta6.^2, theta2.*theta4.*theta5.^2, theta2.*theta3.^2.*theta6, theta2.*theta3.^3.*theta5, theta2.*theta4.^2.*theta5, theta1.^2.*theta4.*theta6, theta1.^3.*theta3.*theta6, theta1.^3.*theta4.*theta5, theta2.^2.*theta3.*theta6, theta2.^2.*theta4.*theta5, theta2.^3.*theta3.*theta5, theta1.*theta4.*theta6.^3, theta1.*theta5.*theta6.^2, theta1.*theta4.^3.*theta6, theta1.*theta5.^2.*theta6, theta2.*theta3.*theta6.^3, theta2.*theta4.*theta5.^3, theta2.*theta4.*theta6.^2, theta2.*theta3.^3.*theta6, theta2.*theta4.^2.*theta6, theta2.*theta4.^3.*theta5, theta3.*theta4.*theta5.^2, theta3.*theta4.^2.*theta5, theta1.^2.*theta5.*theta6, theta1.^3.*theta4.*theta6, theta2.^2.*theta4.*theta6, theta2.^3.*theta3.*theta6, theta2.^3.*theta4.*theta5, theta3.^2.*theta4.*theta5, theta1.*theta5.*theta6.^3, theta1.*theta5.^3.*theta6, theta2.*theta4.*theta6.^3, theta2.*theta5.*theta6.^2, theta2.*theta4.^3.*theta6, theta2.*theta5.^2.*theta6, theta3.*theta4.*theta5.^3, theta3.*theta4.*theta6.^2, theta3.*theta4.^2.*theta6, theta3.*theta4.^3.*theta5, theta1.^3.*theta5.*theta6, theta2.^2.*theta5.*theta6, theta2.^3.*theta4.*theta6, theta3.^2.*theta4.*theta6, theta3.^3.*theta4.*theta5, theta2.*theta5.*theta6.^3, theta2.*theta5.^3.*theta6, theta3.*theta4.*theta6.^3, theta3.*theta5.*theta6.^2, theta3.*theta4.^3.*theta6, theta3.*theta5.^2.*theta6, theta2.^3.*theta5.*theta6, theta3.^2.*theta5.*theta6, theta3.^3.*theta4.*theta6, theta3.*theta5.*theta6.^3, theta3.*theta5.^3.*theta6, theta4.*theta5.*theta6.^2, theta4.*theta5.^2.*theta6, theta3.^3.*theta5.*theta6, theta4.^2.*theta5.*theta6, theta4.*theta5.*theta6.^3, theta4.*theta5.^3.*theta6, theta4.^3.*theta5.*theta6, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta2.^2.*theta5.^2, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta5.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta2.^2.*theta5, theta1.^2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta6.^2, theta1.*theta3.^2.*theta5.^2, theta2.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta6.^2, theta1.^2.*theta3.*theta5.^2, theta1.^2.*theta2.^2.*theta6, theta1.^2.*theta3.^2.*theta5, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta3.^2.*theta6.^2, theta1.*theta4.^2.*theta5.^2, theta2.*theta3.^2.*theta5.^2, theta1.^2.*theta3.*theta6.^2, theta1.^2.*theta4.*theta5.^2, theta1.^2.*theta3.^2.*theta6, theta1.^2.*theta4.^2.*theta5, theta2.^2.*theta3.*theta5.^2, theta2.^2.*theta3.^2.*theta5, theta1.*theta4.^2.*theta6.^2, theta2.*theta3.^2.*theta6.^2, theta2.*theta4.^2.*theta5.^2, theta1.^2.*theta4.*theta6.^2, theta1.^2.*theta4.^2.*theta6, theta2.^2.*theta3.*theta6.^2, theta2.^2.*theta4.*theta5.^2, theta2.^2.*theta3.^2.*theta6, theta2.^2.*theta4.^2.*theta5, theta1.*theta5.^2.*theta6.^2, theta2.*theta4.^2.*theta6.^2, theta3.*theta4.^2.*theta5.^2, theta1.^2.*theta5.*theta6.^2, theta1.^2.*theta5.^2.*theta6, theta2.^2.*theta4.*theta6.^2, theta2.^2.*theta4.^2.*theta6, theta3.^2.*theta4.*theta5.^2, theta3.^2.*theta4.^2.*theta5, theta2.*theta5.^2.*theta6.^2, theta3.*theta4.^2.*theta6.^2, theta2.^2.*theta5.*theta6.^2, theta2.^2.*theta5.^2.*theta6, theta3.^2.*theta4.*theta6.^2, theta3.^2.*theta4.^2.*theta6, theta3.*theta5.^2.*theta6.^2, theta3.^2.*theta5.*theta6.^2, theta3.^2.*theta5.^2.*theta6, theta4.*theta5.^2.*theta6.^2, theta4.^2.*theta5.*theta6.^2, theta4.^2.*theta5.^2.*theta6, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta2.*theta5, theta1.*theta3.*theta4, theta1.*theta2.*theta6, theta1.*theta3.*theta5, theta2.*theta3.*theta4, theta1.*theta3.*theta6, theta1.*theta4.*theta5, theta2.*theta3.*theta5, theta1.*theta4.*theta6, theta2.*theta3.*theta6, theta2.*theta4.*theta5, theta1.*theta5.*theta6, theta2.*theta4.*theta6, theta3.*theta4.*theta5, theta2.*theta5.*theta6, theta3.*theta4.*theta6, theta3.*theta5.*theta6, theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6, theta1.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6, theta1.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6, theta1.*theta3.*theta4.*theta6, theta2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6, theta2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6, theta2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5.^2, theta1.*theta2.*theta3.^2.*theta5, theta1.*theta2.^2.*theta3.*theta5, theta1.^2.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6.^2, theta1.*theta2.*theta4.*theta5.^2, theta1.*theta2.*theta3.^2.*theta6, theta1.*theta2.*theta4.^2.*theta5, theta1.*theta2.^2.*theta3.*theta6, theta1.*theta2.^2.*theta4.*theta5, theta1.^2.*theta2.*theta3.*theta6, theta1.^2.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6.^2, theta1.*theta2.*theta4.^2.*theta6, theta1.*theta3.*theta4.*theta5.^2, theta1.*theta3.*theta4.^2.*theta5, theta1.*theta2.^2.*theta4.*theta6, theta1.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta4.*theta6, theta1.^2.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6.^2, theta1.*theta2.*theta5.^2.*theta6, theta1.*theta3.*theta4.*theta6.^2, theta1.*theta3.*theta4.^2.*theta6, theta1.*theta2.^2.*theta5.*theta6, theta1.*theta3.^2.*theta4.*theta6, theta2.*theta3.*theta4.*theta5.^2, theta2.*theta3.*theta4.^2.*theta5, theta2.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta5.*theta6, theta1.^2.*theta3.*theta4.*theta6, theta2.^2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6.^2, theta1.*theta3.*theta5.^2.*theta6, theta1.*theta3.^2.*theta5.*theta6, theta2.*theta3.*theta4.*theta6.^2, theta2.*theta3.*theta4.^2.*theta6, theta2.*theta3.^2.*theta4.*theta6, theta1.^2.*theta3.*theta5.*theta6, theta2.^2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6.^2, theta1.*theta4.*theta5.^2.*theta6, theta1.*theta4.^2.*theta5.*theta6, theta2.*theta3.*theta5.*theta6.^2, theta2.*theta3.*theta5.^2.*theta6, theta2.*theta3.^2.*theta5.*theta6, theta1.^2.*theta4.*theta5.*theta6, theta2.^2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6.^2, theta2.*theta4.*theta5.^2.*theta6, theta2.*theta4.^2.*theta5.*theta6, theta2.^2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6.^2, theta3.*theta4.*theta5.^2.*theta6, theta3.*theta4.^2.*theta5.*theta6, theta3.^2.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.*theta5, theta1.*theta2.*theta3.*theta4.*theta6, theta1.*theta2.*theta3.*theta5.*theta6, theta1.*theta2.*theta4.*theta5.*theta6, theta1.*theta3.*theta4.*theta5.*theta6, theta2.*theta3.*theta4.*theta5.*theta6, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, thetaDot5, thetaDot6, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta5.*thetaDot5, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta1.*theta5.^3.*thetaDot1 + 3.*theta1.^2.*theta5.^2.*thetaDot5, 2.*theta1.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta6.*thetaDot6, 2.*theta1.^3.*theta5.*thetaDot5 + 3.*theta1.^2.*theta5.^2.*thetaDot1, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.*theta5.^2.*thetaDot2 + 2.*theta2.^2.*theta5.*thetaDot5, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta1.*theta6.^3.*thetaDot1 + 3.*theta1.^2.*theta6.^2.*thetaDot6, 2.*theta1.^3.*theta6.*thetaDot6 + 3.*theta1.^2.*theta6.^2.*thetaDot1, 2.*theta2.*theta5.^3.*thetaDot2 + 3.*theta2.^2.*theta5.^2.*thetaDot5, 2.*theta2.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta6.*thetaDot6, 2.*theta2.^3.*theta5.*thetaDot5 + 3.*theta2.^2.*theta5.^2.*thetaDot2, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.*theta5.^2.*thetaDot3 + 2.*theta3.^2.*theta5.*thetaDot5, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, 2.*theta2.*theta6.^3.*thetaDot2 + 3.*theta2.^2.*theta6.^2.*thetaDot6, 2.*theta2.^3.*theta6.*thetaDot6 + 3.*theta2.^2.*theta6.^2.*thetaDot2, 2.*theta3.*theta5.^3.*thetaDot3 + 3.*theta3.^2.*theta5.^2.*thetaDot5, 2.*theta3.*theta6.^2.*thetaDot3 + 2.*theta3.^2.*theta6.*thetaDot6, 2.*theta3.^3.*theta5.*thetaDot5 + 3.*theta3.^2.*theta5.^2.*thetaDot3, 2.*theta4.*theta5.^2.*thetaDot4 + 2.*theta4.^2.*theta5.*thetaDot5, 2.*theta3.*theta6.^3.*thetaDot3 + 3.*theta3.^2.*theta6.^2.*thetaDot6, 2.*theta3.^3.*theta6.*thetaDot6 + 3.*theta3.^2.*theta6.^2.*thetaDot3, 2.*theta4.*theta5.^3.*thetaDot4 + 3.*theta4.^2.*theta5.^2.*thetaDot5, 2.*theta4.*theta6.^2.*thetaDot4 + 2.*theta4.^2.*theta6.*thetaDot6, 2.*theta4.^3.*theta5.*thetaDot5 + 3.*theta4.^2.*theta5.^2.*thetaDot4, 2.*theta4.*theta6.^3.*thetaDot4 + 3.*theta4.^2.*theta6.^2.*thetaDot6, 2.*theta4.^3.*theta6.*thetaDot6 + 3.*theta4.^2.*theta6.^2.*thetaDot4, 2.*theta5.*theta6.^2.*thetaDot5 + 2.*theta5.^2.*theta6.*thetaDot6, 2.*theta5.*theta6.^3.*thetaDot5 + 3.*theta5.^2.*theta6.^2.*thetaDot6, 2.*theta5.^3.*theta6.*thetaDot6 + 3.*theta5.^2.*theta6.^2.*thetaDot5, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta1.*thetaDot5 + theta5.*thetaDot1, theta2.*thetaDot4 + theta4.*thetaDot2, theta1.*thetaDot6 + theta6.*thetaDot1, theta2.*thetaDot5 + theta5.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.*thetaDot6 + theta6.*thetaDot2, theta3.*thetaDot5 + theta5.*thetaDot3, theta3.*thetaDot6 + theta6.*thetaDot3, theta4.*thetaDot5 + theta5.*thetaDot4, theta4.*thetaDot6 + theta6.*thetaDot4, theta5.*thetaDot6 + theta6.*thetaDot5, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta5.^2.*thetaDot1 + 2.*theta1.*theta5.*thetaDot5, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^2.*thetaDot5 + 2.*theta1.*theta5.*thetaDot1, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta5.^3.*thetaDot1 + 3.*theta1.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot1 + 2.*theta1.*theta6.*thetaDot6, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta5.^2.*thetaDot2 + 2.*theta2.*theta5.*thetaDot5, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^2.*thetaDot6 + 2.*theta1.*theta6.*thetaDot1, theta1.^3.*thetaDot5 + 3.*theta1.^2.*theta5.*thetaDot1, theta2.^2.*thetaDot5 + 2.*theta2.*theta5.*thetaDot2, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta5.^4.*thetaDot1 + 4.*theta1.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot1 + 3.*theta1.*theta6.^2.*thetaDot6, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta5.^3.*thetaDot2 + 3.*theta2.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot2 + 2.*theta2.*theta6.*thetaDot6, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta5.^2.*thetaDot3 + 2.*theta3.*theta5.*thetaDot5, theta1.^3.*thetaDot6 + 3.*theta1.^2.*theta6.*thetaDot1, theta2.^2.*thetaDot6 + 2.*theta2.*theta6.*thetaDot2, theta1.^4.*thetaDot5 + 4.*theta1.^3.*theta5.*thetaDot1, theta2.^3.*thetaDot5 + 3.*theta2.^2.*theta5.*thetaDot2, theta3.^2.*thetaDot5 + 2.*theta3.*theta5.*thetaDot3, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta6.^4.*thetaDot1 + 4.*theta1.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot2 + 4.*theta2.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot2 + 3.*theta2.*theta6.^2.*thetaDot6, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta5.^3.*thetaDot3 + 3.*theta3.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot3 + 2.*theta3.*theta6.*thetaDot6, theta5.^2.*thetaDot4 + 2.*theta4.*theta5.*thetaDot5, theta1.^4.*thetaDot6 + 4.*theta1.^3.*theta6.*thetaDot1, theta2.^3.*thetaDot6 + 3.*theta2.^2.*theta6.*thetaDot2, theta3.^2.*thetaDot6 + 2.*theta3.*theta6.*thetaDot3, theta2.^4.*thetaDot5 + 4.*theta2.^3.*theta5.*thetaDot2, theta3.^3.*thetaDot5 + 3.*theta3.^2.*theta5.*thetaDot3, theta4.^2.*thetaDot5 + 2.*theta4.*theta5.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, theta6.^4.*thetaDot2 + 4.*theta2.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot3 + 4.*theta3.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot3 + 3.*theta3.*theta6.^2.*thetaDot6, theta5.^3.*thetaDot4 + 3.*theta4.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot4 + 2.*theta4.*theta6.*thetaDot6, theta2.^4.*thetaDot6 + 4.*theta2.^3.*theta6.*thetaDot2, theta3.^3.*thetaDot6 + 3.*theta3.^2.*theta6.*thetaDot3, theta4.^2.*thetaDot6 + 2.*theta4.*theta6.*thetaDot4, theta3.^4.*thetaDot5 + 4.*theta3.^3.*theta5.*thetaDot3, theta4.^3.*thetaDot5 + 3.*theta4.^2.*theta5.*thetaDot4, theta6.^4.*thetaDot3 + 4.*theta3.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot4 + 4.*theta4.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot4 + 3.*theta4.*theta6.^2.*thetaDot6, theta6.^2.*thetaDot5 + 2.*theta5.*theta6.*thetaDot6, theta3.^4.*thetaDot6 + 4.*theta3.^3.*theta6.*thetaDot3, theta4.^3.*thetaDot6 + 3.*theta4.^2.*theta6.*thetaDot4, theta5.^2.*thetaDot6 + 2.*theta5.*theta6.*thetaDot5, theta4.^4.*thetaDot5 + 4.*theta4.^3.*theta5.*thetaDot4, theta6.^4.*thetaDot4 + 4.*theta4.*theta6.^3.*thetaDot6, theta6.^3.*thetaDot5 + 3.*theta5.*theta6.^2.*thetaDot6, theta4.^4.*thetaDot6 + 4.*theta4.^3.*theta6.*thetaDot4, theta5.^3.*thetaDot6 + 3.*theta5.^2.*theta6.*thetaDot5, theta6.^4.*thetaDot5 + 4.*theta5.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot6 + 4.*theta5.^3.*theta6.*thetaDot5, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 2.*theta5.*thetaDot5, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 3.*theta5.^2.*thetaDot5, 2.*theta6.*thetaDot6, 5.*theta4.^4.*thetaDot4, 4.*theta5.^3.*thetaDot5, 3.*theta6.^2.*thetaDot6, 5.*theta5.^4.*thetaDot5, 4.*theta6.^3.*thetaDot6, 5.*theta6.^4.*thetaDot6, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta5.^2.*thetaDot2 + theta2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta5.*thetaDot5, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot5 + theta2.^2.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta5.*thetaDot2, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta2.*thetaDot5 + theta1.^2.*theta5.*thetaDot2 + 2.*theta1.*theta2.*theta5.*thetaDot1, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta5.^3.*thetaDot2 + theta2.*theta5.^3.*thetaDot1 + 3.*theta1.*theta2.*theta5.^2.*thetaDot5, theta1.*theta6.^2.*thetaDot2 + theta2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta6.*thetaDot6, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta5.^2.*thetaDot3 + theta3.*theta5.^2.*thetaDot1 + 2.*theta1.*theta3.*theta5.*thetaDot5, theta1.*theta2.^2.*thetaDot6 + theta2.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta6.*thetaDot2, theta1.*theta2.^3.*thetaDot5 + theta2.^3.*theta5.*thetaDot1 + 3.*theta1.*theta2.^2.*theta5.*thetaDot2, theta1.*theta3.^2.*thetaDot5 + theta3.^2.*theta5.*thetaDot1 + 2.*theta1.*theta3.*theta5.*thetaDot3, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^2.*theta2.*thetaDot6 + theta1.^2.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta6.*thetaDot1, theta1.^2.*theta3.*thetaDot5 + theta1.^2.*theta5.*thetaDot3 + 2.*theta1.*theta3.*theta5.*thetaDot1, theta1.^3.*theta2.*thetaDot5 + theta1.^3.*theta5.*thetaDot2 + 3.*theta1.^2.*theta2.*theta5.*thetaDot1, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta1.*theta6.^3.*thetaDot2 + theta2.*theta6.^3.*thetaDot1 + 3.*theta1.*theta2.*theta6.^2.*thetaDot6, theta1.*theta5.^3.*thetaDot3 + theta3.*theta5.^3.*thetaDot1 + 3.*theta1.*theta3.*theta5.^2.*thetaDot5, theta1.*theta6.^2.*thetaDot3 + theta3.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta6.*thetaDot6, theta1.*theta5.^2.*thetaDot4 + theta4.*theta5.^2.*thetaDot1 + 2.*theta1.*theta4.*theta5.*thetaDot5, theta1.*theta2.^3.*thetaDot6 + theta2.^3.*theta6.*thetaDot1 + 3.*theta1.*theta2.^2.*theta6.*thetaDot2, theta1.*theta3.^2.*thetaDot6 + theta3.^2.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta6.*thetaDot3, theta1.*theta3.^3.*thetaDot5 + theta3.^3.*theta5.*thetaDot1 + 3.*theta1.*theta3.^2.*theta5.*thetaDot3, theta1.*theta4.^2.*thetaDot5 + theta4.^2.*theta5.*thetaDot1 + 2.*theta1.*theta4.*theta5.*thetaDot4, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta5.^2.*thetaDot3 + theta3.*theta5.^2.*thetaDot2 + 2.*theta2.*theta3.*theta5.*thetaDot5, theta2.*theta3.^2.*thetaDot5 + theta3.^2.*theta5.*thetaDot2 + 2.*theta2.*theta3.*theta5.*thetaDot3, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot6 + theta1.^2.*theta6.*thetaDot3 + 2.*theta1.*theta3.*theta6.*thetaDot1, theta1.^2.*theta4.*thetaDot5 + theta1.^2.*theta5.*thetaDot4 + 2.*theta1.*theta4.*theta5.*thetaDot1, theta1.^3.*theta2.*thetaDot6 + theta1.^3.*theta6.*thetaDot2 + 3.*theta1.^2.*theta2.*theta6.*thetaDot1, theta1.^3.*theta3.*thetaDot5 + theta1.^3.*theta5.*thetaDot3 + 3.*theta1.^2.*theta3.*theta5.*thetaDot1, theta2.^2.*theta3.*thetaDot5 + theta2.^2.*theta5.*thetaDot3 + 2.*theta2.*theta3.*theta5.*thetaDot2, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta1.*theta6.^3.*thetaDot3 + theta3.*theta6.^3.*thetaDot1 + 3.*theta1.*theta3.*theta6.^2.*thetaDot6, theta1.*theta5.^3.*thetaDot4 + theta4.*theta5.^3.*thetaDot1 + 3.*theta1.*theta4.*theta5.^2.*thetaDot5, theta1.*theta6.^2.*thetaDot4 + theta4.*theta6.^2.*thetaDot1 + 2.*theta1.*theta4.*theta6.*thetaDot6, theta1.*theta3.^3.*thetaDot6 + theta3.^3.*theta6.*thetaDot1 + 3.*theta1.*theta3.^2.*theta6.*thetaDot3, theta1.*theta4.^2.*thetaDot6 + theta4.^2.*theta6.*thetaDot1 + 2.*theta1.*theta4.*theta6.*thetaDot4, theta1.*theta4.^3.*thetaDot5 + theta4.^3.*theta5.*thetaDot1 + 3.*theta1.*theta4.^2.*theta5.*thetaDot4, theta2.*theta5.^3.*thetaDot3 + theta3.*theta5.^3.*thetaDot2 + 3.*theta2.*theta3.*theta5.^2.*thetaDot5, theta2.*theta6.^2.*thetaDot3 + theta3.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta6.*thetaDot6, theta2.*theta5.^2.*thetaDot4 + theta4.*theta5.^2.*thetaDot2 + 2.*theta2.*theta4.*theta5.*thetaDot5, theta2.*theta3.^2.*thetaDot6 + theta3.^2.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta6.*thetaDot3, theta2.*theta3.^3.*thetaDot5 + theta3.^3.*theta5.*thetaDot2 + 3.*theta2.*theta3.^2.*theta5.*thetaDot3, theta2.*theta4.^2.*thetaDot5 + theta4.^2.*theta5.*thetaDot2 + 2.*theta2.*theta4.*theta5.*thetaDot4, theta1.^2.*theta4.*thetaDot6 + theta1.^2.*theta6.*thetaDot4 + 2.*theta1.*theta4.*theta6.*thetaDot1, theta1.^3.*theta3.*thetaDot6 + theta1.^3.*theta6.*thetaDot3 + 3.*theta1.^2.*theta3.*theta6.*thetaDot1, theta1.^3.*theta4.*thetaDot5 + theta1.^3.*theta5.*thetaDot4 + 3.*theta1.^2.*theta4.*theta5.*thetaDot1, theta2.^2.*theta3.*thetaDot6 + theta2.^2.*theta6.*thetaDot3 + 2.*theta2.*theta3.*theta6.*thetaDot2, theta2.^2.*theta4.*thetaDot5 + theta2.^2.*theta5.*thetaDot4 + 2.*theta2.*theta4.*theta5.*thetaDot2, theta2.^3.*theta3.*thetaDot5 + theta2.^3.*theta5.*thetaDot3 + 3.*theta2.^2.*theta3.*theta5.*thetaDot2, theta1.*theta6.^3.*thetaDot4 + theta4.*theta6.^3.*thetaDot1 + 3.*theta1.*theta4.*theta6.^2.*thetaDot6, theta1.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta5.*theta6.*thetaDot6, theta1.*theta4.^3.*thetaDot6 + theta4.^3.*theta6.*thetaDot1 + 3.*theta1.*theta4.^2.*theta6.*thetaDot4, theta1.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta5.*theta6.*thetaDot5, theta2.*theta6.^3.*thetaDot3 + theta3.*theta6.^3.*thetaDot2 + 3.*theta2.*theta3.*theta6.^2.*thetaDot6, theta2.*theta5.^3.*thetaDot4 + theta4.*theta5.^3.*thetaDot2 + 3.*theta2.*theta4.*theta5.^2.*thetaDot5, theta2.*theta6.^2.*thetaDot4 + theta4.*theta6.^2.*thetaDot2 + 2.*theta2.*theta4.*theta6.*thetaDot6, theta2.*theta3.^3.*thetaDot6 + theta3.^3.*theta6.*thetaDot2 + 3.*theta2.*theta3.^2.*theta6.*thetaDot3, theta2.*theta4.^2.*thetaDot6 + theta4.^2.*theta6.*thetaDot2 + 2.*theta2.*theta4.*theta6.*thetaDot4, theta2.*theta4.^3.*thetaDot5 + theta4.^3.*theta5.*thetaDot2 + 3.*theta2.*theta4.^2.*theta5.*thetaDot4, theta3.*theta5.^2.*thetaDot4 + theta4.*theta5.^2.*thetaDot3 + 2.*theta3.*theta4.*theta5.*thetaDot5, theta3.*theta4.^2.*thetaDot5 + theta4.^2.*theta5.*thetaDot3 + 2.*theta3.*theta4.*theta5.*thetaDot4, theta1.^2.*theta5.*thetaDot6 + theta1.^2.*theta6.*thetaDot5 + 2.*theta1.*theta5.*theta6.*thetaDot1, theta1.^3.*theta4.*thetaDot6 + theta1.^3.*theta6.*thetaDot4 + 3.*theta1.^2.*theta4.*theta6.*thetaDot1, theta2.^2.*theta4.*thetaDot6 + theta2.^2.*theta6.*thetaDot4 + 2.*theta2.*theta4.*theta6.*thetaDot2, theta2.^3.*theta3.*thetaDot6 + theta2.^3.*theta6.*thetaDot3 + 3.*theta2.^2.*theta3.*theta6.*thetaDot2, theta2.^3.*theta4.*thetaDot5 + theta2.^3.*theta5.*thetaDot4 + 3.*theta2.^2.*theta4.*theta5.*thetaDot2, theta3.^2.*theta4.*thetaDot5 + theta3.^2.*theta5.*thetaDot4 + 2.*theta3.*theta4.*theta5.*thetaDot3, theta1.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot1 + 3.*theta1.*theta5.*theta6.^2.*thetaDot6, theta1.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot1 + 3.*theta1.*theta5.^2.*theta6.*thetaDot5, theta2.*theta6.^3.*thetaDot4 + theta4.*theta6.^3.*thetaDot2 + 3.*theta2.*theta4.*theta6.^2.*thetaDot6, theta2.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot2 + 2.*theta2.*theta5.*theta6.*thetaDot6, theta2.*theta4.^3.*thetaDot6 + theta4.^3.*theta6.*thetaDot2 + 3.*theta2.*theta4.^2.*theta6.*thetaDot4, theta2.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot2 + 2.*theta2.*theta5.*theta6.*thetaDot5, theta3.*theta5.^3.*thetaDot4 + theta4.*theta5.^3.*thetaDot3 + 3.*theta3.*theta4.*theta5.^2.*thetaDot5, theta3.*theta6.^2.*thetaDot4 + theta4.*theta6.^2.*thetaDot3 + 2.*theta3.*theta4.*theta6.*thetaDot6, theta3.*theta4.^2.*thetaDot6 + theta4.^2.*theta6.*thetaDot3 + 2.*theta3.*theta4.*theta6.*thetaDot4, theta3.*theta4.^3.*thetaDot5 + theta4.^3.*theta5.*thetaDot3 + 3.*theta3.*theta4.^2.*theta5.*thetaDot4, theta1.^3.*theta5.*thetaDot6 + theta1.^3.*theta6.*thetaDot5 + 3.*theta1.^2.*theta5.*theta6.*thetaDot1, theta2.^2.*theta5.*thetaDot6 + theta2.^2.*theta6.*thetaDot5 + 2.*theta2.*theta5.*theta6.*thetaDot2, theta2.^3.*theta4.*thetaDot6 + theta2.^3.*theta6.*thetaDot4 + 3.*theta2.^2.*theta4.*theta6.*thetaDot2, theta3.^2.*theta4.*thetaDot6 + theta3.^2.*theta6.*thetaDot4 + 2.*theta3.*theta4.*theta6.*thetaDot3, theta3.^3.*theta4.*thetaDot5 + theta3.^3.*theta5.*thetaDot4 + 3.*theta3.^2.*theta4.*theta5.*thetaDot3, theta2.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot2 + 3.*theta2.*theta5.*theta6.^2.*thetaDot6, theta2.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot2 + 3.*theta2.*theta5.^2.*theta6.*thetaDot5, theta3.*theta6.^3.*thetaDot4 + theta4.*theta6.^3.*thetaDot3 + 3.*theta3.*theta4.*theta6.^2.*thetaDot6, theta3.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot3 + 2.*theta3.*theta5.*theta6.*thetaDot6, theta3.*theta4.^3.*thetaDot6 + theta4.^3.*theta6.*thetaDot3 + 3.*theta3.*theta4.^2.*theta6.*thetaDot4, theta3.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot3 + 2.*theta3.*theta5.*theta6.*thetaDot5, theta2.^3.*theta5.*thetaDot6 + theta2.^3.*theta6.*thetaDot5 + 3.*theta2.^2.*theta5.*theta6.*thetaDot2, theta3.^2.*theta5.*thetaDot6 + theta3.^2.*theta6.*thetaDot5 + 2.*theta3.*theta5.*theta6.*thetaDot3, theta3.^3.*theta4.*thetaDot6 + theta3.^3.*theta6.*thetaDot4 + 3.*theta3.^2.*theta4.*theta6.*thetaDot3, theta3.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot3 + 3.*theta3.*theta5.*theta6.^2.*thetaDot6, theta3.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot3 + 3.*theta3.*theta5.^2.*theta6.*thetaDot5, theta4.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot4 + 2.*theta4.*theta5.*theta6.*thetaDot6, theta4.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot4 + 2.*theta4.*theta5.*theta6.*thetaDot5, theta3.^3.*theta5.*thetaDot6 + theta3.^3.*theta6.*thetaDot5 + 3.*theta3.^2.*theta5.*theta6.*thetaDot3, theta4.^2.*theta5.*thetaDot6 + theta4.^2.*theta6.*thetaDot5 + 2.*theta4.*theta5.*theta6.*thetaDot4, theta4.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot4 + 3.*theta4.*theta5.*theta6.^2.*thetaDot6, theta4.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot4 + 3.*theta4.*theta5.^2.*theta6.*thetaDot5, theta4.^3.*theta5.*thetaDot6 + theta4.^3.*theta6.*thetaDot5 + 3.*theta4.^2.*theta5.*theta6.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta2.^2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta5.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta5.*thetaDot5, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta5.^2.*thetaDot2 + 2.*theta1.*theta2.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta5.*thetaDot5, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot5 + 2.*theta1.*theta2.^2.*theta5.*thetaDot1 + 2.*theta1.^2.*theta2.*theta5.*thetaDot2, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta2.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta6.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta6.*thetaDot6, theta3.^2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta3.*theta5.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta5.*thetaDot5, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta6.^2.*thetaDot2 + 2.*theta1.*theta2.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta6.*thetaDot6, theta1.^2.*theta5.^2.*thetaDot3 + 2.*theta1.*theta3.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta5.*thetaDot5, theta1.^2.*theta2.^2.*thetaDot6 + 2.*theta1.*theta2.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta2.*theta6.*thetaDot2, theta1.^2.*theta3.^2.*thetaDot5 + 2.*theta1.*theta3.^2.*theta5.*thetaDot1 + 2.*theta1.^2.*theta3.*theta5.*thetaDot3, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta6.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta4.*theta5.^2.*thetaDot4 + 2.*theta1.*theta4.^2.*theta5.*thetaDot5, theta3.^2.*theta5.^2.*thetaDot2 + 2.*theta2.*theta3.*theta5.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta5.*thetaDot5, theta1.^2.*theta6.^2.*thetaDot3 + 2.*theta1.*theta3.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta6.*thetaDot6, theta1.^2.*theta5.^2.*thetaDot4 + 2.*theta1.*theta4.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*theta5.*thetaDot5, theta1.^2.*theta3.^2.*thetaDot6 + 2.*theta1.*theta3.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta3.*theta6.*thetaDot3, theta1.^2.*theta4.^2.*thetaDot5 + 2.*theta1.*theta4.^2.*theta5.*thetaDot1 + 2.*theta1.^2.*theta4.*theta5.*thetaDot4, theta2.^2.*theta5.^2.*thetaDot3 + 2.*theta2.*theta3.*theta5.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta5.*thetaDot5, theta2.^2.*theta3.^2.*thetaDot5 + 2.*theta2.*theta3.^2.*theta5.*thetaDot2 + 2.*theta2.^2.*theta3.*theta5.*thetaDot3, theta4.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta4.*theta6.^2.*thetaDot4 + 2.*theta1.*theta4.^2.*theta6.*thetaDot6, theta3.^2.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta6.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot2 + 2.*theta2.*theta4.*theta5.^2.*thetaDot4 + 2.*theta2.*theta4.^2.*theta5.*thetaDot5, theta1.^2.*theta6.^2.*thetaDot4 + 2.*theta1.*theta4.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*theta6.*thetaDot6, theta1.^2.*theta4.^2.*thetaDot6 + 2.*theta1.*theta4.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta4.*theta6.*thetaDot4, theta2.^2.*theta6.^2.*thetaDot3 + 2.*theta2.*theta3.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta6.*thetaDot6, theta2.^2.*theta5.^2.*thetaDot4 + 2.*theta2.*theta4.*theta5.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*theta5.*thetaDot5, theta2.^2.*theta3.^2.*thetaDot6 + 2.*theta2.*theta3.^2.*theta6.*thetaDot2 + 2.*theta2.^2.*theta3.*theta6.*thetaDot3, theta2.^2.*theta4.^2.*thetaDot5 + 2.*theta2.*theta4.^2.*theta5.*thetaDot2 + 2.*theta2.^2.*theta4.*theta5.*thetaDot4, theta5.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta5.*theta6.^2.*thetaDot5 + 2.*theta1.*theta5.^2.*theta6.*thetaDot6, theta4.^2.*theta6.^2.*thetaDot2 + 2.*theta2.*theta4.*theta6.^2.*thetaDot4 + 2.*theta2.*theta4.^2.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot3 + 2.*theta3.*theta4.*theta5.^2.*thetaDot4 + 2.*theta3.*theta4.^2.*theta5.*thetaDot5, theta1.^2.*theta6.^2.*thetaDot5 + 2.*theta1.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta5.*theta6.*thetaDot6, theta1.^2.*theta5.^2.*thetaDot6 + 2.*theta1.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta5.*theta6.*thetaDot5, theta2.^2.*theta6.^2.*thetaDot4 + 2.*theta2.*theta4.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*theta6.*thetaDot6, theta2.^2.*theta4.^2.*thetaDot6 + 2.*theta2.*theta4.^2.*theta6.*thetaDot2 + 2.*theta2.^2.*theta4.*theta6.*thetaDot4, theta3.^2.*theta5.^2.*thetaDot4 + 2.*theta3.*theta4.*theta5.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*theta5.*thetaDot5, theta3.^2.*theta4.^2.*thetaDot5 + 2.*theta3.*theta4.^2.*theta5.*thetaDot3 + 2.*theta3.^2.*theta4.*theta5.*thetaDot4, theta5.^2.*theta6.^2.*thetaDot2 + 2.*theta2.*theta5.*theta6.^2.*thetaDot5 + 2.*theta2.*theta5.^2.*theta6.*thetaDot6, theta4.^2.*theta6.^2.*thetaDot3 + 2.*theta3.*theta4.*theta6.^2.*thetaDot4 + 2.*theta3.*theta4.^2.*theta6.*thetaDot6, theta2.^2.*theta6.^2.*thetaDot5 + 2.*theta2.*theta5.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta5.*theta6.*thetaDot6, theta2.^2.*theta5.^2.*thetaDot6 + 2.*theta2.*theta5.^2.*theta6.*thetaDot2 + 2.*theta2.^2.*theta5.*theta6.*thetaDot5, theta3.^2.*theta6.^2.*thetaDot4 + 2.*theta3.*theta4.*theta6.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*theta6.*thetaDot6, theta3.^2.*theta4.^2.*thetaDot6 + 2.*theta3.*theta4.^2.*theta6.*thetaDot3 + 2.*theta3.^2.*theta4.*theta6.*thetaDot4, theta5.^2.*theta6.^2.*thetaDot3 + 2.*theta3.*theta5.*theta6.^2.*thetaDot5 + 2.*theta3.*theta5.^2.*theta6.*thetaDot6, theta3.^2.*theta6.^2.*thetaDot5 + 2.*theta3.*theta5.*theta6.^2.*thetaDot3 + 2.*theta3.^2.*theta5.*theta6.*thetaDot6, theta3.^2.*theta5.^2.*thetaDot6 + 2.*theta3.*theta5.^2.*theta6.*thetaDot3 + 2.*theta3.^2.*theta5.*theta6.*thetaDot5, theta5.^2.*theta6.^2.*thetaDot4 + 2.*theta4.*theta5.*theta6.^2.*thetaDot5 + 2.*theta4.*theta5.^2.*theta6.*thetaDot6, theta4.^2.*theta6.^2.*thetaDot5 + 2.*theta4.*theta5.*theta6.^2.*thetaDot4 + 2.*theta4.^2.*theta5.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot6 + 2.*theta4.*theta5.^2.*theta6.*thetaDot4 + 2.*theta4.^2.*theta5.*theta6.*thetaDot5, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta2.*thetaDot5 + theta1.*theta5.*thetaDot2 + theta2.*theta5.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta1.*theta2.*thetaDot6 + theta1.*theta6.*thetaDot2 + theta2.*theta6.*thetaDot1, theta1.*theta3.*thetaDot5 + theta1.*theta5.*thetaDot3 + theta3.*theta5.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta3.*thetaDot6 + theta1.*theta6.*thetaDot3 + theta3.*theta6.*thetaDot1, theta1.*theta4.*thetaDot5 + theta1.*theta5.*thetaDot4 + theta4.*theta5.*thetaDot1, theta2.*theta3.*thetaDot5 + theta2.*theta5.*thetaDot3 + theta3.*theta5.*thetaDot2, theta1.*theta4.*thetaDot6 + theta1.*theta6.*thetaDot4 + theta4.*theta6.*thetaDot1, theta2.*theta3.*thetaDot6 + theta2.*theta6.*thetaDot3 + theta3.*theta6.*thetaDot2, theta2.*theta4.*thetaDot5 + theta2.*theta5.*thetaDot4 + theta4.*theta5.*thetaDot2, theta1.*theta5.*thetaDot6 + theta1.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot1, theta2.*theta4.*thetaDot6 + theta2.*theta6.*thetaDot4 + theta4.*theta6.*thetaDot2, theta3.*theta4.*thetaDot5 + theta3.*theta5.*thetaDot4 + theta4.*theta5.*thetaDot3, theta2.*theta5.*thetaDot6 + theta2.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot2, theta3.*theta4.*thetaDot6 + theta3.*theta6.*thetaDot4 + theta4.*theta6.*thetaDot3, theta3.*theta5.*thetaDot6 + theta3.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot3, theta4.*theta5.*thetaDot6 + theta4.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot4, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta3.*thetaDot5 + theta1.*theta2.*theta5.*thetaDot3 + theta1.*theta3.*theta5.*thetaDot2 + theta2.*theta3.*theta5.*thetaDot1, theta1.*theta2.*theta3.*thetaDot6 + theta1.*theta2.*theta6.*thetaDot3 + theta1.*theta3.*theta6.*thetaDot2 + theta2.*theta3.*theta6.*thetaDot1, theta1.*theta2.*theta4.*thetaDot5 + theta1.*theta2.*theta5.*thetaDot4 + theta1.*theta4.*theta5.*thetaDot2 + theta2.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta4.*thetaDot6 + theta1.*theta2.*theta6.*thetaDot4 + theta1.*theta4.*theta6.*thetaDot2 + theta2.*theta4.*theta6.*thetaDot1, theta1.*theta3.*theta4.*thetaDot5 + theta1.*theta3.*theta5.*thetaDot4 + theta1.*theta4.*theta5.*thetaDot3 + theta3.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta5.*thetaDot6 + theta1.*theta2.*theta6.*thetaDot5 + theta1.*theta5.*theta6.*thetaDot2 + theta2.*theta5.*theta6.*thetaDot1, theta1.*theta3.*theta4.*thetaDot6 + theta1.*theta3.*theta6.*thetaDot4 + theta1.*theta4.*theta6.*thetaDot3 + theta3.*theta4.*theta6.*thetaDot1, theta2.*theta3.*theta4.*thetaDot5 + theta2.*theta3.*theta5.*thetaDot4 + theta2.*theta4.*theta5.*thetaDot3 + theta3.*theta4.*theta5.*thetaDot2, theta1.*theta3.*theta5.*thetaDot6 + theta1.*theta3.*theta6.*thetaDot5 + theta1.*theta5.*theta6.*thetaDot3 + theta3.*theta5.*theta6.*thetaDot1, theta2.*theta3.*theta4.*thetaDot6 + theta2.*theta3.*theta6.*thetaDot4 + theta2.*theta4.*theta6.*thetaDot3 + theta3.*theta4.*theta6.*thetaDot2, theta1.*theta4.*theta5.*thetaDot6 + theta1.*theta4.*theta6.*thetaDot5 + theta1.*theta5.*theta6.*thetaDot4 + theta4.*theta5.*theta6.*thetaDot1, theta2.*theta3.*theta5.*thetaDot6 + theta2.*theta3.*theta6.*thetaDot5 + theta2.*theta5.*theta6.*thetaDot3 + theta3.*theta5.*theta6.*thetaDot2, theta2.*theta4.*theta5.*thetaDot6 + theta2.*theta4.*theta6.*thetaDot5 + theta2.*theta5.*theta6.*thetaDot4 + theta4.*theta5.*theta6.*thetaDot2, theta3.*theta4.*theta5.*thetaDot6 + theta3.*theta4.*theta6.*thetaDot5 + theta3.*theta5.*theta6.*thetaDot4 + theta4.*theta5.*theta6.*thetaDot3, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta5.^2.*thetaDot3 + theta1.*theta3.*theta5.^2.*thetaDot2 + theta2.*theta3.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot5, theta1.*theta2.*theta3.^2.*thetaDot5 + theta1.*theta3.^2.*theta5.*thetaDot2 + theta2.*theta3.^2.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot5 + theta1.*theta2.^2.*theta5.*thetaDot3 + theta2.^2.*theta3.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot5 + theta1.^2.*theta2.*theta5.*thetaDot3 + theta1.^2.*theta3.*theta5.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot1, theta1.*theta2.*theta6.^2.*thetaDot3 + theta1.*theta3.*theta6.^2.*thetaDot2 + theta2.*theta3.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot6, theta1.*theta2.*theta5.^2.*thetaDot4 + theta1.*theta4.*theta5.^2.*thetaDot2 + theta2.*theta4.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot5, theta1.*theta2.*theta3.^2.*thetaDot6 + theta1.*theta3.^2.*theta6.*thetaDot2 + theta2.*theta3.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot3, theta1.*theta2.*theta4.^2.*thetaDot5 + theta1.*theta4.^2.*theta5.*thetaDot2 + theta2.*theta4.^2.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot4, theta1.*theta2.^2.*theta3.*thetaDot6 + theta1.*theta2.^2.*theta6.*thetaDot3 + theta2.^2.*theta3.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot2, theta1.*theta2.^2.*theta4.*thetaDot5 + theta1.*theta2.^2.*theta5.*thetaDot4 + theta2.^2.*theta4.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot6 + theta1.^2.*theta2.*theta6.*thetaDot3 + theta1.^2.*theta3.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot1, theta1.^2.*theta2.*theta4.*thetaDot5 + theta1.^2.*theta2.*theta5.*thetaDot4 + theta1.^2.*theta4.*theta5.*thetaDot2 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta6.^2.*thetaDot4 + theta1.*theta4.*theta6.^2.*thetaDot2 + theta2.*theta4.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot6, theta1.*theta2.*theta4.^2.*thetaDot6 + theta1.*theta4.^2.*theta6.*thetaDot2 + theta2.*theta4.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot4, theta1.*theta3.*theta5.^2.*thetaDot4 + theta1.*theta4.*theta5.^2.*thetaDot3 + theta3.*theta4.*theta5.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot5, theta1.*theta3.*theta4.^2.*thetaDot5 + theta1.*theta4.^2.*theta5.*thetaDot3 + theta3.*theta4.^2.*theta5.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot4, theta1.*theta2.^2.*theta4.*thetaDot6 + theta1.*theta2.^2.*theta6.*thetaDot4 + theta2.^2.*theta4.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot2, theta1.*theta3.^2.*theta4.*thetaDot5 + theta1.*theta3.^2.*theta5.*thetaDot4 + theta3.^2.*theta4.*theta5.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot3, theta1.^2.*theta2.*theta4.*thetaDot6 + theta1.^2.*theta2.*theta6.*thetaDot4 + theta1.^2.*theta4.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot1, theta1.^2.*theta3.*theta4.*thetaDot5 + theta1.^2.*theta3.*theta5.*thetaDot4 + theta1.^2.*theta4.*theta5.*thetaDot3 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta6.^2.*thetaDot5 + theta1.*theta5.*theta6.^2.*thetaDot2 + theta2.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot6, theta1.*theta2.*theta5.^2.*thetaDot6 + theta1.*theta5.^2.*theta6.*thetaDot2 + theta2.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot5, theta1.*theta3.*theta6.^2.*thetaDot4 + theta1.*theta4.*theta6.^2.*thetaDot3 + theta3.*theta4.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot6, theta1.*theta3.*theta4.^2.*thetaDot6 + theta1.*theta4.^2.*theta6.*thetaDot3 + theta3.*theta4.^2.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot4, theta1.*theta2.^2.*theta5.*thetaDot6 + theta1.*theta2.^2.*theta6.*thetaDot5 + theta2.^2.*theta5.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot2, theta1.*theta3.^2.*theta4.*thetaDot6 + theta1.*theta3.^2.*theta6.*thetaDot4 + theta3.^2.*theta4.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot3, theta2.*theta3.*theta5.^2.*thetaDot4 + theta2.*theta4.*theta5.^2.*thetaDot3 + theta3.*theta4.*theta5.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot5, theta2.*theta3.*theta4.^2.*thetaDot5 + theta2.*theta4.^2.*theta5.*thetaDot3 + theta3.*theta4.^2.*theta5.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot4, theta2.*theta3.^2.*theta4.*thetaDot5 + theta2.*theta3.^2.*theta5.*thetaDot4 + theta3.^2.*theta4.*theta5.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot3, theta1.^2.*theta2.*theta5.*thetaDot6 + theta1.^2.*theta2.*theta6.*thetaDot5 + theta1.^2.*theta5.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot1, theta1.^2.*theta3.*theta4.*thetaDot6 + theta1.^2.*theta3.*theta6.*thetaDot4 + theta1.^2.*theta4.*theta6.*thetaDot3 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot1, theta2.^2.*theta3.*theta4.*thetaDot5 + theta2.^2.*theta3.*theta5.*thetaDot4 + theta2.^2.*theta4.*theta5.*thetaDot3 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot2, theta1.*theta3.*theta6.^2.*thetaDot5 + theta1.*theta5.*theta6.^2.*thetaDot3 + theta3.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot6, theta1.*theta3.*theta5.^2.*thetaDot6 + theta1.*theta5.^2.*theta6.*thetaDot3 + theta3.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot5, theta1.*theta3.^2.*theta5.*thetaDot6 + theta1.*theta3.^2.*theta6.*thetaDot5 + theta3.^2.*theta5.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot3, theta2.*theta3.*theta6.^2.*thetaDot4 + theta2.*theta4.*theta6.^2.*thetaDot3 + theta3.*theta4.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot6, theta2.*theta3.*theta4.^2.*thetaDot6 + theta2.*theta4.^2.*theta6.*thetaDot3 + theta3.*theta4.^2.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot4, theta2.*theta3.^2.*theta4.*thetaDot6 + theta2.*theta3.^2.*theta6.*thetaDot4 + theta3.^2.*theta4.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot3, theta1.^2.*theta3.*theta5.*thetaDot6 + theta1.^2.*theta3.*theta6.*thetaDot5 + theta1.^2.*theta5.*theta6.*thetaDot3 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot1, theta2.^2.*theta3.*theta4.*thetaDot6 + theta2.^2.*theta3.*theta6.*thetaDot4 + theta2.^2.*theta4.*theta6.*thetaDot3 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot2, theta1.*theta4.*theta6.^2.*thetaDot5 + theta1.*theta5.*theta6.^2.*thetaDot4 + theta4.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot6, theta1.*theta4.*theta5.^2.*thetaDot6 + theta1.*theta5.^2.*theta6.*thetaDot4 + theta4.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot5, theta1.*theta4.^2.*theta5.*thetaDot6 + theta1.*theta4.^2.*theta6.*thetaDot5 + theta4.^2.*theta5.*theta6.*thetaDot1 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot4, theta2.*theta3.*theta6.^2.*thetaDot5 + theta2.*theta5.*theta6.^2.*thetaDot3 + theta3.*theta5.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot6, theta2.*theta3.*theta5.^2.*thetaDot6 + theta2.*theta5.^2.*theta6.*thetaDot3 + theta3.*theta5.^2.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot5, theta2.*theta3.^2.*theta5.*thetaDot6 + theta2.*theta3.^2.*theta6.*thetaDot5 + theta3.^2.*theta5.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot3, theta1.^2.*theta4.*theta5.*thetaDot6 + theta1.^2.*theta4.*theta6.*thetaDot5 + theta1.^2.*theta5.*theta6.*thetaDot4 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot1, theta2.^2.*theta3.*theta5.*thetaDot6 + theta2.^2.*theta3.*theta6.*thetaDot5 + theta2.^2.*theta5.*theta6.*thetaDot3 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot2, theta2.*theta4.*theta6.^2.*thetaDot5 + theta2.*theta5.*theta6.^2.*thetaDot4 + theta4.*theta5.*theta6.^2.*thetaDot2 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot6, theta2.*theta4.*theta5.^2.*thetaDot6 + theta2.*theta5.^2.*theta6.*thetaDot4 + theta4.*theta5.^2.*theta6.*thetaDot2 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot5, theta2.*theta4.^2.*theta5.*thetaDot6 + theta2.*theta4.^2.*theta6.*thetaDot5 + theta4.^2.*theta5.*theta6.*thetaDot2 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot4, theta2.^2.*theta4.*theta5.*thetaDot6 + theta2.^2.*theta4.*theta6.*thetaDot5 + theta2.^2.*theta5.*theta6.*thetaDot4 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot2, theta3.*theta4.*theta6.^2.*thetaDot5 + theta3.*theta5.*theta6.^2.*thetaDot4 + theta4.*theta5.*theta6.^2.*thetaDot3 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot6, theta3.*theta4.*theta5.^2.*thetaDot6 + theta3.*theta5.^2.*theta6.*thetaDot4 + theta4.*theta5.^2.*theta6.*thetaDot3 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot5, theta3.*theta4.^2.*theta5.*thetaDot6 + theta3.*theta4.^2.*theta6.*thetaDot5 + theta4.^2.*theta5.*theta6.*thetaDot3 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot4, theta3.^2.*theta4.*theta5.*thetaDot6 + theta3.^2.*theta4.*theta6.*thetaDot5 + theta3.^2.*theta5.*theta6.*thetaDot4 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot3, theta1.*theta2.*theta3.*theta4.*thetaDot5 + theta1.*theta2.*theta3.*theta5.*thetaDot4 + theta1.*theta2.*theta4.*theta5.*thetaDot3 + theta1.*theta3.*theta4.*theta5.*thetaDot2 + theta2.*theta3.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta3.*theta4.*thetaDot6 + theta1.*theta2.*theta3.*theta6.*thetaDot4 + theta1.*theta2.*theta4.*theta6.*thetaDot3 + theta1.*theta3.*theta4.*theta6.*thetaDot2 + theta2.*theta3.*theta4.*theta6.*thetaDot1, theta1.*theta2.*theta3.*theta5.*thetaDot6 + theta1.*theta2.*theta3.*theta6.*thetaDot5 + theta1.*theta2.*theta5.*theta6.*thetaDot3 + theta1.*theta3.*theta5.*theta6.*thetaDot2 + theta2.*theta3.*theta5.*theta6.*thetaDot1, theta1.*theta2.*theta4.*theta5.*thetaDot6 + theta1.*theta2.*theta4.*theta6.*thetaDot5 + theta1.*theta2.*theta5.*theta6.*thetaDot4 + theta1.*theta4.*theta5.*theta6.*thetaDot2 + theta2.*theta4.*theta5.*theta6.*thetaDot1, theta1.*theta3.*theta4.*theta5.*thetaDot6 + theta1.*theta3.*theta4.*theta6.*thetaDot5 + theta1.*theta3.*theta5.*theta6.*thetaDot4 + theta1.*theta4.*theta5.*theta6.*thetaDot3 + theta3.*theta4.*theta5.*theta6.*thetaDot1, theta2.*theta3.*theta4.*theta5.*thetaDot6 + theta2.*theta3.*theta4.*theta6.*thetaDot5 + theta2.*theta3.*theta5.*theta6.*thetaDot4 + theta2.*theta4.*theta5.*theta6.*thetaDot3 + theta3.*theta4.*theta5.*theta6.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -2.*theta1.*theta5.^2, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.^3, -2.*theta1.*theta6.^2, -3.*theta1.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6.^3, -3.*theta1.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta5, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, -3.*theta1.^2.*theta5, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6, zeroCol, -4.*theta1.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta2.*theta5.^2, -theta3.*theta4.^2, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta2.*theta5, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta2.*theta5.^3, -theta2.*theta6.^2, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^2.*theta6, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -2.*theta1.*theta3.*theta5, -3.*theta1.^2.*theta2.*theta5, -3.*theta1.^2.*theta3.*theta4, zeroCol, -theta2.*theta6.^3, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -2.*theta1.*theta4.*theta5, -3.*theta1.^2.*theta2.*theta6, -3.*theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.^2.*theta3.*theta6, -3.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6, -3.*theta1.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta2.^2.*theta5.^2, -theta3.^2.*theta4.^2, -2.*theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta2.^2.*theta5, -2.*theta1.*theta3.^2.*theta4, -theta2.^2.*theta6.^2, -theta3.^2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta6.^2, -2.*theta1.*theta3.*theta5.^2, -2.*theta1.*theta2.^2.*theta6, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, -2.*theta1.*theta3.*theta6.^2, -2.*theta1.*theta4.*theta5.^2, -2.*theta1.*theta3.^2.*theta6, -2.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6.^2, -2.*theta1.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta2.*theta5, -theta3.*theta4, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta5, -theta2.*theta3.*theta6, -theta2.*theta4.*theta5, -theta2.*theta4.*theta6, -theta3.*theta4.*theta5, -theta2.*theta5.*theta6, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta2.*theta3.*theta6.^2, -theta2.*theta4.*theta5.^2, -theta2.*theta3.^2.*theta6, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta3.*theta6, -theta2.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta6, -theta3.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta4.*theta6, -2.*theta1.*theta3.*theta4.*theta5, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta2.^2.*theta5.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.*theta6, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.^3, -2.*theta2.*theta5.^2, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.^3, -2.*theta2.*theta6.^2, -3.*theta2.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6.^3, -3.*theta2.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, -3.*theta2.^2.*theta5, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6, zeroCol, -4.*theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta5, -3.*theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -3.*theta1.*theta2.^2.*theta5, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -2.*theta2.*theta3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -2.*theta2.*theta3.*theta5, -3.*theta2.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, -2.*theta2.*theta4.*theta5, -3.*theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.^2.*theta3.*theta6, -3.*theta2.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta2.^2.*theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, -2.*theta1.*theta2.*theta5.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -2.*theta1.*theta2.*theta6.^2, zeroCol, -theta3.^2.*theta4.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, -theta3.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.^2.*theta5, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6.^2, -2.*theta2.*theta4.*theta5.^2, -2.*theta2.*theta3.^2.*theta6, -2.*theta2.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.^2.*theta6, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6.^2, -2.*theta2.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3, -theta1.*theta4, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta3.*theta4, zeroCol, zeroCol, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta3.*theta5, -theta1.*theta3.*theta6, -theta1.*theta4.*theta5, -theta1.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5, zeroCol, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, -theta4.*theta5.*theta6, zeroCol, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta1.^2.*theta3.*theta5, -theta1.*theta3.*theta6.^2, -theta1.*theta4.*theta5.^2, -theta1.*theta3.^2.*theta6, -theta1.*theta4.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta1.^2.*theta3.*theta6, -theta1.^2.*theta4.*theta5, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, zeroCol, -theta1.^2.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, -theta1.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta5.*theta6, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta2.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta5.*theta6, -theta1.*theta4.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.*theta6, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^3, -2.*theta3.*theta5.^2, -3.*theta3.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta5.^3, -2.*theta3.*theta6.^2, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.*theta6.^3, -3.*theta3.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, -theta2, zeroCol, zeroCol, zeroCol, zeroCol, -theta4, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta3.^3, zeroCol, zeroCol, -theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, -3.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -3.*theta3.^2.*theta5, zeroCol, -4.*theta3.^3.*theta4, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta6, zeroCol, -4.*theta3.^3.*theta5, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, -4.*theta3.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta2.^2.*theta4, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -3.*theta1.*theta3.^2.*theta5, zeroCol, -theta2.*theta4.^3, -theta2.*theta5.^2, -2.*theta2.*theta3.*theta5, -3.*theta2.*theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, -3.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta6, -3.*theta2.*theta3.^2.*theta5, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2.*theta6, zeroCol, zeroCol, -theta4.*theta5.^2, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta6, zeroCol, -2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6, -3.*theta3.^2.*theta4.*theta5, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, -2.*theta3.*theta5.*theta6, -3.*theta3.^2.*theta4.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta3.*theta5, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta5.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta5.^2, -2.*theta2.^2.*theta3.*theta5, zeroCol, -2.*theta2.*theta3.*theta6.^2, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta6.^2, zeroCol, -2.*theta2.^2.*theta3.*theta6, zeroCol, zeroCol, zeroCol, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta5.^2, -2.*theta3.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.^2.*theta6, -theta5.^2.*theta6.^2, -2.*theta3.*theta5.*theta6.^2, -2.*theta3.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta4, zeroCol, -theta1.*theta5, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta4.*theta5, zeroCol, -theta4.*theta6, -theta5.*theta6, zeroCol, -theta1.*theta2.*theta4, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta4.*theta5, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta4.*theta5, -theta1.*theta5.*theta6, -theta2.*theta4.*theta6, zeroCol, -theta2.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.^2.*theta5, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -theta1.^2.*theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, -2.*theta1.*theta3.*theta4.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta4.*theta5, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta3.*theta5.*theta6, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -2.*theta2.*theta3.*theta4.*theta6, -theta1.^2.*theta5.*theta6, -theta2.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta3.*theta5.*theta6, zeroCol, -theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta1.*theta2.*theta4.*theta5, -theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta5.*theta6, zeroCol, -theta1.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta4.^2, zeroCol, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta4.^2, zeroCol, -2.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5.^2, zeroCol, zeroCol, -2.*theta4.*theta5.^3, -2.*theta4.*theta6.^2, -3.*theta4.^2.*theta5.^2, -2.*theta4.*theta6.^3, -3.*theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, zeroCol, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, zeroCol, zeroCol, -3.*theta2.*theta4.^2, zeroCol, -2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta4.^3, zeroCol, zeroCol, -3.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, zeroCol, zeroCol, zeroCol, -4.*theta3.*theta4.^3, zeroCol, zeroCol, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5, -theta3.^4, zeroCol, zeroCol, zeroCol, -theta5.^3, -theta6.^2, zeroCol, zeroCol, -2.*theta4.*theta6, zeroCol, -3.*theta4.^2.*theta5, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, -3.*theta4.^2.*theta6, zeroCol, -4.*theta4.^3.*theta5, -theta6.^4, zeroCol, -4.*theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, zeroCol, -4.*theta4.^3, zeroCol, zeroCol, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, -3.*theta1.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5, -3.*theta2.*theta3.*theta4.^2, zeroCol, zeroCol, -theta2.*theta3.^3, zeroCol, -theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta3, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta4.*theta5, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -theta2.^2.*theta5, zeroCol, -theta1.*theta6.^3, zeroCol, -3.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.*theta4.^2.*theta5, -theta3.*theta5.^2, -2.*theta3.*theta4.*theta5, zeroCol, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, -theta3.^2.*theta5, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, -3.*theta2.*theta4.^2.*theta6, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -2.*theta3.*theta4.*theta6, -3.*theta3.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, zeroCol, -3.*theta3.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.^3.*theta6, zeroCol, zeroCol, -theta5.*theta6.^2, -theta5.^2.*theta6, zeroCol, -2.*theta4.*theta5.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, -3.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, zeroCol, -2.*theta1.*theta3.^2.*theta4, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta5.^2, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta4.*theta6, zeroCol, -theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta4.*theta6, -theta3.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta5, zeroCol, -2.*theta3.*theta4.*theta6.^2, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, -2.*theta4.*theta5.*theta6.^2, -2.*theta4.*theta5.^2.*theta6, zeroCol, -theta1.*theta2, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta2.*theta3, zeroCol, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, zeroCol, -theta5.*theta6, -theta1.*theta2.*theta3, zeroCol, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, -theta1.*theta3.*theta5, zeroCol, -theta1.*theta3.*theta6, -theta2.*theta3.*theta5, zeroCol, -theta2.*theta3.*theta6, -theta1.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6, -theta3.*theta5.*theta6, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.^2.*theta5, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta2.^2.*theta6, -theta1.*theta3.^2.*theta5, -theta1.^2.*theta2.*theta6, -theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta1.*theta3.^2.*theta6, -theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.^2.*theta5, zeroCol, -theta1.^2.*theta3.*theta6, -theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.^2.*theta6, zeroCol, -theta2.^2.*theta3.*theta6, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta4.*theta5.*theta6, -theta2.^2.*theta5.*theta6, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta3.^2.*theta5.*theta6, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta5.*theta6, -theta1.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.*theta6, zeroCol,];
        momentArms5 = [ zeroCol, zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^3.*theta5, zeroCol, -2.*theta2.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^3.*theta5, zeroCol, -2.*theta3.^2.*theta5, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.^3.*theta5, -2.*theta4.^2.*theta5, zeroCol, zeroCol, -3.*theta4.^2.*theta5.^2, zeroCol, -2.*theta4.^3.*theta5, zeroCol, zeroCol, -2.*theta5.*theta6.^2, -2.*theta5.*theta6.^3, -3.*theta5.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta5.^3, zeroCol, zeroCol, -3.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta5.^3, zeroCol, zeroCol, -3.*theta3.*theta5.^2, zeroCol, -2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta5.^3, zeroCol, -3.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, zeroCol, -4.*theta4.*theta5.^3, zeroCol, -theta6.^2, zeroCol, zeroCol, -2.*theta5.*theta6, -theta4.^4, zeroCol, -theta6.^3, zeroCol, -3.*theta5.^2.*theta6, -theta6.^4, -4.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta5, zeroCol, zeroCol, -3.*theta5.^2, zeroCol, zeroCol, -4.*theta5.^3, zeroCol, -5.*theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, -3.*theta1.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta5.^2, zeroCol, -2.*theta1.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, -2.*theta2.*theta3.*theta5, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -3.*theta2.*theta3.*theta5.^2, zeroCol, -2.*theta2.*theta4.*theta5, zeroCol, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta5.*theta6, zeroCol, -3.*theta2.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta2.*theta4.^3, -2.*theta3.*theta4.*theta5, -theta3.*theta4.^2, -theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta4, -theta3.^2.*theta4, -theta1.*theta6.^3, -3.*theta1.*theta5.^2.*theta6, zeroCol, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta3.*theta4.^3, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, zeroCol, -theta3.^3.*theta4, -theta2.*theta6.^3, -3.*theta2.*theta5.^2.*theta6, zeroCol, -theta3.*theta6.^2, zeroCol, -2.*theta3.*theta5.*theta6, -theta2.^3.*theta6, -theta3.^2.*theta6, zeroCol, -theta3.*theta6.^3, -3.*theta3.*theta5.^2.*theta6, -theta4.*theta6.^2, -2.*theta4.*theta5.*theta6, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.*theta6.^3, -3.*theta4.*theta5.^2.*theta6, -theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta5, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta5, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.^2.*theta5, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta5, -theta2.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -theta2.^2.*theta4.^2, -2.*theta1.*theta5.*theta6.^2, zeroCol, -2.*theta3.*theta4.^2.*theta5, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.^2.*theta4.*theta5, -theta3.^2.*theta4.^2, -2.*theta2.*theta5.*theta6.^2, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.*theta5.*theta6.^2, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta5.*theta6, -2.*theta4.*theta5.*theta6.^2, -theta4.^2.*theta6.^2, -2.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, zeroCol, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta3.*theta4, -theta2.*theta6, zeroCol, -theta3.*theta6, -theta4.*theta6, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta2.*theta6, zeroCol, -theta2.*theta3.*theta4, -theta1.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta3.*theta6, -theta2.*theta4.*theta6, -theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta4.^2, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.^2, zeroCol, -theta1.*theta3.^2.*theta4, zeroCol, -theta1.^2.*theta3.*theta4, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta2.*theta6, zeroCol, -theta2.^2.*theta3.*theta4, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.^2.*theta6, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.^2.*theta6, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta3.*theta6, -theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.^2.*theta6, -theta2.^2.*theta4.*theta6, -theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, -theta1.*theta2.*theta3.*theta4, zeroCol, -theta1.*theta2.*theta3.*theta6, -theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.*theta6, zeroCol,];
        momentArms6 = [ zeroCol, zeroCol, zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6.^2, -2.*theta1.^3.*theta6, zeroCol, -2.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6.^2, -2.*theta2.^3.*theta6, zeroCol, -2.*theta3.^2.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta6.^2, -2.*theta3.^3.*theta6, zeroCol, -2.*theta4.^2.*theta6, zeroCol, -3.*theta4.^2.*theta6.^2, -2.*theta4.^3.*theta6, -2.*theta5.^2.*theta6, -3.*theta5.^2.*theta6.^2, -2.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, -theta3, zeroCol, -theta4, -theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta6.^3, zeroCol, -3.*theta2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta6.^3, zeroCol, -3.*theta3.*theta6.^2, zeroCol, -2.*theta4.*theta6, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta6.^3, zeroCol, -3.*theta4.*theta6.^2, -2.*theta5.*theta6, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, -4.*theta4.*theta6.^3, -3.*theta5.*theta6.^2, -theta4.^4, -theta5.^3, -4.*theta5.*theta6.^3, -theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta6, zeroCol, zeroCol, -3.*theta6.^2, zeroCol, -4.*theta6.^3, -5.*theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta3.*theta6, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, zeroCol, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, -theta1.^3.*theta3, zeroCol, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta5.*theta6, -theta1.*theta4.^3, -theta1.*theta5.^2, -3.*theta2.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, zeroCol, -3.*theta1.*theta5.*theta6.^2, -theta1.*theta5.^3, -3.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta5.*theta6, -theta2.*theta4.^3, -theta2.*theta5.^2, zeroCol, -2.*theta3.*theta4.*theta6, -theta3.*theta4.^2, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, zeroCol, -3.*theta2.*theta5.*theta6.^2, -theta2.*theta5.^3, -3.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta5.*theta6, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, -3.*theta3.*theta5.*theta6.^2, -theta3.*theta5.^3, -2.*theta4.*theta5.*theta6, -theta4.*theta5.^2, -theta3.^3.*theta5, -theta4.^2.*theta5, -3.*theta4.*theta5.*theta6.^2, -theta4.*theta5.^3, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta6, -2.*theta2.*theta3.^2.*theta6, zeroCol, -2.*theta1.^2.*theta4.*theta6, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta5.^2.*theta6, -2.*theta2.*theta4.^2.*theta6, zeroCol, -2.*theta1.^2.*theta5.*theta6, -theta1.^2.*theta5.^2, -2.*theta2.^2.*theta4.*theta6, -theta2.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta5.^2.*theta6, -2.*theta3.*theta4.^2.*theta6, -2.*theta2.^2.*theta5.*theta6, -theta2.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta6, -theta3.^2.*theta4.^2, -2.*theta3.*theta5.^2.*theta6, -2.*theta3.^2.*theta5.*theta6, -theta3.^2.*theta5.^2, -2.*theta4.*theta5.^2.*theta6, -2.*theta4.^2.*theta5.*theta6, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, -theta1.*theta5, -theta2.*theta4, zeroCol, -theta2.*theta5, -theta3.*theta4, -theta3.*theta5, -theta4.*theta5, zeroCol, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta3.*theta4, zeroCol, -theta1.*theta3.*theta5, -theta2.*theta3.*theta4, -theta1.*theta4.*theta5, -theta2.*theta3.*theta5, -theta2.*theta4.*theta5, -theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta3.^2, zeroCol, -theta1.*theta2.^2.*theta3, zeroCol, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta4.^2, zeroCol, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta4.^2, -theta1.*theta2.^2.*theta5, -theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta3.*theta5, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta1.^2.*theta4.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta5, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta4.*theta5, -theta1.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta5, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; momentArms5; momentArms6; ];
    case 15
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 16
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 17
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 18
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 19
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 20
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 21
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 22
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 23
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 24
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 25
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 26
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 27
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 28
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 29
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 30
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 31
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 32
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 33
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 34
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 35
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 36
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 37
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 38
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 39
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 40
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 41
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 42
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 43
        theta1 = jointAngles(:, 1);
        thetaDot1 = jointVelocities(:, 1);
        muscleTendonLengths = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 4.*theta1.^3.*thetaDot1, 5.*theta1.^4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; ];
    case 44
        theta1 = jointAngles(:, 1);
        thetaDot1 = jointVelocities(:, 1);
        muscleTendonLengths = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 4.*theta1.^3.*thetaDot1, 5.*theta1.^4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; ];
    case 45
        theta1 = jointAngles(:, 1);
        thetaDot1 = jointVelocities(:, 1);
        muscleTendonLengths = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 4.*theta1.^3.*thetaDot1, 5.*theta1.^4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; ];
    case 46
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 47
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 48
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 49
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 50
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 51
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 52
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 53
        theta1 = jointAngles(:, 1);
        thetaDot1 = jointVelocities(:, 1);
        muscleTendonLengths = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 4.*theta1.^3.*thetaDot1, 5.*theta1.^4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; ];
    case 54
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 55
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 56
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 57
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 58
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 59
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        theta5 = jointAngles(:, 5);
        theta6 = jointAngles(:, 6);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        thetaDot5 = jointVelocities(:, 5);
        thetaDot6 = jointVelocities(:, 6);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta5, theta6, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^2.*theta5.^2, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta1.^2.*theta5.^3, theta1.^2.*theta6.^2, theta1.^3.*theta5.^2, theta2.^2.*theta4.^3, theta2.^2.*theta5.^2, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta1.^2.*theta6.^3, theta1.^3.*theta6.^2, theta2.^2.*theta5.^3, theta2.^2.*theta6.^2, theta2.^3.*theta5.^2, theta3.^2.*theta4.^3, theta3.^2.*theta5.^2, theta3.^3.*theta4.^2, theta2.^2.*theta6.^3, theta2.^3.*theta6.^2, theta3.^2.*theta5.^3, theta3.^2.*theta6.^2, theta3.^3.*theta5.^2, theta4.^2.*theta5.^2, theta3.^2.*theta6.^3, theta3.^3.*theta6.^2, theta4.^2.*theta5.^3, theta4.^2.*theta6.^2, theta4.^3.*theta5.^2, theta4.^2.*theta6.^3, theta4.^3.*theta6.^2, theta5.^2.*theta6.^2, theta5.^2.*theta6.^3, theta5.^3.*theta6.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta1.*theta5, theta2.*theta4, theta1.*theta6, theta2.*theta5, theta3.*theta4, theta2.*theta6, theta3.*theta5, theta3.*theta6, theta4.*theta5, theta4.*theta6, theta5.*theta6, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta1.*theta5.^2, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^2.*theta5, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta1.*theta5.^3, theta1.*theta6.^2, theta2.*theta3.^4, theta2.*theta4.^3, theta2.*theta5.^2, theta3.*theta4.^2, theta1.^2.*theta6, theta1.^3.*theta5, theta2.^2.*theta5, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta1.*theta5.^4, theta1.*theta6.^3, theta2.*theta4.^4, theta2.*theta5.^3, theta2.*theta6.^2, theta3.*theta4.^3, theta3.*theta5.^2, theta1.^3.*theta6, theta2.^2.*theta6, theta1.^4.*theta5, theta2.^3.*theta5, theta3.^2.*theta5, theta2.^4.*theta4, theta3.^3.*theta4, theta1.*theta6.^4, theta2.*theta5.^4, theta2.*theta6.^3, theta3.*theta4.^4, theta3.*theta5.^3, theta3.*theta6.^2, theta4.*theta5.^2, theta1.^4.*theta6, theta2.^3.*theta6, theta3.^2.*theta6, theta2.^4.*theta5, theta3.^3.*theta5, theta4.^2.*theta5, theta3.^4.*theta4, theta2.*theta6.^4, theta3.*theta5.^4, theta3.*theta6.^3, theta4.*theta5.^3, theta4.*theta6.^2, theta2.^4.*theta6, theta3.^3.*theta6, theta4.^2.*theta6, theta3.^4.*theta5, theta4.^3.*theta5, theta3.*theta6.^4, theta4.*theta5.^4, theta4.*theta6.^3, theta5.*theta6.^2, theta3.^4.*theta6, theta4.^3.*theta6, theta5.^2.*theta6, theta4.^4.*theta5, theta4.*theta6.^4, theta5.*theta6.^3, theta4.^4.*theta6, theta5.^3.*theta6, theta5.*theta6.^4, theta5.^4.*theta6, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta5.^2, theta3.^5, theta4.^4, theta5.^3, theta6.^2, theta4.^5, theta5.^4, theta6.^3, theta5.^5, theta6.^4, theta6.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta2.*theta5.^2, theta1.*theta3.*theta4.^2, theta1.*theta2.^2.*theta5, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta2.*theta5, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta2.*theta5.^3, theta1.*theta2.*theta6.^2, theta1.*theta3.*theta4.^3, theta1.*theta3.*theta5.^2, theta1.*theta2.^2.*theta6, theta1.*theta2.^3.*theta5, theta1.*theta3.^2.*theta5, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^2.*theta2.*theta6, theta1.^2.*theta3.*theta5, theta1.^3.*theta2.*theta5, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta1.*theta2.*theta6.^3, theta1.*theta3.*theta5.^3, theta1.*theta3.*theta6.^2, theta1.*theta4.*theta5.^2, theta1.*theta2.^3.*theta6, theta1.*theta3.^2.*theta6, theta1.*theta3.^3.*theta5, theta1.*theta4.^2.*theta5, theta2.*theta3.*theta4.^3, theta2.*theta3.*theta5.^2, theta2.*theta3.^2.*theta5, theta2.*theta3.^3.*theta4, theta1.^2.*theta3.*theta6, theta1.^2.*theta4.*theta5, theta1.^3.*theta2.*theta6, theta1.^3.*theta3.*theta5, theta2.^2.*theta3.*theta5, theta2.^3.*theta3.*theta4, theta1.*theta3.*theta6.^3, theta1.*theta4.*theta5.^3, theta1.*theta4.*theta6.^2, theta1.*theta3.^3.*theta6, theta1.*theta4.^2.*theta6, theta1.*theta4.^3.*theta5, theta2.*theta3.*theta5.^3, theta2.*theta3.*theta6.^2, theta2.*theta4.*theta5.^2, theta2.*theta3.^2.*theta6, theta2.*theta3.^3.*theta5, theta2.*theta4.^2.*theta5, theta1.^2.*theta4.*theta6, theta1.^3.*theta3.*theta6, theta1.^3.*theta4.*theta5, theta2.^2.*theta3.*theta6, theta2.^2.*theta4.*theta5, theta2.^3.*theta3.*theta5, theta1.*theta4.*theta6.^3, theta1.*theta5.*theta6.^2, theta1.*theta4.^3.*theta6, theta1.*theta5.^2.*theta6, theta2.*theta3.*theta6.^3, theta2.*theta4.*theta5.^3, theta2.*theta4.*theta6.^2, theta2.*theta3.^3.*theta6, theta2.*theta4.^2.*theta6, theta2.*theta4.^3.*theta5, theta3.*theta4.*theta5.^2, theta3.*theta4.^2.*theta5, theta1.^2.*theta5.*theta6, theta1.^3.*theta4.*theta6, theta2.^2.*theta4.*theta6, theta2.^3.*theta3.*theta6, theta2.^3.*theta4.*theta5, theta3.^2.*theta4.*theta5, theta1.*theta5.*theta6.^3, theta1.*theta5.^3.*theta6, theta2.*theta4.*theta6.^3, theta2.*theta5.*theta6.^2, theta2.*theta4.^3.*theta6, theta2.*theta5.^2.*theta6, theta3.*theta4.*theta5.^3, theta3.*theta4.*theta6.^2, theta3.*theta4.^2.*theta6, theta3.*theta4.^3.*theta5, theta1.^3.*theta5.*theta6, theta2.^2.*theta5.*theta6, theta2.^3.*theta4.*theta6, theta3.^2.*theta4.*theta6, theta3.^3.*theta4.*theta5, theta2.*theta5.*theta6.^3, theta2.*theta5.^3.*theta6, theta3.*theta4.*theta6.^3, theta3.*theta5.*theta6.^2, theta3.*theta4.^3.*theta6, theta3.*theta5.^2.*theta6, theta2.^3.*theta5.*theta6, theta3.^2.*theta5.*theta6, theta3.^3.*theta4.*theta6, theta3.*theta5.*theta6.^3, theta3.*theta5.^3.*theta6, theta4.*theta5.*theta6.^2, theta4.*theta5.^2.*theta6, theta3.^3.*theta5.*theta6, theta4.^2.*theta5.*theta6, theta4.*theta5.*theta6.^3, theta4.*theta5.^3.*theta6, theta4.^3.*theta5.*theta6, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta2.^2.*theta5.^2, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta5.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta2.^2.*theta5, theta1.^2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta6.^2, theta1.*theta3.^2.*theta5.^2, theta2.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta6.^2, theta1.^2.*theta3.*theta5.^2, theta1.^2.*theta2.^2.*theta6, theta1.^2.*theta3.^2.*theta5, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta3.^2.*theta6.^2, theta1.*theta4.^2.*theta5.^2, theta2.*theta3.^2.*theta5.^2, theta1.^2.*theta3.*theta6.^2, theta1.^2.*theta4.*theta5.^2, theta1.^2.*theta3.^2.*theta6, theta1.^2.*theta4.^2.*theta5, theta2.^2.*theta3.*theta5.^2, theta2.^2.*theta3.^2.*theta5, theta1.*theta4.^2.*theta6.^2, theta2.*theta3.^2.*theta6.^2, theta2.*theta4.^2.*theta5.^2, theta1.^2.*theta4.*theta6.^2, theta1.^2.*theta4.^2.*theta6, theta2.^2.*theta3.*theta6.^2, theta2.^2.*theta4.*theta5.^2, theta2.^2.*theta3.^2.*theta6, theta2.^2.*theta4.^2.*theta5, theta1.*theta5.^2.*theta6.^2, theta2.*theta4.^2.*theta6.^2, theta3.*theta4.^2.*theta5.^2, theta1.^2.*theta5.*theta6.^2, theta1.^2.*theta5.^2.*theta6, theta2.^2.*theta4.*theta6.^2, theta2.^2.*theta4.^2.*theta6, theta3.^2.*theta4.*theta5.^2, theta3.^2.*theta4.^2.*theta5, theta2.*theta5.^2.*theta6.^2, theta3.*theta4.^2.*theta6.^2, theta2.^2.*theta5.*theta6.^2, theta2.^2.*theta5.^2.*theta6, theta3.^2.*theta4.*theta6.^2, theta3.^2.*theta4.^2.*theta6, theta3.*theta5.^2.*theta6.^2, theta3.^2.*theta5.*theta6.^2, theta3.^2.*theta5.^2.*theta6, theta4.*theta5.^2.*theta6.^2, theta4.^2.*theta5.*theta6.^2, theta4.^2.*theta5.^2.*theta6, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta2.*theta5, theta1.*theta3.*theta4, theta1.*theta2.*theta6, theta1.*theta3.*theta5, theta2.*theta3.*theta4, theta1.*theta3.*theta6, theta1.*theta4.*theta5, theta2.*theta3.*theta5, theta1.*theta4.*theta6, theta2.*theta3.*theta6, theta2.*theta4.*theta5, theta1.*theta5.*theta6, theta2.*theta4.*theta6, theta3.*theta4.*theta5, theta2.*theta5.*theta6, theta3.*theta4.*theta6, theta3.*theta5.*theta6, theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6, theta1.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6, theta1.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6, theta1.*theta3.*theta4.*theta6, theta2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6, theta2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6, theta2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5.^2, theta1.*theta2.*theta3.^2.*theta5, theta1.*theta2.^2.*theta3.*theta5, theta1.^2.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6.^2, theta1.*theta2.*theta4.*theta5.^2, theta1.*theta2.*theta3.^2.*theta6, theta1.*theta2.*theta4.^2.*theta5, theta1.*theta2.^2.*theta3.*theta6, theta1.*theta2.^2.*theta4.*theta5, theta1.^2.*theta2.*theta3.*theta6, theta1.^2.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6.^2, theta1.*theta2.*theta4.^2.*theta6, theta1.*theta3.*theta4.*theta5.^2, theta1.*theta3.*theta4.^2.*theta5, theta1.*theta2.^2.*theta4.*theta6, theta1.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta4.*theta6, theta1.^2.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6.^2, theta1.*theta2.*theta5.^2.*theta6, theta1.*theta3.*theta4.*theta6.^2, theta1.*theta3.*theta4.^2.*theta6, theta1.*theta2.^2.*theta5.*theta6, theta1.*theta3.^2.*theta4.*theta6, theta2.*theta3.*theta4.*theta5.^2, theta2.*theta3.*theta4.^2.*theta5, theta2.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta5.*theta6, theta1.^2.*theta3.*theta4.*theta6, theta2.^2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6.^2, theta1.*theta3.*theta5.^2.*theta6, theta1.*theta3.^2.*theta5.*theta6, theta2.*theta3.*theta4.*theta6.^2, theta2.*theta3.*theta4.^2.*theta6, theta2.*theta3.^2.*theta4.*theta6, theta1.^2.*theta3.*theta5.*theta6, theta2.^2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6.^2, theta1.*theta4.*theta5.^2.*theta6, theta1.*theta4.^2.*theta5.*theta6, theta2.*theta3.*theta5.*theta6.^2, theta2.*theta3.*theta5.^2.*theta6, theta2.*theta3.^2.*theta5.*theta6, theta1.^2.*theta4.*theta5.*theta6, theta2.^2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6.^2, theta2.*theta4.*theta5.^2.*theta6, theta2.*theta4.^2.*theta5.*theta6, theta2.^2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6.^2, theta3.*theta4.*theta5.^2.*theta6, theta3.*theta4.^2.*theta5.*theta6, theta3.^2.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.*theta5, theta1.*theta2.*theta3.*theta4.*theta6, theta1.*theta2.*theta3.*theta5.*theta6, theta1.*theta2.*theta4.*theta5.*theta6, theta1.*theta3.*theta4.*theta5.*theta6, theta2.*theta3.*theta4.*theta5.*theta6, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, thetaDot5, thetaDot6, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta5.*thetaDot5, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta1.*theta5.^3.*thetaDot1 + 3.*theta1.^2.*theta5.^2.*thetaDot5, 2.*theta1.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta6.*thetaDot6, 2.*theta1.^3.*theta5.*thetaDot5 + 3.*theta1.^2.*theta5.^2.*thetaDot1, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.*theta5.^2.*thetaDot2 + 2.*theta2.^2.*theta5.*thetaDot5, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta1.*theta6.^3.*thetaDot1 + 3.*theta1.^2.*theta6.^2.*thetaDot6, 2.*theta1.^3.*theta6.*thetaDot6 + 3.*theta1.^2.*theta6.^2.*thetaDot1, 2.*theta2.*theta5.^3.*thetaDot2 + 3.*theta2.^2.*theta5.^2.*thetaDot5, 2.*theta2.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta6.*thetaDot6, 2.*theta2.^3.*theta5.*thetaDot5 + 3.*theta2.^2.*theta5.^2.*thetaDot2, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.*theta5.^2.*thetaDot3 + 2.*theta3.^2.*theta5.*thetaDot5, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, 2.*theta2.*theta6.^3.*thetaDot2 + 3.*theta2.^2.*theta6.^2.*thetaDot6, 2.*theta2.^3.*theta6.*thetaDot6 + 3.*theta2.^2.*theta6.^2.*thetaDot2, 2.*theta3.*theta5.^3.*thetaDot3 + 3.*theta3.^2.*theta5.^2.*thetaDot5, 2.*theta3.*theta6.^2.*thetaDot3 + 2.*theta3.^2.*theta6.*thetaDot6, 2.*theta3.^3.*theta5.*thetaDot5 + 3.*theta3.^2.*theta5.^2.*thetaDot3, 2.*theta4.*theta5.^2.*thetaDot4 + 2.*theta4.^2.*theta5.*thetaDot5, 2.*theta3.*theta6.^3.*thetaDot3 + 3.*theta3.^2.*theta6.^2.*thetaDot6, 2.*theta3.^3.*theta6.*thetaDot6 + 3.*theta3.^2.*theta6.^2.*thetaDot3, 2.*theta4.*theta5.^3.*thetaDot4 + 3.*theta4.^2.*theta5.^2.*thetaDot5, 2.*theta4.*theta6.^2.*thetaDot4 + 2.*theta4.^2.*theta6.*thetaDot6, 2.*theta4.^3.*theta5.*thetaDot5 + 3.*theta4.^2.*theta5.^2.*thetaDot4, 2.*theta4.*theta6.^3.*thetaDot4 + 3.*theta4.^2.*theta6.^2.*thetaDot6, 2.*theta4.^3.*theta6.*thetaDot6 + 3.*theta4.^2.*theta6.^2.*thetaDot4, 2.*theta5.*theta6.^2.*thetaDot5 + 2.*theta5.^2.*theta6.*thetaDot6, 2.*theta5.*theta6.^3.*thetaDot5 + 3.*theta5.^2.*theta6.^2.*thetaDot6, 2.*theta5.^3.*theta6.*thetaDot6 + 3.*theta5.^2.*theta6.^2.*thetaDot5, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta1.*thetaDot5 + theta5.*thetaDot1, theta2.*thetaDot4 + theta4.*thetaDot2, theta1.*thetaDot6 + theta6.*thetaDot1, theta2.*thetaDot5 + theta5.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.*thetaDot6 + theta6.*thetaDot2, theta3.*thetaDot5 + theta5.*thetaDot3, theta3.*thetaDot6 + theta6.*thetaDot3, theta4.*thetaDot5 + theta5.*thetaDot4, theta4.*thetaDot6 + theta6.*thetaDot4, theta5.*thetaDot6 + theta6.*thetaDot5, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta5.^2.*thetaDot1 + 2.*theta1.*theta5.*thetaDot5, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^2.*thetaDot5 + 2.*theta1.*theta5.*thetaDot1, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta5.^3.*thetaDot1 + 3.*theta1.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot1 + 2.*theta1.*theta6.*thetaDot6, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta5.^2.*thetaDot2 + 2.*theta2.*theta5.*thetaDot5, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^2.*thetaDot6 + 2.*theta1.*theta6.*thetaDot1, theta1.^3.*thetaDot5 + 3.*theta1.^2.*theta5.*thetaDot1, theta2.^2.*thetaDot5 + 2.*theta2.*theta5.*thetaDot2, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta5.^4.*thetaDot1 + 4.*theta1.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot1 + 3.*theta1.*theta6.^2.*thetaDot6, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta5.^3.*thetaDot2 + 3.*theta2.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot2 + 2.*theta2.*theta6.*thetaDot6, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta5.^2.*thetaDot3 + 2.*theta3.*theta5.*thetaDot5, theta1.^3.*thetaDot6 + 3.*theta1.^2.*theta6.*thetaDot1, theta2.^2.*thetaDot6 + 2.*theta2.*theta6.*thetaDot2, theta1.^4.*thetaDot5 + 4.*theta1.^3.*theta5.*thetaDot1, theta2.^3.*thetaDot5 + 3.*theta2.^2.*theta5.*thetaDot2, theta3.^2.*thetaDot5 + 2.*theta3.*theta5.*thetaDot3, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta6.^4.*thetaDot1 + 4.*theta1.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot2 + 4.*theta2.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot2 + 3.*theta2.*theta6.^2.*thetaDot6, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta5.^3.*thetaDot3 + 3.*theta3.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot3 + 2.*theta3.*theta6.*thetaDot6, theta5.^2.*thetaDot4 + 2.*theta4.*theta5.*thetaDot5, theta1.^4.*thetaDot6 + 4.*theta1.^3.*theta6.*thetaDot1, theta2.^3.*thetaDot6 + 3.*theta2.^2.*theta6.*thetaDot2, theta3.^2.*thetaDot6 + 2.*theta3.*theta6.*thetaDot3, theta2.^4.*thetaDot5 + 4.*theta2.^3.*theta5.*thetaDot2, theta3.^3.*thetaDot5 + 3.*theta3.^2.*theta5.*thetaDot3, theta4.^2.*thetaDot5 + 2.*theta4.*theta5.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, theta6.^4.*thetaDot2 + 4.*theta2.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot3 + 4.*theta3.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot3 + 3.*theta3.*theta6.^2.*thetaDot6, theta5.^3.*thetaDot4 + 3.*theta4.*theta5.^2.*thetaDot5, theta6.^2.*thetaDot4 + 2.*theta4.*theta6.*thetaDot6, theta2.^4.*thetaDot6 + 4.*theta2.^3.*theta6.*thetaDot2, theta3.^3.*thetaDot6 + 3.*theta3.^2.*theta6.*thetaDot3, theta4.^2.*thetaDot6 + 2.*theta4.*theta6.*thetaDot4, theta3.^4.*thetaDot5 + 4.*theta3.^3.*theta5.*thetaDot3, theta4.^3.*thetaDot5 + 3.*theta4.^2.*theta5.*thetaDot4, theta6.^4.*thetaDot3 + 4.*theta3.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot4 + 4.*theta4.*theta5.^3.*thetaDot5, theta6.^3.*thetaDot4 + 3.*theta4.*theta6.^2.*thetaDot6, theta6.^2.*thetaDot5 + 2.*theta5.*theta6.*thetaDot6, theta3.^4.*thetaDot6 + 4.*theta3.^3.*theta6.*thetaDot3, theta4.^3.*thetaDot6 + 3.*theta4.^2.*theta6.*thetaDot4, theta5.^2.*thetaDot6 + 2.*theta5.*theta6.*thetaDot5, theta4.^4.*thetaDot5 + 4.*theta4.^3.*theta5.*thetaDot4, theta6.^4.*thetaDot4 + 4.*theta4.*theta6.^3.*thetaDot6, theta6.^3.*thetaDot5 + 3.*theta5.*theta6.^2.*thetaDot6, theta4.^4.*thetaDot6 + 4.*theta4.^3.*theta6.*thetaDot4, theta5.^3.*thetaDot6 + 3.*theta5.^2.*theta6.*thetaDot5, theta6.^4.*thetaDot5 + 4.*theta5.*theta6.^3.*thetaDot6, theta5.^4.*thetaDot6 + 4.*theta5.^3.*theta6.*thetaDot5, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 2.*theta5.*thetaDot5, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 3.*theta5.^2.*thetaDot5, 2.*theta6.*thetaDot6, 5.*theta4.^4.*thetaDot4, 4.*theta5.^3.*thetaDot5, 3.*theta6.^2.*thetaDot6, 5.*theta5.^4.*thetaDot5, 4.*theta6.^3.*thetaDot6, 5.*theta6.^4.*thetaDot6, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta5.^2.*thetaDot2 + theta2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta5.*thetaDot5, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot5 + theta2.^2.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta5.*thetaDot2, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta2.*thetaDot5 + theta1.^2.*theta5.*thetaDot2 + 2.*theta1.*theta2.*theta5.*thetaDot1, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta5.^3.*thetaDot2 + theta2.*theta5.^3.*thetaDot1 + 3.*theta1.*theta2.*theta5.^2.*thetaDot5, theta1.*theta6.^2.*thetaDot2 + theta2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta6.*thetaDot6, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta5.^2.*thetaDot3 + theta3.*theta5.^2.*thetaDot1 + 2.*theta1.*theta3.*theta5.*thetaDot5, theta1.*theta2.^2.*thetaDot6 + theta2.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta6.*thetaDot2, theta1.*theta2.^3.*thetaDot5 + theta2.^3.*theta5.*thetaDot1 + 3.*theta1.*theta2.^2.*theta5.*thetaDot2, theta1.*theta3.^2.*thetaDot5 + theta3.^2.*theta5.*thetaDot1 + 2.*theta1.*theta3.*theta5.*thetaDot3, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^2.*theta2.*thetaDot6 + theta1.^2.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta6.*thetaDot1, theta1.^2.*theta3.*thetaDot5 + theta1.^2.*theta5.*thetaDot3 + 2.*theta1.*theta3.*theta5.*thetaDot1, theta1.^3.*theta2.*thetaDot5 + theta1.^3.*theta5.*thetaDot2 + 3.*theta1.^2.*theta2.*theta5.*thetaDot1, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta1.*theta6.^3.*thetaDot2 + theta2.*theta6.^3.*thetaDot1 + 3.*theta1.*theta2.*theta6.^2.*thetaDot6, theta1.*theta5.^3.*thetaDot3 + theta3.*theta5.^3.*thetaDot1 + 3.*theta1.*theta3.*theta5.^2.*thetaDot5, theta1.*theta6.^2.*thetaDot3 + theta3.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta6.*thetaDot6, theta1.*theta5.^2.*thetaDot4 + theta4.*theta5.^2.*thetaDot1 + 2.*theta1.*theta4.*theta5.*thetaDot5, theta1.*theta2.^3.*thetaDot6 + theta2.^3.*theta6.*thetaDot1 + 3.*theta1.*theta2.^2.*theta6.*thetaDot2, theta1.*theta3.^2.*thetaDot6 + theta3.^2.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta6.*thetaDot3, theta1.*theta3.^3.*thetaDot5 + theta3.^3.*theta5.*thetaDot1 + 3.*theta1.*theta3.^2.*theta5.*thetaDot3, theta1.*theta4.^2.*thetaDot5 + theta4.^2.*theta5.*thetaDot1 + 2.*theta1.*theta4.*theta5.*thetaDot4, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta5.^2.*thetaDot3 + theta3.*theta5.^2.*thetaDot2 + 2.*theta2.*theta3.*theta5.*thetaDot5, theta2.*theta3.^2.*thetaDot5 + theta3.^2.*theta5.*thetaDot2 + 2.*theta2.*theta3.*theta5.*thetaDot3, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot6 + theta1.^2.*theta6.*thetaDot3 + 2.*theta1.*theta3.*theta6.*thetaDot1, theta1.^2.*theta4.*thetaDot5 + theta1.^2.*theta5.*thetaDot4 + 2.*theta1.*theta4.*theta5.*thetaDot1, theta1.^3.*theta2.*thetaDot6 + theta1.^3.*theta6.*thetaDot2 + 3.*theta1.^2.*theta2.*theta6.*thetaDot1, theta1.^3.*theta3.*thetaDot5 + theta1.^3.*theta5.*thetaDot3 + 3.*theta1.^2.*theta3.*theta5.*thetaDot1, theta2.^2.*theta3.*thetaDot5 + theta2.^2.*theta5.*thetaDot3 + 2.*theta2.*theta3.*theta5.*thetaDot2, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta1.*theta6.^3.*thetaDot3 + theta3.*theta6.^3.*thetaDot1 + 3.*theta1.*theta3.*theta6.^2.*thetaDot6, theta1.*theta5.^3.*thetaDot4 + theta4.*theta5.^3.*thetaDot1 + 3.*theta1.*theta4.*theta5.^2.*thetaDot5, theta1.*theta6.^2.*thetaDot4 + theta4.*theta6.^2.*thetaDot1 + 2.*theta1.*theta4.*theta6.*thetaDot6, theta1.*theta3.^3.*thetaDot6 + theta3.^3.*theta6.*thetaDot1 + 3.*theta1.*theta3.^2.*theta6.*thetaDot3, theta1.*theta4.^2.*thetaDot6 + theta4.^2.*theta6.*thetaDot1 + 2.*theta1.*theta4.*theta6.*thetaDot4, theta1.*theta4.^3.*thetaDot5 + theta4.^3.*theta5.*thetaDot1 + 3.*theta1.*theta4.^2.*theta5.*thetaDot4, theta2.*theta5.^3.*thetaDot3 + theta3.*theta5.^3.*thetaDot2 + 3.*theta2.*theta3.*theta5.^2.*thetaDot5, theta2.*theta6.^2.*thetaDot3 + theta3.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta6.*thetaDot6, theta2.*theta5.^2.*thetaDot4 + theta4.*theta5.^2.*thetaDot2 + 2.*theta2.*theta4.*theta5.*thetaDot5, theta2.*theta3.^2.*thetaDot6 + theta3.^2.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta6.*thetaDot3, theta2.*theta3.^3.*thetaDot5 + theta3.^3.*theta5.*thetaDot2 + 3.*theta2.*theta3.^2.*theta5.*thetaDot3, theta2.*theta4.^2.*thetaDot5 + theta4.^2.*theta5.*thetaDot2 + 2.*theta2.*theta4.*theta5.*thetaDot4, theta1.^2.*theta4.*thetaDot6 + theta1.^2.*theta6.*thetaDot4 + 2.*theta1.*theta4.*theta6.*thetaDot1, theta1.^3.*theta3.*thetaDot6 + theta1.^3.*theta6.*thetaDot3 + 3.*theta1.^2.*theta3.*theta6.*thetaDot1, theta1.^3.*theta4.*thetaDot5 + theta1.^3.*theta5.*thetaDot4 + 3.*theta1.^2.*theta4.*theta5.*thetaDot1, theta2.^2.*theta3.*thetaDot6 + theta2.^2.*theta6.*thetaDot3 + 2.*theta2.*theta3.*theta6.*thetaDot2, theta2.^2.*theta4.*thetaDot5 + theta2.^2.*theta5.*thetaDot4 + 2.*theta2.*theta4.*theta5.*thetaDot2, theta2.^3.*theta3.*thetaDot5 + theta2.^3.*theta5.*thetaDot3 + 3.*theta2.^2.*theta3.*theta5.*thetaDot2, theta1.*theta6.^3.*thetaDot4 + theta4.*theta6.^3.*thetaDot1 + 3.*theta1.*theta4.*theta6.^2.*thetaDot6, theta1.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta5.*theta6.*thetaDot6, theta1.*theta4.^3.*thetaDot6 + theta4.^3.*theta6.*thetaDot1 + 3.*theta1.*theta4.^2.*theta6.*thetaDot4, theta1.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta5.*theta6.*thetaDot5, theta2.*theta6.^3.*thetaDot3 + theta3.*theta6.^3.*thetaDot2 + 3.*theta2.*theta3.*theta6.^2.*thetaDot6, theta2.*theta5.^3.*thetaDot4 + theta4.*theta5.^3.*thetaDot2 + 3.*theta2.*theta4.*theta5.^2.*thetaDot5, theta2.*theta6.^2.*thetaDot4 + theta4.*theta6.^2.*thetaDot2 + 2.*theta2.*theta4.*theta6.*thetaDot6, theta2.*theta3.^3.*thetaDot6 + theta3.^3.*theta6.*thetaDot2 + 3.*theta2.*theta3.^2.*theta6.*thetaDot3, theta2.*theta4.^2.*thetaDot6 + theta4.^2.*theta6.*thetaDot2 + 2.*theta2.*theta4.*theta6.*thetaDot4, theta2.*theta4.^3.*thetaDot5 + theta4.^3.*theta5.*thetaDot2 + 3.*theta2.*theta4.^2.*theta5.*thetaDot4, theta3.*theta5.^2.*thetaDot4 + theta4.*theta5.^2.*thetaDot3 + 2.*theta3.*theta4.*theta5.*thetaDot5, theta3.*theta4.^2.*thetaDot5 + theta4.^2.*theta5.*thetaDot3 + 2.*theta3.*theta4.*theta5.*thetaDot4, theta1.^2.*theta5.*thetaDot6 + theta1.^2.*theta6.*thetaDot5 + 2.*theta1.*theta5.*theta6.*thetaDot1, theta1.^3.*theta4.*thetaDot6 + theta1.^3.*theta6.*thetaDot4 + 3.*theta1.^2.*theta4.*theta6.*thetaDot1, theta2.^2.*theta4.*thetaDot6 + theta2.^2.*theta6.*thetaDot4 + 2.*theta2.*theta4.*theta6.*thetaDot2, theta2.^3.*theta3.*thetaDot6 + theta2.^3.*theta6.*thetaDot3 + 3.*theta2.^2.*theta3.*theta6.*thetaDot2, theta2.^3.*theta4.*thetaDot5 + theta2.^3.*theta5.*thetaDot4 + 3.*theta2.^2.*theta4.*theta5.*thetaDot2, theta3.^2.*theta4.*thetaDot5 + theta3.^2.*theta5.*thetaDot4 + 2.*theta3.*theta4.*theta5.*thetaDot3, theta1.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot1 + 3.*theta1.*theta5.*theta6.^2.*thetaDot6, theta1.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot1 + 3.*theta1.*theta5.^2.*theta6.*thetaDot5, theta2.*theta6.^3.*thetaDot4 + theta4.*theta6.^3.*thetaDot2 + 3.*theta2.*theta4.*theta6.^2.*thetaDot6, theta2.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot2 + 2.*theta2.*theta5.*theta6.*thetaDot6, theta2.*theta4.^3.*thetaDot6 + theta4.^3.*theta6.*thetaDot2 + 3.*theta2.*theta4.^2.*theta6.*thetaDot4, theta2.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot2 + 2.*theta2.*theta5.*theta6.*thetaDot5, theta3.*theta5.^3.*thetaDot4 + theta4.*theta5.^3.*thetaDot3 + 3.*theta3.*theta4.*theta5.^2.*thetaDot5, theta3.*theta6.^2.*thetaDot4 + theta4.*theta6.^2.*thetaDot3 + 2.*theta3.*theta4.*theta6.*thetaDot6, theta3.*theta4.^2.*thetaDot6 + theta4.^2.*theta6.*thetaDot3 + 2.*theta3.*theta4.*theta6.*thetaDot4, theta3.*theta4.^3.*thetaDot5 + theta4.^3.*theta5.*thetaDot3 + 3.*theta3.*theta4.^2.*theta5.*thetaDot4, theta1.^3.*theta5.*thetaDot6 + theta1.^3.*theta6.*thetaDot5 + 3.*theta1.^2.*theta5.*theta6.*thetaDot1, theta2.^2.*theta5.*thetaDot6 + theta2.^2.*theta6.*thetaDot5 + 2.*theta2.*theta5.*theta6.*thetaDot2, theta2.^3.*theta4.*thetaDot6 + theta2.^3.*theta6.*thetaDot4 + 3.*theta2.^2.*theta4.*theta6.*thetaDot2, theta3.^2.*theta4.*thetaDot6 + theta3.^2.*theta6.*thetaDot4 + 2.*theta3.*theta4.*theta6.*thetaDot3, theta3.^3.*theta4.*thetaDot5 + theta3.^3.*theta5.*thetaDot4 + 3.*theta3.^2.*theta4.*theta5.*thetaDot3, theta2.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot2 + 3.*theta2.*theta5.*theta6.^2.*thetaDot6, theta2.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot2 + 3.*theta2.*theta5.^2.*theta6.*thetaDot5, theta3.*theta6.^3.*thetaDot4 + theta4.*theta6.^3.*thetaDot3 + 3.*theta3.*theta4.*theta6.^2.*thetaDot6, theta3.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot3 + 2.*theta3.*theta5.*theta6.*thetaDot6, theta3.*theta4.^3.*thetaDot6 + theta4.^3.*theta6.*thetaDot3 + 3.*theta3.*theta4.^2.*theta6.*thetaDot4, theta3.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot3 + 2.*theta3.*theta5.*theta6.*thetaDot5, theta2.^3.*theta5.*thetaDot6 + theta2.^3.*theta6.*thetaDot5 + 3.*theta2.^2.*theta5.*theta6.*thetaDot2, theta3.^2.*theta5.*thetaDot6 + theta3.^2.*theta6.*thetaDot5 + 2.*theta3.*theta5.*theta6.*thetaDot3, theta3.^3.*theta4.*thetaDot6 + theta3.^3.*theta6.*thetaDot4 + 3.*theta3.^2.*theta4.*theta6.*thetaDot3, theta3.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot3 + 3.*theta3.*theta5.*theta6.^2.*thetaDot6, theta3.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot3 + 3.*theta3.*theta5.^2.*theta6.*thetaDot5, theta4.*theta6.^2.*thetaDot5 + theta5.*theta6.^2.*thetaDot4 + 2.*theta4.*theta5.*theta6.*thetaDot6, theta4.*theta5.^2.*thetaDot6 + theta5.^2.*theta6.*thetaDot4 + 2.*theta4.*theta5.*theta6.*thetaDot5, theta3.^3.*theta5.*thetaDot6 + theta3.^3.*theta6.*thetaDot5 + 3.*theta3.^2.*theta5.*theta6.*thetaDot3, theta4.^2.*theta5.*thetaDot6 + theta4.^2.*theta6.*thetaDot5 + 2.*theta4.*theta5.*theta6.*thetaDot4, theta4.*theta6.^3.*thetaDot5 + theta5.*theta6.^3.*thetaDot4 + 3.*theta4.*theta5.*theta6.^2.*thetaDot6, theta4.*theta5.^3.*thetaDot6 + theta5.^3.*theta6.*thetaDot4 + 3.*theta4.*theta5.^2.*theta6.*thetaDot5, theta4.^3.*theta5.*thetaDot6 + theta4.^3.*theta6.*thetaDot5 + 3.*theta4.^2.*theta5.*theta6.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta2.^2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta5.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta5.*thetaDot5, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta5.^2.*thetaDot2 + 2.*theta1.*theta2.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta5.*thetaDot5, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot5 + 2.*theta1.*theta2.^2.*theta5.*thetaDot1 + 2.*theta1.^2.*theta2.*theta5.*thetaDot2, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta2.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta6.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta6.*thetaDot6, theta3.^2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta3.*theta5.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta5.*thetaDot5, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta6.^2.*thetaDot2 + 2.*theta1.*theta2.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta6.*thetaDot6, theta1.^2.*theta5.^2.*thetaDot3 + 2.*theta1.*theta3.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta5.*thetaDot5, theta1.^2.*theta2.^2.*thetaDot6 + 2.*theta1.*theta2.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta2.*theta6.*thetaDot2, theta1.^2.*theta3.^2.*thetaDot5 + 2.*theta1.*theta3.^2.*theta5.*thetaDot1 + 2.*theta1.^2.*theta3.*theta5.*thetaDot3, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta6.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot1 + 2.*theta1.*theta4.*theta5.^2.*thetaDot4 + 2.*theta1.*theta4.^2.*theta5.*thetaDot5, theta3.^2.*theta5.^2.*thetaDot2 + 2.*theta2.*theta3.*theta5.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta5.*thetaDot5, theta1.^2.*theta6.^2.*thetaDot3 + 2.*theta1.*theta3.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta6.*thetaDot6, theta1.^2.*theta5.^2.*thetaDot4 + 2.*theta1.*theta4.*theta5.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*theta5.*thetaDot5, theta1.^2.*theta3.^2.*thetaDot6 + 2.*theta1.*theta3.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta3.*theta6.*thetaDot3, theta1.^2.*theta4.^2.*thetaDot5 + 2.*theta1.*theta4.^2.*theta5.*thetaDot1 + 2.*theta1.^2.*theta4.*theta5.*thetaDot4, theta2.^2.*theta5.^2.*thetaDot3 + 2.*theta2.*theta3.*theta5.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta5.*thetaDot5, theta2.^2.*theta3.^2.*thetaDot5 + 2.*theta2.*theta3.^2.*theta5.*thetaDot2 + 2.*theta2.^2.*theta3.*theta5.*thetaDot3, theta4.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta4.*theta6.^2.*thetaDot4 + 2.*theta1.*theta4.^2.*theta6.*thetaDot6, theta3.^2.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta6.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot2 + 2.*theta2.*theta4.*theta5.^2.*thetaDot4 + 2.*theta2.*theta4.^2.*theta5.*thetaDot5, theta1.^2.*theta6.^2.*thetaDot4 + 2.*theta1.*theta4.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*theta6.*thetaDot6, theta1.^2.*theta4.^2.*thetaDot6 + 2.*theta1.*theta4.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta4.*theta6.*thetaDot4, theta2.^2.*theta6.^2.*thetaDot3 + 2.*theta2.*theta3.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta6.*thetaDot6, theta2.^2.*theta5.^2.*thetaDot4 + 2.*theta2.*theta4.*theta5.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*theta5.*thetaDot5, theta2.^2.*theta3.^2.*thetaDot6 + 2.*theta2.*theta3.^2.*theta6.*thetaDot2 + 2.*theta2.^2.*theta3.*theta6.*thetaDot3, theta2.^2.*theta4.^2.*thetaDot5 + 2.*theta2.*theta4.^2.*theta5.*thetaDot2 + 2.*theta2.^2.*theta4.*theta5.*thetaDot4, theta5.^2.*theta6.^2.*thetaDot1 + 2.*theta1.*theta5.*theta6.^2.*thetaDot5 + 2.*theta1.*theta5.^2.*theta6.*thetaDot6, theta4.^2.*theta6.^2.*thetaDot2 + 2.*theta2.*theta4.*theta6.^2.*thetaDot4 + 2.*theta2.*theta4.^2.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot3 + 2.*theta3.*theta4.*theta5.^2.*thetaDot4 + 2.*theta3.*theta4.^2.*theta5.*thetaDot5, theta1.^2.*theta6.^2.*thetaDot5 + 2.*theta1.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.^2.*theta5.*theta6.*thetaDot6, theta1.^2.*theta5.^2.*thetaDot6 + 2.*theta1.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.^2.*theta5.*theta6.*thetaDot5, theta2.^2.*theta6.^2.*thetaDot4 + 2.*theta2.*theta4.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*theta6.*thetaDot6, theta2.^2.*theta4.^2.*thetaDot6 + 2.*theta2.*theta4.^2.*theta6.*thetaDot2 + 2.*theta2.^2.*theta4.*theta6.*thetaDot4, theta3.^2.*theta5.^2.*thetaDot4 + 2.*theta3.*theta4.*theta5.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*theta5.*thetaDot5, theta3.^2.*theta4.^2.*thetaDot5 + 2.*theta3.*theta4.^2.*theta5.*thetaDot3 + 2.*theta3.^2.*theta4.*theta5.*thetaDot4, theta5.^2.*theta6.^2.*thetaDot2 + 2.*theta2.*theta5.*theta6.^2.*thetaDot5 + 2.*theta2.*theta5.^2.*theta6.*thetaDot6, theta4.^2.*theta6.^2.*thetaDot3 + 2.*theta3.*theta4.*theta6.^2.*thetaDot4 + 2.*theta3.*theta4.^2.*theta6.*thetaDot6, theta2.^2.*theta6.^2.*thetaDot5 + 2.*theta2.*theta5.*theta6.^2.*thetaDot2 + 2.*theta2.^2.*theta5.*theta6.*thetaDot6, theta2.^2.*theta5.^2.*thetaDot6 + 2.*theta2.*theta5.^2.*theta6.*thetaDot2 + 2.*theta2.^2.*theta5.*theta6.*thetaDot5, theta3.^2.*theta6.^2.*thetaDot4 + 2.*theta3.*theta4.*theta6.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*theta6.*thetaDot6, theta3.^2.*theta4.^2.*thetaDot6 + 2.*theta3.*theta4.^2.*theta6.*thetaDot3 + 2.*theta3.^2.*theta4.*theta6.*thetaDot4, theta5.^2.*theta6.^2.*thetaDot3 + 2.*theta3.*theta5.*theta6.^2.*thetaDot5 + 2.*theta3.*theta5.^2.*theta6.*thetaDot6, theta3.^2.*theta6.^2.*thetaDot5 + 2.*theta3.*theta5.*theta6.^2.*thetaDot3 + 2.*theta3.^2.*theta5.*theta6.*thetaDot6, theta3.^2.*theta5.^2.*thetaDot6 + 2.*theta3.*theta5.^2.*theta6.*thetaDot3 + 2.*theta3.^2.*theta5.*theta6.*thetaDot5, theta5.^2.*theta6.^2.*thetaDot4 + 2.*theta4.*theta5.*theta6.^2.*thetaDot5 + 2.*theta4.*theta5.^2.*theta6.*thetaDot6, theta4.^2.*theta6.^2.*thetaDot5 + 2.*theta4.*theta5.*theta6.^2.*thetaDot4 + 2.*theta4.^2.*theta5.*theta6.*thetaDot6, theta4.^2.*theta5.^2.*thetaDot6 + 2.*theta4.*theta5.^2.*theta6.*thetaDot4 + 2.*theta4.^2.*theta5.*theta6.*thetaDot5, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta2.*thetaDot5 + theta1.*theta5.*thetaDot2 + theta2.*theta5.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta1.*theta2.*thetaDot6 + theta1.*theta6.*thetaDot2 + theta2.*theta6.*thetaDot1, theta1.*theta3.*thetaDot5 + theta1.*theta5.*thetaDot3 + theta3.*theta5.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta3.*thetaDot6 + theta1.*theta6.*thetaDot3 + theta3.*theta6.*thetaDot1, theta1.*theta4.*thetaDot5 + theta1.*theta5.*thetaDot4 + theta4.*theta5.*thetaDot1, theta2.*theta3.*thetaDot5 + theta2.*theta5.*thetaDot3 + theta3.*theta5.*thetaDot2, theta1.*theta4.*thetaDot6 + theta1.*theta6.*thetaDot4 + theta4.*theta6.*thetaDot1, theta2.*theta3.*thetaDot6 + theta2.*theta6.*thetaDot3 + theta3.*theta6.*thetaDot2, theta2.*theta4.*thetaDot5 + theta2.*theta5.*thetaDot4 + theta4.*theta5.*thetaDot2, theta1.*theta5.*thetaDot6 + theta1.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot1, theta2.*theta4.*thetaDot6 + theta2.*theta6.*thetaDot4 + theta4.*theta6.*thetaDot2, theta3.*theta4.*thetaDot5 + theta3.*theta5.*thetaDot4 + theta4.*theta5.*thetaDot3, theta2.*theta5.*thetaDot6 + theta2.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot2, theta3.*theta4.*thetaDot6 + theta3.*theta6.*thetaDot4 + theta4.*theta6.*thetaDot3, theta3.*theta5.*thetaDot6 + theta3.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot3, theta4.*theta5.*thetaDot6 + theta4.*theta6.*thetaDot5 + theta5.*theta6.*thetaDot4, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta3.*thetaDot5 + theta1.*theta2.*theta5.*thetaDot3 + theta1.*theta3.*theta5.*thetaDot2 + theta2.*theta3.*theta5.*thetaDot1, theta1.*theta2.*theta3.*thetaDot6 + theta1.*theta2.*theta6.*thetaDot3 + theta1.*theta3.*theta6.*thetaDot2 + theta2.*theta3.*theta6.*thetaDot1, theta1.*theta2.*theta4.*thetaDot5 + theta1.*theta2.*theta5.*thetaDot4 + theta1.*theta4.*theta5.*thetaDot2 + theta2.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta4.*thetaDot6 + theta1.*theta2.*theta6.*thetaDot4 + theta1.*theta4.*theta6.*thetaDot2 + theta2.*theta4.*theta6.*thetaDot1, theta1.*theta3.*theta4.*thetaDot5 + theta1.*theta3.*theta5.*thetaDot4 + theta1.*theta4.*theta5.*thetaDot3 + theta3.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta5.*thetaDot6 + theta1.*theta2.*theta6.*thetaDot5 + theta1.*theta5.*theta6.*thetaDot2 + theta2.*theta5.*theta6.*thetaDot1, theta1.*theta3.*theta4.*thetaDot6 + theta1.*theta3.*theta6.*thetaDot4 + theta1.*theta4.*theta6.*thetaDot3 + theta3.*theta4.*theta6.*thetaDot1, theta2.*theta3.*theta4.*thetaDot5 + theta2.*theta3.*theta5.*thetaDot4 + theta2.*theta4.*theta5.*thetaDot3 + theta3.*theta4.*theta5.*thetaDot2, theta1.*theta3.*theta5.*thetaDot6 + theta1.*theta3.*theta6.*thetaDot5 + theta1.*theta5.*theta6.*thetaDot3 + theta3.*theta5.*theta6.*thetaDot1, theta2.*theta3.*theta4.*thetaDot6 + theta2.*theta3.*theta6.*thetaDot4 + theta2.*theta4.*theta6.*thetaDot3 + theta3.*theta4.*theta6.*thetaDot2, theta1.*theta4.*theta5.*thetaDot6 + theta1.*theta4.*theta6.*thetaDot5 + theta1.*theta5.*theta6.*thetaDot4 + theta4.*theta5.*theta6.*thetaDot1, theta2.*theta3.*theta5.*thetaDot6 + theta2.*theta3.*theta6.*thetaDot5 + theta2.*theta5.*theta6.*thetaDot3 + theta3.*theta5.*theta6.*thetaDot2, theta2.*theta4.*theta5.*thetaDot6 + theta2.*theta4.*theta6.*thetaDot5 + theta2.*theta5.*theta6.*thetaDot4 + theta4.*theta5.*theta6.*thetaDot2, theta3.*theta4.*theta5.*thetaDot6 + theta3.*theta4.*theta6.*thetaDot5 + theta3.*theta5.*theta6.*thetaDot4 + theta4.*theta5.*theta6.*thetaDot3, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta5.^2.*thetaDot3 + theta1.*theta3.*theta5.^2.*thetaDot2 + theta2.*theta3.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot5, theta1.*theta2.*theta3.^2.*thetaDot5 + theta1.*theta3.^2.*theta5.*thetaDot2 + theta2.*theta3.^2.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot5 + theta1.*theta2.^2.*theta5.*thetaDot3 + theta2.^2.*theta3.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot5 + theta1.^2.*theta2.*theta5.*thetaDot3 + theta1.^2.*theta3.*theta5.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta5.*thetaDot1, theta1.*theta2.*theta6.^2.*thetaDot3 + theta1.*theta3.*theta6.^2.*thetaDot2 + theta2.*theta3.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot6, theta1.*theta2.*theta5.^2.*thetaDot4 + theta1.*theta4.*theta5.^2.*thetaDot2 + theta2.*theta4.*theta5.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot5, theta1.*theta2.*theta3.^2.*thetaDot6 + theta1.*theta3.^2.*theta6.*thetaDot2 + theta2.*theta3.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot3, theta1.*theta2.*theta4.^2.*thetaDot5 + theta1.*theta4.^2.*theta5.*thetaDot2 + theta2.*theta4.^2.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot4, theta1.*theta2.^2.*theta3.*thetaDot6 + theta1.*theta2.^2.*theta6.*thetaDot3 + theta2.^2.*theta3.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot2, theta1.*theta2.^2.*theta4.*thetaDot5 + theta1.*theta2.^2.*theta5.*thetaDot4 + theta2.^2.*theta4.*theta5.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot6 + theta1.^2.*theta2.*theta6.*thetaDot3 + theta1.^2.*theta3.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta6.*thetaDot1, theta1.^2.*theta2.*theta4.*thetaDot5 + theta1.^2.*theta2.*theta5.*thetaDot4 + theta1.^2.*theta4.*theta5.*thetaDot2 + 2.*theta1.*theta2.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta6.^2.*thetaDot4 + theta1.*theta4.*theta6.^2.*thetaDot2 + theta2.*theta4.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot6, theta1.*theta2.*theta4.^2.*thetaDot6 + theta1.*theta4.^2.*theta6.*thetaDot2 + theta2.*theta4.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot4, theta1.*theta3.*theta5.^2.*thetaDot4 + theta1.*theta4.*theta5.^2.*thetaDot3 + theta3.*theta4.*theta5.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot5, theta1.*theta3.*theta4.^2.*thetaDot5 + theta1.*theta4.^2.*theta5.*thetaDot3 + theta3.*theta4.^2.*theta5.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot4, theta1.*theta2.^2.*theta4.*thetaDot6 + theta1.*theta2.^2.*theta6.*thetaDot4 + theta2.^2.*theta4.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot2, theta1.*theta3.^2.*theta4.*thetaDot5 + theta1.*theta3.^2.*theta5.*thetaDot4 + theta3.^2.*theta4.*theta5.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot3, theta1.^2.*theta2.*theta4.*thetaDot6 + theta1.^2.*theta2.*theta6.*thetaDot4 + theta1.^2.*theta4.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta4.*theta6.*thetaDot1, theta1.^2.*theta3.*theta4.*thetaDot5 + theta1.^2.*theta3.*theta5.*thetaDot4 + theta1.^2.*theta4.*theta5.*thetaDot3 + 2.*theta1.*theta3.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta6.^2.*thetaDot5 + theta1.*theta5.*theta6.^2.*thetaDot2 + theta2.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot6, theta1.*theta2.*theta5.^2.*thetaDot6 + theta1.*theta5.^2.*theta6.*thetaDot2 + theta2.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot5, theta1.*theta3.*theta6.^2.*thetaDot4 + theta1.*theta4.*theta6.^2.*thetaDot3 + theta3.*theta4.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot6, theta1.*theta3.*theta4.^2.*thetaDot6 + theta1.*theta4.^2.*theta6.*thetaDot3 + theta3.*theta4.^2.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot4, theta1.*theta2.^2.*theta5.*thetaDot6 + theta1.*theta2.^2.*theta6.*thetaDot5 + theta2.^2.*theta5.*theta6.*thetaDot1 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot2, theta1.*theta3.^2.*theta4.*thetaDot6 + theta1.*theta3.^2.*theta6.*thetaDot4 + theta3.^2.*theta4.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot3, theta2.*theta3.*theta5.^2.*thetaDot4 + theta2.*theta4.*theta5.^2.*thetaDot3 + theta3.*theta4.*theta5.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot5, theta2.*theta3.*theta4.^2.*thetaDot5 + theta2.*theta4.^2.*theta5.*thetaDot3 + theta3.*theta4.^2.*theta5.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot4, theta2.*theta3.^2.*theta4.*thetaDot5 + theta2.*theta3.^2.*theta5.*thetaDot4 + theta3.^2.*theta4.*theta5.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot3, theta1.^2.*theta2.*theta5.*thetaDot6 + theta1.^2.*theta2.*theta6.*thetaDot5 + theta1.^2.*theta5.*theta6.*thetaDot2 + 2.*theta1.*theta2.*theta5.*theta6.*thetaDot1, theta1.^2.*theta3.*theta4.*thetaDot6 + theta1.^2.*theta3.*theta6.*thetaDot4 + theta1.^2.*theta4.*theta6.*thetaDot3 + 2.*theta1.*theta3.*theta4.*theta6.*thetaDot1, theta2.^2.*theta3.*theta4.*thetaDot5 + theta2.^2.*theta3.*theta5.*thetaDot4 + theta2.^2.*theta4.*theta5.*thetaDot3 + 2.*theta2.*theta3.*theta4.*theta5.*thetaDot2, theta1.*theta3.*theta6.^2.*thetaDot5 + theta1.*theta5.*theta6.^2.*thetaDot3 + theta3.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot6, theta1.*theta3.*theta5.^2.*thetaDot6 + theta1.*theta5.^2.*theta6.*thetaDot3 + theta3.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot5, theta1.*theta3.^2.*theta5.*thetaDot6 + theta1.*theta3.^2.*theta6.*thetaDot5 + theta3.^2.*theta5.*theta6.*thetaDot1 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot3, theta2.*theta3.*theta6.^2.*thetaDot4 + theta2.*theta4.*theta6.^2.*thetaDot3 + theta3.*theta4.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot6, theta2.*theta3.*theta4.^2.*thetaDot6 + theta2.*theta4.^2.*theta6.*thetaDot3 + theta3.*theta4.^2.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot4, theta2.*theta3.^2.*theta4.*thetaDot6 + theta2.*theta3.^2.*theta6.*thetaDot4 + theta3.^2.*theta4.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot3, theta1.^2.*theta3.*theta5.*thetaDot6 + theta1.^2.*theta3.*theta6.*thetaDot5 + theta1.^2.*theta5.*theta6.*thetaDot3 + 2.*theta1.*theta3.*theta5.*theta6.*thetaDot1, theta2.^2.*theta3.*theta4.*thetaDot6 + theta2.^2.*theta3.*theta6.*thetaDot4 + theta2.^2.*theta4.*theta6.*thetaDot3 + 2.*theta2.*theta3.*theta4.*theta6.*thetaDot2, theta1.*theta4.*theta6.^2.*thetaDot5 + theta1.*theta5.*theta6.^2.*thetaDot4 + theta4.*theta5.*theta6.^2.*thetaDot1 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot6, theta1.*theta4.*theta5.^2.*thetaDot6 + theta1.*theta5.^2.*theta6.*thetaDot4 + theta4.*theta5.^2.*theta6.*thetaDot1 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot5, theta1.*theta4.^2.*theta5.*thetaDot6 + theta1.*theta4.^2.*theta6.*thetaDot5 + theta4.^2.*theta5.*theta6.*thetaDot1 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot4, theta2.*theta3.*theta6.^2.*thetaDot5 + theta2.*theta5.*theta6.^2.*thetaDot3 + theta3.*theta5.*theta6.^2.*thetaDot2 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot6, theta2.*theta3.*theta5.^2.*thetaDot6 + theta2.*theta5.^2.*theta6.*thetaDot3 + theta3.*theta5.^2.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot5, theta2.*theta3.^2.*theta5.*thetaDot6 + theta2.*theta3.^2.*theta6.*thetaDot5 + theta3.^2.*theta5.*theta6.*thetaDot2 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot3, theta1.^2.*theta4.*theta5.*thetaDot6 + theta1.^2.*theta4.*theta6.*thetaDot5 + theta1.^2.*theta5.*theta6.*thetaDot4 + 2.*theta1.*theta4.*theta5.*theta6.*thetaDot1, theta2.^2.*theta3.*theta5.*thetaDot6 + theta2.^2.*theta3.*theta6.*thetaDot5 + theta2.^2.*theta5.*theta6.*thetaDot3 + 2.*theta2.*theta3.*theta5.*theta6.*thetaDot2, theta2.*theta4.*theta6.^2.*thetaDot5 + theta2.*theta5.*theta6.^2.*thetaDot4 + theta4.*theta5.*theta6.^2.*thetaDot2 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot6, theta2.*theta4.*theta5.^2.*thetaDot6 + theta2.*theta5.^2.*theta6.*thetaDot4 + theta4.*theta5.^2.*theta6.*thetaDot2 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot5, theta2.*theta4.^2.*theta5.*thetaDot6 + theta2.*theta4.^2.*theta6.*thetaDot5 + theta4.^2.*theta5.*theta6.*thetaDot2 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot4, theta2.^2.*theta4.*theta5.*thetaDot6 + theta2.^2.*theta4.*theta6.*thetaDot5 + theta2.^2.*theta5.*theta6.*thetaDot4 + 2.*theta2.*theta4.*theta5.*theta6.*thetaDot2, theta3.*theta4.*theta6.^2.*thetaDot5 + theta3.*theta5.*theta6.^2.*thetaDot4 + theta4.*theta5.*theta6.^2.*thetaDot3 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot6, theta3.*theta4.*theta5.^2.*thetaDot6 + theta3.*theta5.^2.*theta6.*thetaDot4 + theta4.*theta5.^2.*theta6.*thetaDot3 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot5, theta3.*theta4.^2.*theta5.*thetaDot6 + theta3.*theta4.^2.*theta6.*thetaDot5 + theta4.^2.*theta5.*theta6.*thetaDot3 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot4, theta3.^2.*theta4.*theta5.*thetaDot6 + theta3.^2.*theta4.*theta6.*thetaDot5 + theta3.^2.*theta5.*theta6.*thetaDot4 + 2.*theta3.*theta4.*theta5.*theta6.*thetaDot3, theta1.*theta2.*theta3.*theta4.*thetaDot5 + theta1.*theta2.*theta3.*theta5.*thetaDot4 + theta1.*theta2.*theta4.*theta5.*thetaDot3 + theta1.*theta3.*theta4.*theta5.*thetaDot2 + theta2.*theta3.*theta4.*theta5.*thetaDot1, theta1.*theta2.*theta3.*theta4.*thetaDot6 + theta1.*theta2.*theta3.*theta6.*thetaDot4 + theta1.*theta2.*theta4.*theta6.*thetaDot3 + theta1.*theta3.*theta4.*theta6.*thetaDot2 + theta2.*theta3.*theta4.*theta6.*thetaDot1, theta1.*theta2.*theta3.*theta5.*thetaDot6 + theta1.*theta2.*theta3.*theta6.*thetaDot5 + theta1.*theta2.*theta5.*theta6.*thetaDot3 + theta1.*theta3.*theta5.*theta6.*thetaDot2 + theta2.*theta3.*theta5.*theta6.*thetaDot1, theta1.*theta2.*theta4.*theta5.*thetaDot6 + theta1.*theta2.*theta4.*theta6.*thetaDot5 + theta1.*theta2.*theta5.*theta6.*thetaDot4 + theta1.*theta4.*theta5.*theta6.*thetaDot2 + theta2.*theta4.*theta5.*theta6.*thetaDot1, theta1.*theta3.*theta4.*theta5.*thetaDot6 + theta1.*theta3.*theta4.*theta6.*thetaDot5 + theta1.*theta3.*theta5.*theta6.*thetaDot4 + theta1.*theta4.*theta5.*theta6.*thetaDot3 + theta3.*theta4.*theta5.*theta6.*thetaDot1, theta2.*theta3.*theta4.*theta5.*thetaDot6 + theta2.*theta3.*theta4.*theta6.*thetaDot5 + theta2.*theta3.*theta5.*theta6.*thetaDot4 + theta2.*theta4.*theta5.*theta6.*thetaDot3 + theta3.*theta4.*theta5.*theta6.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -2.*theta1.*theta5.^2, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.^3, -2.*theta1.*theta6.^2, -3.*theta1.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6.^3, -3.*theta1.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta5, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, -3.*theta1.^2.*theta5, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6, zeroCol, -4.*theta1.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta2.*theta5.^2, -theta3.*theta4.^2, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta2.*theta5, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta2.*theta5.^3, -theta2.*theta6.^2, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^2.*theta6, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -2.*theta1.*theta3.*theta5, -3.*theta1.^2.*theta2.*theta5, -3.*theta1.^2.*theta3.*theta4, zeroCol, -theta2.*theta6.^3, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -2.*theta1.*theta4.*theta5, -3.*theta1.^2.*theta2.*theta6, -3.*theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.^2.*theta3.*theta6, -3.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6, -3.*theta1.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta2.^2.*theta5.^2, -theta3.^2.*theta4.^2, -2.*theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta2.^2.*theta5, -2.*theta1.*theta3.^2.*theta4, -theta2.^2.*theta6.^2, -theta3.^2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta6.^2, -2.*theta1.*theta3.*theta5.^2, -2.*theta1.*theta2.^2.*theta6, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, -2.*theta1.*theta3.*theta6.^2, -2.*theta1.*theta4.*theta5.^2, -2.*theta1.*theta3.^2.*theta6, -2.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6.^2, -2.*theta1.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta2.*theta5, -theta3.*theta4, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta5, -theta2.*theta3.*theta6, -theta2.*theta4.*theta5, -theta2.*theta4.*theta6, -theta3.*theta4.*theta5, -theta2.*theta5.*theta6, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta2.*theta3.*theta6.^2, -theta2.*theta4.*theta5.^2, -theta2.*theta3.^2.*theta6, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta3.*theta6, -theta2.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta6, -theta3.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta4.*theta6, -2.*theta1.*theta3.*theta4.*theta5, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta2.^2.*theta5.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.*theta6, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.^3, -2.*theta2.*theta5.^2, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.^3, -2.*theta2.*theta6.^2, -3.*theta2.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6.^3, -3.*theta2.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, -3.*theta2.^2.*theta5, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6, zeroCol, -4.*theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta5, -3.*theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -3.*theta1.*theta2.^2.*theta5, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -2.*theta2.*theta3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -2.*theta2.*theta3.*theta5, -3.*theta2.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, -2.*theta2.*theta4.*theta5, -3.*theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.^2.*theta3.*theta6, -3.*theta2.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta2.^2.*theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, -2.*theta1.*theta2.*theta5.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -2.*theta1.*theta2.*theta6.^2, zeroCol, -theta3.^2.*theta4.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, -theta3.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.^2.*theta5, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6.^2, -2.*theta2.*theta4.*theta5.^2, -2.*theta2.*theta3.^2.*theta6, -2.*theta2.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.^2.*theta6, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6.^2, -2.*theta2.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3, -theta1.*theta4, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta3.*theta4, zeroCol, zeroCol, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta3.*theta5, -theta1.*theta3.*theta6, -theta1.*theta4.*theta5, -theta1.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5, zeroCol, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, -theta4.*theta5.*theta6, zeroCol, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta1.^2.*theta3.*theta5, -theta1.*theta3.*theta6.^2, -theta1.*theta4.*theta5.^2, -theta1.*theta3.^2.*theta6, -theta1.*theta4.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta1.^2.*theta3.*theta6, -theta1.^2.*theta4.*theta5, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, zeroCol, -theta1.^2.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, -theta1.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta5.*theta6, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta2.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta5.*theta6, -theta1.*theta4.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.*theta6, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^3, -2.*theta3.*theta5.^2, -3.*theta3.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta5.^3, -2.*theta3.*theta6.^2, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.*theta6.^3, -3.*theta3.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, -theta2, zeroCol, zeroCol, zeroCol, zeroCol, -theta4, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta3.^3, zeroCol, zeroCol, -theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, -3.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -3.*theta3.^2.*theta5, zeroCol, -4.*theta3.^3.*theta4, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta6, zeroCol, -4.*theta3.^3.*theta5, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, -4.*theta3.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta2.^2.*theta4, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -3.*theta1.*theta3.^2.*theta5, zeroCol, -theta2.*theta4.^3, -theta2.*theta5.^2, -2.*theta2.*theta3.*theta5, -3.*theta2.*theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, -3.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta6, -3.*theta2.*theta3.^2.*theta5, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2.*theta6, zeroCol, zeroCol, -theta4.*theta5.^2, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta6, zeroCol, -2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6, -3.*theta3.^2.*theta4.*theta5, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, -2.*theta3.*theta5.*theta6, -3.*theta3.^2.*theta4.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta3.*theta5, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta5.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta5.^2, -2.*theta2.^2.*theta3.*theta5, zeroCol, -2.*theta2.*theta3.*theta6.^2, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta6.^2, zeroCol, -2.*theta2.^2.*theta3.*theta6, zeroCol, zeroCol, zeroCol, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta5.^2, -2.*theta3.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.^2.*theta6, -theta5.^2.*theta6.^2, -2.*theta3.*theta5.*theta6.^2, -2.*theta3.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta4, zeroCol, -theta1.*theta5, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta4.*theta5, zeroCol, -theta4.*theta6, -theta5.*theta6, zeroCol, -theta1.*theta2.*theta4, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta4.*theta5, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta4.*theta5, -theta1.*theta5.*theta6, -theta2.*theta4.*theta6, zeroCol, -theta2.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.^2.*theta5, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -theta1.^2.*theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, -2.*theta1.*theta3.*theta4.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta4.*theta5, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta3.*theta5.*theta6, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -2.*theta2.*theta3.*theta4.*theta6, -theta1.^2.*theta5.*theta6, -theta2.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta3.*theta5.*theta6, zeroCol, -theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta1.*theta2.*theta4.*theta5, -theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta5.*theta6, zeroCol, -theta1.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta4.^2, zeroCol, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta4.^2, zeroCol, -2.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5.^2, zeroCol, zeroCol, -2.*theta4.*theta5.^3, -2.*theta4.*theta6.^2, -3.*theta4.^2.*theta5.^2, -2.*theta4.*theta6.^3, -3.*theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, zeroCol, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, zeroCol, zeroCol, -3.*theta2.*theta4.^2, zeroCol, -2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta4.^3, zeroCol, zeroCol, -3.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, zeroCol, zeroCol, zeroCol, -4.*theta3.*theta4.^3, zeroCol, zeroCol, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5, -theta3.^4, zeroCol, zeroCol, zeroCol, -theta5.^3, -theta6.^2, zeroCol, zeroCol, -2.*theta4.*theta6, zeroCol, -3.*theta4.^2.*theta5, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, -3.*theta4.^2.*theta6, zeroCol, -4.*theta4.^3.*theta5, -theta6.^4, zeroCol, -4.*theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, zeroCol, -4.*theta4.^3, zeroCol, zeroCol, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, -3.*theta1.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5, -3.*theta2.*theta3.*theta4.^2, zeroCol, zeroCol, -theta2.*theta3.^3, zeroCol, -theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta3, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta4.*theta5, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -theta2.^2.*theta5, zeroCol, -theta1.*theta6.^3, zeroCol, -3.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.*theta4.^2.*theta5, -theta3.*theta5.^2, -2.*theta3.*theta4.*theta5, zeroCol, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, -theta3.^2.*theta5, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, -3.*theta2.*theta4.^2.*theta6, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -2.*theta3.*theta4.*theta6, -3.*theta3.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, zeroCol, -3.*theta3.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.^3.*theta6, zeroCol, zeroCol, -theta5.*theta6.^2, -theta5.^2.*theta6, zeroCol, -2.*theta4.*theta5.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, -3.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, zeroCol, -2.*theta1.*theta3.^2.*theta4, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta5.^2, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta4.*theta6, zeroCol, -theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta4.*theta6, -theta3.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta5, zeroCol, -2.*theta3.*theta4.*theta6.^2, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, -2.*theta4.*theta5.*theta6.^2, -2.*theta4.*theta5.^2.*theta6, zeroCol, -theta1.*theta2, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta2.*theta3, zeroCol, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, zeroCol, -theta5.*theta6, -theta1.*theta2.*theta3, zeroCol, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, -theta1.*theta3.*theta5, zeroCol, -theta1.*theta3.*theta6, -theta2.*theta3.*theta5, zeroCol, -theta2.*theta3.*theta6, -theta1.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6, -theta3.*theta5.*theta6, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.^2.*theta5, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta2.^2.*theta6, -theta1.*theta3.^2.*theta5, -theta1.^2.*theta2.*theta6, -theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta1.*theta3.^2.*theta6, -theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.^2.*theta5, zeroCol, -theta1.^2.*theta3.*theta6, -theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.^2.*theta6, zeroCol, -theta2.^2.*theta3.*theta6, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta4.*theta5.*theta6, -theta2.^2.*theta5.*theta6, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta3.^2.*theta5.*theta6, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta5.*theta6, -theta1.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.*theta6, zeroCol,];
        momentArms5 = [ zeroCol, zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^3.*theta5, zeroCol, -2.*theta2.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^3.*theta5, zeroCol, -2.*theta3.^2.*theta5, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.^3.*theta5, -2.*theta4.^2.*theta5, zeroCol, zeroCol, -3.*theta4.^2.*theta5.^2, zeroCol, -2.*theta4.^3.*theta5, zeroCol, zeroCol, -2.*theta5.*theta6.^2, -2.*theta5.*theta6.^3, -3.*theta5.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta5.^3, zeroCol, zeroCol, -3.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta5.^3, zeroCol, zeroCol, -3.*theta3.*theta5.^2, zeroCol, -2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta5.^3, zeroCol, -3.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, zeroCol, -4.*theta4.*theta5.^3, zeroCol, -theta6.^2, zeroCol, zeroCol, -2.*theta5.*theta6, -theta4.^4, zeroCol, -theta6.^3, zeroCol, -3.*theta5.^2.*theta6, -theta6.^4, -4.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta5, zeroCol, zeroCol, -3.*theta5.^2, zeroCol, zeroCol, -4.*theta5.^3, zeroCol, -5.*theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, -3.*theta1.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta5.^2, zeroCol, -2.*theta1.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, -2.*theta2.*theta3.*theta5, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -3.*theta2.*theta3.*theta5.^2, zeroCol, -2.*theta2.*theta4.*theta5, zeroCol, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta5.*theta6, zeroCol, -3.*theta2.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta2.*theta4.^3, -2.*theta3.*theta4.*theta5, -theta3.*theta4.^2, -theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta4, -theta3.^2.*theta4, -theta1.*theta6.^3, -3.*theta1.*theta5.^2.*theta6, zeroCol, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta3.*theta4.^3, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, zeroCol, -theta3.^3.*theta4, -theta2.*theta6.^3, -3.*theta2.*theta5.^2.*theta6, zeroCol, -theta3.*theta6.^2, zeroCol, -2.*theta3.*theta5.*theta6, -theta2.^3.*theta6, -theta3.^2.*theta6, zeroCol, -theta3.*theta6.^3, -3.*theta3.*theta5.^2.*theta6, -theta4.*theta6.^2, -2.*theta4.*theta5.*theta6, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.*theta6.^3, -3.*theta4.*theta5.^2.*theta6, -theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta5, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta5, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.^2.*theta5, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta5, -theta2.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -theta2.^2.*theta4.^2, -2.*theta1.*theta5.*theta6.^2, zeroCol, -2.*theta3.*theta4.^2.*theta5, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.^2.*theta4.*theta5, -theta3.^2.*theta4.^2, -2.*theta2.*theta5.*theta6.^2, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.*theta5.*theta6.^2, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta5.*theta6, -2.*theta4.*theta5.*theta6.^2, -theta4.^2.*theta6.^2, -2.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, zeroCol, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta3.*theta4, -theta2.*theta6, zeroCol, -theta3.*theta6, -theta4.*theta6, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta2.*theta6, zeroCol, -theta2.*theta3.*theta4, -theta1.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta3.*theta6, -theta2.*theta4.*theta6, -theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta4.^2, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.^2, zeroCol, -theta1.*theta3.^2.*theta4, zeroCol, -theta1.^2.*theta3.*theta4, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta2.*theta6, zeroCol, -theta2.^2.*theta3.*theta4, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.^2.*theta6, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.^2.*theta6, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta3.*theta6, -theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.^2.*theta6, -theta2.^2.*theta4.*theta6, -theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, -theta1.*theta2.*theta3.*theta4, zeroCol, -theta1.*theta2.*theta3.*theta6, -theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.*theta6, zeroCol,];
        momentArms6 = [ zeroCol, zeroCol, zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6.^2, -2.*theta1.^3.*theta6, zeroCol, -2.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6.^2, -2.*theta2.^3.*theta6, zeroCol, -2.*theta3.^2.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta6.^2, -2.*theta3.^3.*theta6, zeroCol, -2.*theta4.^2.*theta6, zeroCol, -3.*theta4.^2.*theta6.^2, -2.*theta4.^3.*theta6, -2.*theta5.^2.*theta6, -3.*theta5.^2.*theta6.^2, -2.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, -theta3, zeroCol, -theta4, -theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta6.^3, zeroCol, -3.*theta2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta6.^3, zeroCol, -3.*theta3.*theta6.^2, zeroCol, -2.*theta4.*theta6, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta6.^3, zeroCol, -3.*theta4.*theta6.^2, -2.*theta5.*theta6, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, -4.*theta4.*theta6.^3, -3.*theta5.*theta6.^2, -theta4.^4, -theta5.^3, -4.*theta5.*theta6.^3, -theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta6, zeroCol, zeroCol, -3.*theta6.^2, zeroCol, -4.*theta6.^3, -5.*theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta3.*theta6, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, zeroCol, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, -theta1.^3.*theta3, zeroCol, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta5.*theta6, -theta1.*theta4.^3, -theta1.*theta5.^2, -3.*theta2.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, zeroCol, -3.*theta1.*theta5.*theta6.^2, -theta1.*theta5.^3, -3.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta5.*theta6, -theta2.*theta4.^3, -theta2.*theta5.^2, zeroCol, -2.*theta3.*theta4.*theta6, -theta3.*theta4.^2, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, zeroCol, -3.*theta2.*theta5.*theta6.^2, -theta2.*theta5.^3, -3.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta5.*theta6, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, -3.*theta3.*theta5.*theta6.^2, -theta3.*theta5.^3, -2.*theta4.*theta5.*theta6, -theta4.*theta5.^2, -theta3.^3.*theta5, -theta4.^2.*theta5, -3.*theta4.*theta5.*theta6.^2, -theta4.*theta5.^3, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta6, -2.*theta2.*theta3.^2.*theta6, zeroCol, -2.*theta1.^2.*theta4.*theta6, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta5.^2.*theta6, -2.*theta2.*theta4.^2.*theta6, zeroCol, -2.*theta1.^2.*theta5.*theta6, -theta1.^2.*theta5.^2, -2.*theta2.^2.*theta4.*theta6, -theta2.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta5.^2.*theta6, -2.*theta3.*theta4.^2.*theta6, -2.*theta2.^2.*theta5.*theta6, -theta2.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta6, -theta3.^2.*theta4.^2, -2.*theta3.*theta5.^2.*theta6, -2.*theta3.^2.*theta5.*theta6, -theta3.^2.*theta5.^2, -2.*theta4.*theta5.^2.*theta6, -2.*theta4.^2.*theta5.*theta6, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, -theta1.*theta5, -theta2.*theta4, zeroCol, -theta2.*theta5, -theta3.*theta4, -theta3.*theta5, -theta4.*theta5, zeroCol, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta3.*theta4, zeroCol, -theta1.*theta3.*theta5, -theta2.*theta3.*theta4, -theta1.*theta4.*theta5, -theta2.*theta3.*theta5, -theta2.*theta4.*theta5, -theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta3.^2, zeroCol, -theta1.*theta2.^2.*theta3, zeroCol, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta4.^2, zeroCol, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta4.^2, -theta1.*theta2.^2.*theta5, -theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta3.*theta5, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta1.^2.*theta4.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta5, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta4.*theta5, -theta1.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta5, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; momentArms5; momentArms6; ];
    case 60
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 61
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 62
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 63
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 64
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 65
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 66
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 67
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 68
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 69
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 70
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 71
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 72
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 73
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 74
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 75
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 76
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 77
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 78
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 79
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        muscleTendonLengths = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 5.*theta3.^4.*thetaDot3, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; ];
    case 80
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 81
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 82
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 83
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 84
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 85
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        theta3 = jointAngles(:, 3);
        theta4 = jointAngles(:, 4);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        thetaDot3 = jointVelocities(:, 3);
        thetaDot4 = jointVelocities(:, 4);
        muscleTendonLengths = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, thetaDot3, thetaDot4, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*thetaDot3, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, 2.*theta1.*theta3.^3.*thetaDot1 + 3.*theta1.^2.*theta3.^2.*thetaDot3, 2.*theta1.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta4.*thetaDot4, 2.*theta1.^3.*theta3.*thetaDot3 + 3.*theta1.^2.*theta3.^2.*thetaDot1, 2.*theta2.*theta3.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*thetaDot3, 2.*theta1.*theta4.^3.*thetaDot1 + 3.*theta1.^2.*theta4.^2.*thetaDot4, 2.*theta1.^3.*theta4.*thetaDot4 + 3.*theta1.^2.*theta4.^2.*thetaDot1, 2.*theta2.*theta3.^3.*thetaDot2 + 3.*theta2.^2.*theta3.^2.*thetaDot3, 2.*theta2.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta4.*thetaDot4, 2.*theta2.^3.*theta3.*thetaDot3 + 3.*theta2.^2.*theta3.^2.*thetaDot2, 2.*theta2.*theta4.^3.*thetaDot2 + 3.*theta2.^2.*theta4.^2.*thetaDot4, 2.*theta2.^3.*theta4.*thetaDot4 + 3.*theta2.^2.*theta4.^2.*thetaDot2, 2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta3.^2.*theta4.*thetaDot4, 2.*theta3.*theta4.^3.*thetaDot3 + 3.*theta3.^2.*theta4.^2.*thetaDot4, 2.*theta3.^3.*theta4.*thetaDot4 + 3.*theta3.^2.*theta4.^2.*thetaDot3, theta1.*thetaDot2 + theta2.*thetaDot1, theta1.*thetaDot3 + theta3.*thetaDot1, theta1.*thetaDot4 + theta4.*thetaDot1, theta2.*thetaDot3 + theta3.*thetaDot2, theta2.*thetaDot4 + theta4.*thetaDot2, theta3.*thetaDot4 + theta4.*thetaDot3, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta3.^2.*thetaDot1 + 2.*theta1.*theta3.*thetaDot3, theta1.^2.*thetaDot3 + 2.*theta1.*theta3.*thetaDot1, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta3.^3.*thetaDot1 + 3.*theta1.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot1 + 2.*theta1.*theta4.*thetaDot4, theta3.^2.*thetaDot2 + 2.*theta2.*theta3.*thetaDot3, theta1.^2.*thetaDot4 + 2.*theta1.*theta4.*thetaDot1, theta1.^3.*thetaDot3 + 3.*theta1.^2.*theta3.*thetaDot1, theta2.^2.*thetaDot3 + 2.*theta2.*theta3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, theta3.^4.*thetaDot1 + 4.*theta1.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot1 + 3.*theta1.*theta4.^2.*thetaDot4, theta3.^3.*thetaDot2 + 3.*theta2.*theta3.^2.*thetaDot3, theta4.^2.*thetaDot2 + 2.*theta2.*theta4.*thetaDot4, theta1.^3.*thetaDot4 + 3.*theta1.^2.*theta4.*thetaDot1, theta2.^2.*thetaDot4 + 2.*theta2.*theta4.*thetaDot2, theta1.^4.*thetaDot3 + 4.*theta1.^3.*theta3.*thetaDot1, theta2.^3.*thetaDot3 + 3.*theta2.^2.*theta3.*thetaDot2, theta4.^4.*thetaDot1 + 4.*theta1.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot2 + 4.*theta2.*theta3.^3.*thetaDot3, theta4.^3.*thetaDot2 + 3.*theta2.*theta4.^2.*thetaDot4, theta4.^2.*thetaDot3 + 2.*theta3.*theta4.*thetaDot4, theta1.^4.*thetaDot4 + 4.*theta1.^3.*theta4.*thetaDot1, theta2.^3.*thetaDot4 + 3.*theta2.^2.*theta4.*thetaDot2, theta3.^2.*thetaDot4 + 2.*theta3.*theta4.*thetaDot3, theta2.^4.*thetaDot3 + 4.*theta2.^3.*theta3.*thetaDot2, theta4.^4.*thetaDot2 + 4.*theta2.*theta4.^3.*thetaDot4, theta4.^3.*thetaDot3 + 3.*theta3.*theta4.^2.*thetaDot4, theta2.^4.*thetaDot4 + 4.*theta2.^3.*theta4.*thetaDot2, theta3.^3.*thetaDot4 + 3.*theta3.^2.*theta4.*thetaDot3, theta4.^4.*thetaDot3 + 4.*theta3.*theta4.^3.*thetaDot4, theta3.^4.*thetaDot4 + 4.*theta3.^3.*theta4.*thetaDot3, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 2.*theta3.*thetaDot3, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 3.*theta3.^2.*thetaDot3, 2.*theta4.*thetaDot4, 5.*theta2.^4.*thetaDot2, 4.*theta3.^3.*thetaDot3, 3.*theta4.^2.*thetaDot4, 5.*theta3.^4.*thetaDot3, 4.*theta4.^3.*thetaDot4, 5.*theta4.^4.*thetaDot4, theta1.*theta3.^2.*thetaDot2 + theta2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot3, theta1.*theta2.^2.*thetaDot3 + theta2.^2.*theta3.*thetaDot1 + 2.*theta1.*theta2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot3 + theta1.^2.*theta3.*thetaDot2 + 2.*theta1.*theta2.*theta3.*thetaDot1, theta1.*theta3.^3.*thetaDot2 + theta2.*theta3.^3.*thetaDot1 + 3.*theta1.*theta2.*theta3.^2.*thetaDot3, theta1.*theta4.^2.*thetaDot2 + theta2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot4, theta1.*theta2.^2.*thetaDot4 + theta2.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta4.*thetaDot2, theta1.*theta2.^3.*thetaDot3 + theta2.^3.*theta3.*thetaDot1 + 3.*theta1.*theta2.^2.*theta3.*thetaDot2, theta1.^2.*theta2.*thetaDot4 + theta1.^2.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot3 + theta1.^3.*theta3.*thetaDot2 + 3.*theta1.^2.*theta2.*theta3.*thetaDot1, theta1.*theta4.^3.*thetaDot2 + theta2.*theta4.^3.*thetaDot1 + 3.*theta1.*theta2.*theta4.^2.*thetaDot4, theta1.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot4, theta1.*theta2.^3.*thetaDot4 + theta2.^3.*theta4.*thetaDot1 + 3.*theta1.*theta2.^2.*theta4.*thetaDot2, theta1.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta3.*theta4.*thetaDot3, theta1.^2.*theta3.*thetaDot4 + theta1.^2.*theta4.*thetaDot3 + 2.*theta1.*theta3.*theta4.*thetaDot1, theta1.^3.*theta2.*thetaDot4 + theta1.^3.*theta4.*thetaDot2 + 3.*theta1.^2.*theta2.*theta4.*thetaDot1, theta1.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot1 + 3.*theta1.*theta3.*theta4.^2.*thetaDot4, theta1.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot1 + 3.*theta1.*theta3.^2.*theta4.*thetaDot3, theta2.*theta4.^2.*thetaDot3 + theta3.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot4, theta2.*theta3.^2.*thetaDot4 + theta3.^2.*theta4.*thetaDot2 + 2.*theta2.*theta3.*theta4.*thetaDot3, theta1.^3.*theta3.*thetaDot4 + theta1.^3.*theta4.*thetaDot3 + 3.*theta1.^2.*theta3.*theta4.*thetaDot1, theta2.^2.*theta3.*thetaDot4 + theta2.^2.*theta4.*thetaDot3 + 2.*theta2.*theta3.*theta4.*thetaDot2, theta2.*theta4.^3.*thetaDot3 + theta3.*theta4.^3.*thetaDot2 + 3.*theta2.*theta3.*theta4.^2.*thetaDot4, theta2.*theta3.^3.*thetaDot4 + theta3.^3.*theta4.*thetaDot2 + 3.*theta2.*theta3.^2.*theta4.*thetaDot3, theta2.^3.*theta3.*thetaDot4 + theta2.^3.*theta4.*thetaDot3 + 3.*theta2.^2.*theta3.*theta4.*thetaDot2, theta2.^2.*theta3.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta3.*thetaDot3, theta1.^2.*theta3.^2.*thetaDot2 + 2.*theta1.*theta2.*theta3.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot3, theta1.^2.*theta2.^2.*thetaDot3 + 2.*theta1.*theta2.^2.*theta3.*thetaDot1 + 2.*theta1.^2.*theta2.*theta3.*thetaDot2, theta2.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot2 + 2.*theta1.*theta2.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot4, theta1.^2.*theta2.^2.*thetaDot4 + 2.*theta1.*theta2.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta2.*theta4.*thetaDot2, theta3.^2.*theta4.^2.*thetaDot1 + 2.*theta1.*theta3.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.^2.*theta4.*thetaDot4, theta1.^2.*theta4.^2.*thetaDot3 + 2.*theta1.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot4, theta1.^2.*theta3.^2.*thetaDot4 + 2.*theta1.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.^2.*theta3.*theta4.*thetaDot3, theta3.^2.*theta4.^2.*thetaDot2 + 2.*theta2.*theta3.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.^2.*theta4.*thetaDot4, theta2.^2.*theta4.^2.*thetaDot3 + 2.*theta2.*theta3.*theta4.^2.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot4, theta2.^2.*theta3.^2.*thetaDot4 + 2.*theta2.*theta3.^2.*theta4.*thetaDot2 + 2.*theta2.^2.*theta3.*theta4.*thetaDot3, theta1.*theta2.*thetaDot3 + theta1.*theta3.*thetaDot2 + theta2.*theta3.*thetaDot1, theta1.*theta2.*thetaDot4 + theta1.*theta4.*thetaDot2 + theta2.*theta4.*thetaDot1, theta1.*theta3.*thetaDot4 + theta1.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot1, theta2.*theta3.*thetaDot4 + theta2.*theta4.*thetaDot3 + theta3.*theta4.*thetaDot2, theta1.*theta2.*theta3.*thetaDot4 + theta1.*theta2.*theta4.*thetaDot3 + theta1.*theta3.*theta4.*thetaDot2 + theta2.*theta3.*theta4.*thetaDot1, theta1.*theta2.*theta4.^2.*thetaDot3 + theta1.*theta3.*theta4.^2.*thetaDot2 + theta2.*theta3.*theta4.^2.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot4, theta1.*theta2.*theta3.^2.*thetaDot4 + theta1.*theta3.^2.*theta4.*thetaDot2 + theta2.*theta3.^2.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot3, theta1.*theta2.^2.*theta3.*thetaDot4 + theta1.*theta2.^2.*theta4.*thetaDot3 + theta2.^2.*theta3.*theta4.*thetaDot1 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot2, theta1.^2.*theta2.*theta3.*thetaDot4 + theta1.^2.*theta2.*theta4.*thetaDot3 + theta1.^2.*theta3.*theta4.*thetaDot2 + 2.*theta1.*theta2.*theta3.*theta4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        momentArms3 = [ zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        momentArms4 = [ zeroCol, zeroCol, zeroCol,-1*onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; momentArms3; momentArms4; ];
    case 86
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 87
        theta1 = jointAngles(:, 1);
        theta2 = jointAngles(:, 2);
        thetaDot1 = jointVelocities(:, 1);
        thetaDot2 = jointVelocities(:, 2);
        muscleTendonLengths = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, thetaDot2, 2.*theta1.*theta2.^2.*thetaDot1 + 2.*theta1.^2.*theta2.*thetaDot2, 2.*theta1.*theta2.^3.*thetaDot1 + 3.*theta1.^2.*theta2.^2.*thetaDot2, 2.*theta1.^3.*theta2.*thetaDot2 + 3.*theta1.^2.*theta2.^2.*thetaDot1, theta1.*thetaDot2 + theta2.*thetaDot1, theta2.^2.*thetaDot1 + 2.*theta1.*theta2.*thetaDot2, theta1.^2.*thetaDot2 + 2.*theta1.*theta2.*thetaDot1, theta2.^3.*thetaDot1 + 3.*theta1.*theta2.^2.*thetaDot2, theta1.^3.*thetaDot2 + 3.*theta1.^2.*theta2.*thetaDot1, theta2.^4.*thetaDot1 + 4.*theta1.*theta2.^3.*thetaDot2, theta1.^4.*thetaDot2 + 4.*theta1.^3.*theta2.*thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 2.*theta2.*thetaDot2, 4.*theta1.^3.*thetaDot1, 3.*theta2.^2.*thetaDot2, 5.*theta1.^4.*thetaDot1, 4.*theta2.^3.*thetaDot2, 5.*theta2.^4.*thetaDot2, zeroCol,];
        momentArms1 = [-1*onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        momentArms2 = [ zeroCol,-1*onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; momentArms2; ];
    case 88
        theta1 = jointAngles(:, 1);
        thetaDot1 = jointVelocities(:, 1);
        muscleTendonLengths = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 4.*theta1.^3.*thetaDot1, 5.*theta1.^4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; ];
    case 89
        theta1 = jointAngles(:, 1);
        thetaDot1 = jointVelocities(:, 1);
        muscleTendonLengths = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 4.*theta1.^3.*thetaDot1, 5.*theta1.^4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; ];
    case 90
        theta1 = jointAngles(:, 1);
        thetaDot1 = jointVelocities(:, 1);
        muscleTendonLengths = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        muscleTendonVelocities = [ thetaDot1, 2.*theta1.*thetaDot1, 3.*theta1.^2.*thetaDot1, 4.*theta1.^3.*thetaDot1, 5.*theta1.^4.*thetaDot1, zeroCol,];
        momentArms1 = [-1*onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        matrix = [muscleTendonLengths; muscleTendonVelocities;momentArms1; ];
end
end
