<?xml version="1.0" encoding="UTF-8" ?>
<NMSMPipelineDocument Version="1.0.0">
	<NeuralControlPersonalizationTool>
		<!--Directory used for writing results.-->
		<results_directory>results</results_directory>
		<!--Directory for input files-->
		<data_directory>preprocessed</data_directory>
		<!--The MTP results directories -->
		<mtp_results_directory>mtpResults</mtp_results_directory>
		<!--Name of the input model file (.osim) to use-->
		<input_model_file>model.osim</input_model_file>
		<!--Name of the input osimx file (.osimx) to use-->
		<input_osimx_file>mtpResults/model.osimx</input_osimx_file>
		<!--Coordinates Muscle-Tendon Personalization tracked their joint moments. Leave empty for none. Muscles spanning these coordinates will be extracted automatically.-->
		<coordinate_list>hip_flexion_l hip_adduction_l hip_rotation_l knee_angle_l ankle_angle_l subtalar_angle_l</coordinate_list>
		<!--A space-separated list of the activation muscle groups. -->
		<activation_muscle_groups>AdductorActivationGroupR BicepsFemActivationGroupR GastrocActivationGroupR GluteusMaxActivationGroupR GluteusMedActivationGroupR GluteusMinActivationGroupR IliopsoasActivationGroupR HamstringActivationGroupR QuadricepActivationGroupR AdductorActivationGroupL BicepsFemActivationGroupL GastrocActivationGroupL GluteusMaxActivationGroupL GluteusMedActivationGroupL GluteusMinActivationGroupL IliopsoasActivationGroupL HamstringActivationGroupL QuadricepActivationGroupL</activation_muscle_groups>
		<!--A space-separated list of the normalized fiber length muscle groups. -->
		<normalized_fiber_length_muscle_groups>AdductorFiberLengthGroupR GluteusMaxFiberLengthGroupR GluteusMedFiberLengthGroupR GluteusMinFiberLengthGroupR QuadricepFiberLengthGroupR HamstringFiberLengthGroupR PeroneusFiberLengthGroupR IliopsoasFiberLengthGroupR GastrocFiberLengthGroupR AdductorFiberLengthGroupL GluteusMaxFiberLengthGroupL GluteusMedFiberLengthGroupL GluteusMinFiberLengthGroupL QuadricepFiberLengthGroupL HamstringFiberLengthGroupL PeroneusFiberLengthGroupL IliopsoasFiberLengthGroupL GastrocFiberLengthGroupL</normalized_fiber_length_muscle_groups>
		<MuscleTendonLengthInitialization>
			<!--Boolean (true, false) indicating if muscle tendon length initialization should be performed before muscle tendon personalization-->
			<is_enabled>false</is_enabled>
			<passive_data_input_directory>thelen</passive_data_input_directory>
			<max_normalized_muscle_fiber_length>1</max_normalized_muscle_fiber_length>
			<min_normalized_muscle_fiber_length>0.6</min_normalized_muscle_fiber_length>
			<optimize_maximum_muscle_stress>true</optimize_maximum_muscle_stress>
			<optimize_isometric_max_force>true</optimize_isometric_max_force>
			<!--*Optional* The muscle specific tension to use-->
			<maximum_muscle_stress>610e3</maximum_muscle_stress>
			<RCNLCostTermSet>
				<RCNLCostTerm>
					<type>passive_joint_moment</type>
					<is_enabled>true</is_enabled>
					<max_allowable_error>2</max_allowable_error>
				</RCNLCostTerm>
				<RCNLCostTerm>
					<type>optimal_muscle_fiber_length</type>
					<is_enabled>true</is_enabled>
					<max_allowable_error>0.3</max_allowable_error>
					<error_center>1</error_center>
				</RCNLCostTerm>
				<RCNLCostTerm>
					<type>tendon_slack_length</type>
					<is_enabled>true</is_enabled>
					<max_allowable_error>1</max_allowable_error>
					<error_center>1</error_center>
				</RCNLCostTerm>
				<RCNLCostTerm>
					<type>minimum_normalized_muscle_fiber_length</type>
					<is_enabled>true</is_enabled>
					<max_allowable_error>0.3</max_allowable_error>
				</RCNLCostTerm>
				<RCNLCostTerm>
					<type>maximum_normalized_muscle_fiber_length</type>
					<is_enabled>true</is_enabled>
					<max_allowable_error>0.03</max_allowable_error>
				</RCNLCostTerm>
				<RCNLCostTerm>
					<type>maximum_muscle_stress</type>
					<is_enabled>true</is_enabled>
					<max_allowable_error>0.1</max_allowable_error>
					<error_center>1.2</error_center>
				</RCNLCostTerm>
				<RCNLCostTerm>
					<type>passive_muscle_force</type>
					<is_enabled>true</is_enabled>
					<max_allowable_error>0.1</max_allowable_error>
				</RCNLCostTerm>
				<RCNLCostTerm>
					<type>grouped_normalized_muscle_fiber_length</type>
					<is_enabled>true</is_enabled>
					<max_allowable_error>0.1</max_allowable_error>
				</RCNLCostTerm>
				<RCNLCostTerm>
					<type>grouped_maximum_normalized_muscle_fiber_length</type>
					<is_enabled>true</is_enabled>
					<max_allowable_error>0.1</max_allowable_error>
				</RCNLCostTerm>
			</RCNLCostTermSet>
		</MuscleTendonLengthInitialization>
		<!---->
		<RCNLSynergySet>
			<RCNLSynergy>
				<muscle_group_name>group1</muscle_group_name>
				<num_synergies>6</num_synergies>
			</RCNLSynergy>
			<RCNLSynergy>
				<muscle_group_name>group2</muscle_group_name>
				<num_synergies>6</num_synergies>
			</RCNLSynergy>
		</RCNLSynergySet>
		<!--false if synergies per side are independent of each other; true if synergy vector weights are the same between left and right-->
		<enforce_bilateral_symmetry>false</enforce_bilateral_symmetry>
		<RCNLCostTermSet>
			<RCNLCostTerm>
				<type>moment_tracking</type>
				<is_enabled>true</is_enabled>
				<max_allowable_error>5</max_allowable_error>
			</RCNLCostTerm>
			<RCNLCostTerm>
				<type>activation_tracking</type>
				<is_enabled>true</is_enabled>
				<max_allowable_error>0.005</max_allowable_error>
			</RCNLCostTerm>
			<RCNLCostTerm>
				<type>activation_minimization</type>
				<is_enabled>true</is_enabled>
				<max_allowable_error>0.05</max_allowable_error>
			</RCNLCostTerm>
			<RCNLCostTerm>
				<type>grouped_activations</type>
				<is_enabled>true</is_enabled>
				<max_allowable_error>0.1</max_allowable_error>
			</RCNLCostTerm>
			<RCNLCostTerm>
				<type>grouped_fiber_lengths</type>
				<is_enabled>true</is_enabled>
				<max_allowable_error>0.1</max_allowable_error>
			</RCNLCostTerm>
		</RCNLCostTermSet>
		<!--*Optional* The number of allowed iterations of the fmincon optimization, setting this lower can help cancel an optimization that won't converge-->
		<max_iterations>2e3</max_iterations>
		<!--*Optional* The number of allowed cost function calls for the fmincon optimization, setting this lower can help cancel an optimization that won't converge-->
		<max_function_evaluations>1e8</max_function_evaluations>
		<!--*Optional* space-separated list of prefixes to use for data files, if left blank, use all prefixes fron IK folder-->
		<trial_prefixes/>
	</NeuralControlPersonalizationTool>
</NMSMPipelineDocument>
